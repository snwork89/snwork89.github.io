!function(e){function t(t){for(var n,i,r=t[0],a=t[1],o=0,s=[];o<r.length;o++)i=r[o],Object.prototype.hasOwnProperty.call(l,i)&&l[i]&&s.push(l[i][0]),l[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(c&&c(t);s.length;)s.shift()()}var n={},l={1:0};var i={};var r={42:function(){return{"./index_bg.js":{__wbindgen_string_new:function(e,t){return n[40].exports.O(e,t)},__wbg_log_7bb108d119bafbc1:function(e){return n[40].exports.x(e)},__wbindgen_object_drop_ref:function(e){return n[40].exports.N(e)},__wbg_new_abda76e883ba8a5f:function(){return n[40].exports.z()},__wbg_stack_658279fe44541cf6:function(e,t){return n[40].exports.E(e,t)},__wbg_error_f851667af71bcfc6:function(e,t){return n[40].exports.n(e,t)},__wbg_self_1ff1d729e9aae938:function(){return n[40].exports.B()},__wbg_window_5f4faef6c12b79ec:function(){return n[40].exports.J()},__wbg_globalThis_1d39714405582d3c:function(){return n[40].exports.q()},__wbg_global_651f05c6a0944d1c:function(){return n[40].exports.r()},__wbindgen_is_undefined:function(e){return n[40].exports.L(e)},__wbg_newnoargs_581967eacc0e2604:function(e,t){return n[40].exports.A(e,t)},__wbg_call_cb65541d95d71282:function(e,t){return n[40].exports.k(e,t)},__wbindgen_debug_string:function(e,t){return n[40].exports.K(e,t)},__wbindgen_object_clone_ref:function(e){return n[40].exports.M(e)},__wbg_instanceof_Window_e266f02eee43b570:function(e){return n[40].exports.v(e)},__wbg_document_950215a728589a2d:function(e){return n[40].exports.m(e)},__wbg_getElementById_eb93a47327bb5585:function(e,t,l){return n[40].exports.p(e,t,l)},__wbg_instanceof_HtmlCanvasElement_f5f69dab93281ebe:function(e){return n[40].exports.u(e)},__wbg_getContext_3ae404b649cf9287:function(e,t,l){return n[40].exports.o(e,t,l)},__wbg_instanceof_CanvasRenderingContext2d_3e95629461ed9f67:function(e){return n[40].exports.t(e)},__wbg_time_7d2d373d518e95fa:function(e,t){return n[40].exports.H(e,t)},__wbg_setstrokeStyle_073fc10b086c1727:function(e,t){return n[40].exports.D(e,t)},__wbg_canvas_0629be400c80c8cd:function(e){return n[40].exports.l(e)},__wbg_width_a40e21a22129b197:function(e){return n[40].exports.I(e)},__wbg_height_98d51321254345a5:function(e){return n[40].exports.s(e)},__wbg_beginPath_0948db80d0d23ce3:function(e){return n[40].exports.j(e)},__wbg_moveTo_b0d9695c44d309f0:function(e,t,l){return n[40].exports.y(e,t,l)},__wbg_lineTo_b902f35217ff96ab:function(e,t,l){return n[40].exports.w(e,t,l)},__wbg_stroke_6e1b85c72caa53ea:function(e){return n[40].exports.F(e)},__wbg_timeEnd_3080975414918110:function(e,t){return n[40].exports.G(e,t)},__wbindgen_throw:function(e,t){return n[40].exports.P(e,t)}}}}};function a(t){if(n[t])return n[t].exports;var l=n[t]={i:t,l:!1,exports:{}};return e[t].call(l.exports,l,l.exports,a),l.l=!0,l.exports}a.e=function(e){var t=[],n=l[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,i){n=l[e]=[t,i]}));t.push(n[2]=o);var s,d=document.createElement("script");d.charset="utf-8",d.timeout=120,a.nc&&d.setAttribute("nonce",a.nc),d.src=function(e){return a.p+""+({}[e]||e)+".js"}(e);var c=new Error;s=function(t){d.onerror=d.onload=null,clearTimeout(u);var n=l[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}l[e]=void 0}};var u=setTimeout((function(){s({type:"timeout",target:d})}),12e4);d.onerror=d.onload=s,document.head.appendChild(d)}return({0:[42]}[e]||[]).forEach((function(e){var n=i[e];if(n)t.push(n);else{var l,o=r[e](),s=fetch(a.p+""+{42:"0a2f2e4124c8a4167d38"}[e]+".module.wasm");if(o instanceof Promise&&"function"==typeof WebAssembly.compileStreaming)l=Promise.all([WebAssembly.compileStreaming(s),o]).then((function(e){return WebAssembly.instantiate(e[0],e[1])}));else if("function"==typeof WebAssembly.instantiateStreaming)l=WebAssembly.instantiateStreaming(s,o);else{l=s.then((function(e){return e.arrayBuffer()})).then((function(e){return WebAssembly.instantiate(e,o)}))}t.push(i[e]=l.then((function(t){return a.w[e]=(t.instance||t).exports})))}})),Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)a.d(n,l,function(t){return e[t]}.bind(null,l));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e},a.w={};var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=s;a(a.s=39)}({0:function(e,t,n){"use strict";(function(e){var l=n(8);const{toString:i}=Object.prototype,{getPrototypeOf:r}=Object,a=(o=Object.create(null),e=>{const t=i.call(e);return o[t]||(o[t]=t.slice(8,-1).toLowerCase())});var o;const s=e=>(e=e.toLowerCase(),t=>a(t)===e),d=e=>t=>typeof t===e,{isArray:c}=Array,u=d("undefined");const m=s("ArrayBuffer");const h=d("string"),p=d("function"),g=d("number"),f=e=>null!==e&&"object"==typeof e,y=e=>{if("object"!==a(e))return!1;const t=r(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},v=s("Date"),b=s("File"),w=s("Blob"),E=s("FileList"),I=s("URLSearchParams");function S(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let l,i;if("object"!=typeof e&&(e=[e]),c(e))for(l=0,i=e.length;l<i;l++)t.call(null,e[l],l,e);else{const i=n?Object.getOwnPropertyNames(e):Object.keys(e),r=i.length;let a;for(l=0;l<r;l++)a=i[l],t.call(null,e[a],a,e)}}function k(e,t){t=t.toLowerCase();const n=Object.keys(e);let l,i=n.length;for(;i-- >0;)if(l=n[i],t===l.toLowerCase())return l;return null}const x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:e,T=e=>!u(e)&&e!==x;const _=(B="undefined"!=typeof Uint8Array&&r(Uint8Array),e=>B&&e instanceof B);var B;const L=s("HTMLFormElement"),P=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),C=s("RegExp"),N=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),l={};S(n,(n,i)=>{let r;!1!==(r=t(n,i,e))&&(l[i]=r||n)}),Object.defineProperties(e,l)},R="abcdefghijklmnopqrstuvwxyz",A={DIGIT:"0123456789",ALPHA:R,ALPHA_DIGIT:R+R.toUpperCase()+"0123456789"};const F=s("AsyncFunction");t.a={isArray:c,isArrayBuffer:m,isBuffer:function(e){return null!==e&&!u(e)&&null!==e.constructor&&!u(e.constructor)&&p(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||p(e.append)&&("formdata"===(t=a(e))||"object"===t&&p(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&m(e.buffer),t},isString:h,isNumber:g,isBoolean:e=>!0===e||!1===e,isObject:f,isPlainObject:y,isUndefined:u,isDate:v,isFile:b,isBlob:w,isRegExp:C,isFunction:p,isStream:e=>f(e)&&p(e.pipe),isURLSearchParams:I,isTypedArray:_,isFileList:E,forEach:S,merge:function e(){const{caseless:t}=T(this)&&this||{},n={},l=(l,i)=>{const r=t&&k(n,i)||i;y(n[r])&&y(l)?n[r]=e(n[r],l):y(l)?n[r]=e({},l):c(l)?n[r]=l.slice():n[r]=l};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&S(arguments[e],l);return n},extend:(e,t,n,{allOwnKeys:i}={})=>(S(t,(t,i)=>{n&&p(t)?e[i]=Object(l.a)(t,n):e[i]=t},{allOwnKeys:i}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,l)=>{e.prototype=Object.create(t.prototype,l),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,l)=>{let i,a,o;const s={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),a=i.length;a-- >0;)o=i[a],l&&!l(o,e,t)||s[o]||(t[o]=e[o],s[o]=!0);e=!1!==n&&r(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:a,kindOfTest:s,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const l=e.indexOf(t,n);return-1!==l&&l===n},toArray:e=>{if(!e)return null;if(c(e))return e;let t=e.length;if(!g(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let l;for(;(l=n.next())&&!l.done;){const n=l.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const l=[];for(;null!==(n=e.exec(t));)l.push(n);return l},isHTMLForm:L,hasOwnProperty:P,hasOwnProp:P,reduceDescriptors:N,freezeMethods:e=>{N(e,(t,n)=>{if(p(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const l=e[n];p(l)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},l=e=>{e.forEach(e=>{n[e]=!0})};return c(e)?l(e):l(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:k,global:x,isContextDefined:T,ALPHABET:A,generateString:(e=16,t=A.ALPHA_DIGIT)=>{let n="";const{length:l}=t;for(;e--;)n+=t[Math.random()*l|0];return n},isSpecCompliantForm:function(e){return!!(e&&p(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,l)=>{if(f(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[l]=e;const i=c(e)?[]:{};return S(e,(e,t)=>{const r=n(e,l+1);!u(r)&&(i[t]=r)}),t[l]=void 0,i}}return e};return n(e,0)},isAsyncFn:F,isThenable:e=>e&&(f(e)||p(e))&&p(e.then)&&p(e.catch)}}).call(this,n(12))},1:function(e,t,n){"use strict";var l=n(0);function i(e,t,n,l,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),l&&(this.request=l),i&&(this.response=i)}l.a.inherits(i,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:l.a.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const r=i.prototype,a={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{a[e]={value:e}}),Object.defineProperties(i,a),Object.defineProperty(r,"isAxiosError",{value:!0}),i.from=(e,t,n,a,o,s)=>{const d=Object.create(r);return l.a.toFlatObject(e,d,(function(e){return e!==Error.prototype}),e=>"isAxiosError"!==e),i.call(d,e.message,t,n,a,o),d.cause=e,d.name=e.name,s&&Object.assign(d,s),d},t.a=i},12:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},3:function(e,t,n){"use strict";(function(e){var l=n(0),i=n(1),r=n(9);function a(e){return l.a.isPlainObject(e)||l.a.isArray(e)}function o(e){return l.a.endsWith(e,"[]")?e.slice(0,-2):e}function s(e,t,n){return e?e.concat(t).map((function(e,t){return e=o(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const d=l.a.toFlatObject(l.a,{},null,(function(e){return/^is[A-Z]/.test(e)}));t.a=function(t,n,c){if(!l.a.isObject(t))throw new TypeError("target must be an object");n=n||new(r.a||FormData);const u=(c=l.a.toFlatObject(c,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!l.a.isUndefined(t[e])}))).metaTokens,m=c.visitor||y,h=c.dots,p=c.indexes,g=(c.Blob||"undefined"!=typeof Blob&&Blob)&&l.a.isSpecCompliantForm(n);if(!l.a.isFunction(m))throw new TypeError("visitor must be a function");function f(t){if(null===t)return"";if(l.a.isDate(t))return t.toISOString();if(!g&&l.a.isBlob(t))throw new i.a("Blob is not supported. Use a Buffer instead.");return l.a.isArrayBuffer(t)||l.a.isTypedArray(t)?g&&"function"==typeof Blob?new Blob([t]):e.from(t):t}function y(e,t,i){let r=e;if(e&&!i&&"object"==typeof e)if(l.a.endsWith(t,"{}"))t=u?t:t.slice(0,-2),e=JSON.stringify(e);else if(l.a.isArray(e)&&function(e){return l.a.isArray(e)&&!e.some(a)}(e)||(l.a.isFileList(e)||l.a.endsWith(t,"[]"))&&(r=l.a.toArray(e)))return t=o(t),r.forEach((function(e,i){!l.a.isUndefined(e)&&null!==e&&n.append(!0===p?s([t],i,h):null===p?t:t+"[]",f(e))})),!1;return!!a(e)||(n.append(s(i,t,h),f(e)),!1)}const v=[],b=Object.assign(d,{defaultVisitor:y,convertValue:f,isVisitable:a});if(!l.a.isObject(t))throw new TypeError("data must be an object");return function e(t,i){if(!l.a.isUndefined(t)){if(-1!==v.indexOf(t))throw Error("Circular reference detected in "+i.join("."));v.push(t),l.a.forEach(t,(function(t,r){!0===(!(l.a.isUndefined(t)||null===t)&&m.call(n,t,l.a.isString(r)?r.trim():r,i,b))&&e(t,i?i.concat(r):[r])})),v.pop()}}(t),n}}).call(this,n(35).Buffer)},35:function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var l=n(36),i=n(37),r=n(38);function a(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=s.prototype:(null===e&&(e=new s(t)),e.length=t),e}function s(e,t,n){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return d(this,e,t,n)}function d(e,t,n,l){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,l){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(l||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===l?new Uint8Array(t):void 0===l?new Uint8Array(t,n):new Uint8Array(t,n,l);s.TYPED_ARRAY_SUPPORT?(e=t).__proto__=s.prototype:e=m(e,t);return e}(e,t,n,l):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!s.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var l=0|p(t,n),i=(e=o(e,l)).write(t,n);i!==l&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(s.isBuffer(t)){var n=0|h(t.length);return 0===(e=o(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(l=t.length)!=l?o(e,0):m(e,t);if("Buffer"===t.type&&r(t.data))return m(e,t.data)}var l;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(c(t),e=o(e,t<0?0:0|h(t)),!s.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function m(e,t){var n=t.length<0?0:0|h(t.length);e=o(e,n);for(var l=0;l<n;l+=1)e[l]=255&t[l];return e}function h(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(s.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var l=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(e).length;default:if(l)return H(e).length;t=(""+t).toLowerCase(),l=!0}}function g(e,t,n){var l=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return _(this,t,n);case"latin1":case"binary":return B(this,t,n);case"base64":return x(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(l)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),l=!0}}function f(e,t,n){var l=e[t];e[t]=e[n],e[n]=l}function y(e,t,n,l,i){if(0===e.length)return-1;if("string"==typeof n?(l=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=s.from(t,l)),s.isBuffer(t))return 0===t.length?-1:v(e,t,n,l,i);if("number"==typeof t)return t&=255,s.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,l,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,l,i){var r,a=1,o=e.length,s=t.length;if(void 0!==l&&("ucs2"===(l=String(l).toLowerCase())||"ucs-2"===l||"utf16le"===l||"utf-16le"===l)){if(e.length<2||t.length<2)return-1;a=2,o/=2,s/=2,n/=2}function d(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var c=-1;for(r=n;r<o;r++)if(d(e,r)===d(t,-1===c?0:r-c)){if(-1===c&&(c=r),r-c+1===s)return c*a}else-1!==c&&(r-=r-c),c=-1}else for(n+s>o&&(n=o-s),r=n;r>=0;r--){for(var u=!0,m=0;m<s;m++)if(d(e,r+m)!==d(t,m)){u=!1;break}if(u)return r}return-1}function b(e,t,n,l){n=Number(n)||0;var i=e.length-n;l?(l=Number(l))>i&&(l=i):l=i;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");l>r/2&&(l=r/2);for(var a=0;a<l;++a){var o=parseInt(t.substr(2*a,2),16);if(isNaN(o))return a;e[n+a]=o}return a}function w(e,t,n,l){return q(H(t,e.length-n),e,n,l)}function E(e,t,n,l){return q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,l)}function I(e,t,n,l){return E(e,t,n,l)}function S(e,t,n,l){return q($(t),e,n,l)}function k(e,t,n,l){return q(function(e,t){for(var n,l,i,r=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),l=n>>8,i=n%256,r.push(i),r.push(l);return r}(t,e.length-n),e,n,l)}function x(e,t,n){return 0===t&&n===e.length?l.fromByteArray(e):l.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var l=[],i=t;i<n;){var r,a,o,s,d=e[i],c=null,u=d>239?4:d>223?3:d>191?2:1;if(i+u<=n)switch(u){case 1:d<128&&(c=d);break;case 2:128==(192&(r=e[i+1]))&&(s=(31&d)<<6|63&r)>127&&(c=s);break;case 3:r=e[i+1],a=e[i+2],128==(192&r)&&128==(192&a)&&(s=(15&d)<<12|(63&r)<<6|63&a)>2047&&(s<55296||s>57343)&&(c=s);break;case 4:r=e[i+1],a=e[i+2],o=e[i+3],128==(192&r)&&128==(192&a)&&128==(192&o)&&(s=(15&d)<<18|(63&r)<<12|(63&a)<<6|63&o)>65535&&s<1114112&&(c=s)}null===c?(c=65533,u=1):c>65535&&(c-=65536,l.push(c>>>10&1023|55296),c=56320|1023&c),l.push(c),i+=u}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",l=0;for(;l<t;)n+=String.fromCharCode.apply(String,e.slice(l,l+=4096));return n}(l)}t.Buffer=s,t.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},t.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),s.poolSize=8192,s._augment=function(e){return e.__proto__=s.prototype,e},s.from=function(e,t,n){return d(null,e,t,n)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(e,t,n){return function(e,t,n,l){return c(t),t<=0?o(e,t):void 0!==n?"string"==typeof l?o(e,t).fill(n,l):o(e,t).fill(n):o(e,t)}(null,e,t,n)},s.allocUnsafe=function(e){return u(null,e)},s.allocUnsafeSlow=function(e){return u(null,e)},s.isBuffer=function(e){return!(null==e||!e._isBuffer)},s.compare=function(e,t){if(!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,l=t.length,i=0,r=Math.min(n,l);i<r;++i)if(e[i]!==t[i]){n=e[i],l=t[i];break}return n<l?-1:l<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!r(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var l=s.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!s.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(l,i),i+=a.length}return l},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)f(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)f(this,t,t+3),f(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)f(this,t,t+7),f(this,t+1,t+6),f(this,t+2,t+5),f(this,t+3,t+4);return this},s.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):g.apply(this,arguments)},s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},s.prototype.compare=function(e,t,n,l,i){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===l&&(l=0),void 0===i&&(i=this.length),t<0||n>e.length||l<0||i>this.length)throw new RangeError("out of range index");if(l>=i&&t>=n)return 0;if(l>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var r=(i>>>=0)-(l>>>=0),a=(n>>>=0)-(t>>>=0),o=Math.min(r,a),d=this.slice(l,i),c=e.slice(t,n),u=0;u<o;++u)if(d[u]!==c[u]){r=d[u],a=c[u];break}return r<a?-1:a<r?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},s.prototype.write=function(e,t,n,l){if(void 0===t)l="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)l=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===l&&(l="utf8")):(l=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");l||(l="utf8");for(var r=!1;;)switch(l){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return E(this,e,t,n);case"latin1":case"binary":return I(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,n);default:if(r)throw new TypeError("Unknown encoding: "+l);l=(""+l).toLowerCase(),r=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function _(e,t,n){var l="";n=Math.min(e.length,n);for(var i=t;i<n;++i)l+=String.fromCharCode(127&e[i]);return l}function B(e,t,n){var l="";n=Math.min(e.length,n);for(var i=t;i<n;++i)l+=String.fromCharCode(e[i]);return l}function L(e,t,n){var l=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>l)&&(n=l);for(var i="",r=t;r<n;++r)i+=W(e[r]);return i}function P(e,t,n){for(var l=e.slice(t,n),i="",r=0;r<l.length;r+=2)i+=String.fromCharCode(l[r]+256*l[r+1]);return i}function C(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,n,l,i,r){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<r)throw new RangeError('"value" argument is out of bounds');if(n+l>e.length)throw new RangeError("Index out of range")}function R(e,t,n,l){t<0&&(t=65535+t+1);for(var i=0,r=Math.min(e.length-n,2);i<r;++i)e[n+i]=(t&255<<8*(l?i:1-i))>>>8*(l?i:1-i)}function A(e,t,n,l){t<0&&(t=4294967295+t+1);for(var i=0,r=Math.min(e.length-n,4);i<r;++i)e[n+i]=t>>>8*(l?i:3-i)&255}function F(e,t,n,l,i,r){if(n+l>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,l,r){return r||F(e,0,n,4),i.write(e,t,n,l,23,4),n+4}function O(e,t,n,l,r){return r||F(e,0,n,8),i.write(e,t,n,l,52,8),n+8}s.prototype.slice=function(e,t){var n,l=this.length;if((e=~~e)<0?(e+=l)<0&&(e=0):e>l&&(e=l),(t=void 0===t?l:~~t)<0?(t+=l)<0&&(t=0):t>l&&(t=l),t<e&&(t=e),s.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=s.prototype;else{var i=t-e;n=new s(i,void 0);for(var r=0;r<i;++r)n[r]=this[r+e]}return n},s.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var l=this[e],i=1,r=0;++r<t&&(i*=256);)l+=this[e+r]*i;return l},s.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var l=this[e+--t],i=1;t>0&&(i*=256);)l+=this[e+--t]*i;return l},s.prototype.readUInt8=function(e,t){return t||C(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return t||C(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return t||C(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var l=this[e],i=1,r=0;++r<t&&(i*=256);)l+=this[e+r]*i;return l>=(i*=128)&&(l-=Math.pow(2,8*t)),l},s.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var l=t,i=1,r=this[e+--l];l>0&&(i*=256);)r+=this[e+--l]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readInt8=function(e,t){return t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){t||C(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){t||C(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return t||C(e,4,this.length),i.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return t||C(e,4,this.length),i.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return t||C(e,8,this.length),i.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return t||C(e,8,this.length),i.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,n,l){(e=+e,t|=0,n|=0,l)||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,r=0;for(this[t]=255&e;++r<n&&(i*=256);)this[t+r]=e/i&255;return t+n},s.prototype.writeUIntBE=function(e,t,n,l){(e=+e,t|=0,n|=0,l)||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,r=1;for(this[t+i]=255&e;--i>=0&&(r*=256);)this[t+i]=e/r&255;return t+n},s.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,255,0),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):A(this,e,t,!0),t+4},s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},s.prototype.writeIntLE=function(e,t,n,l){if(e=+e,t|=0,!l){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var r=0,a=1,o=0;for(this[t]=255&e;++r<n&&(a*=256);)e<0&&0===o&&0!==this[t+r-1]&&(o=1),this[t+r]=(e/a>>0)-o&255;return t+n},s.prototype.writeIntBE=function(e,t,n,l){if(e=+e,t|=0,!l){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var r=n-1,a=1,o=0;for(this[t+r]=255&e;--r>=0&&(a*=256);)e<0&&0===o&&0!==this[t+r+1]&&(o=1),this[t+r]=(e/a>>0)-o&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,127,-128),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):A(this,e,t,!0),t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},s.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return O(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return O(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,l){if(n||(n=0),l||0===l||(l=this.length),t>=e.length&&(t=e.length),t||(t=0),l>0&&l<n&&(l=n),l===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(l<0)throw new RangeError("sourceEnd out of bounds");l>this.length&&(l=this.length),e.length-t<l-n&&(l=e.length-t+n);var i,r=l-n;if(this===e&&n<t&&t<l)for(i=r-1;i>=0;--i)e[i+t]=this[i+n];else if(r<1e3||!s.TYPED_ARRAY_SUPPORT)for(i=0;i<r;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+r),t);return r},s.prototype.fill=function(e,t,n,l){if("string"==typeof e){if("string"==typeof t?(l=t,t=0,n=this.length):"string"==typeof n&&(l=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==l&&"string"!=typeof l)throw new TypeError("encoding must be a string");if("string"==typeof l&&!s.isEncoding(l))throw new TypeError("Unknown encoding: "+l)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{var a=s.isBuffer(e)?e:H(new s(e,l).toString()),o=a.length;for(r=0;r<n-t;++r)this[r+t]=a[r%o]}return this};var D=/[^+\/0-9A-Za-z-_]/g;function W(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){var n;t=t||1/0;for(var l=e.length,i=null,r=[],a=0;a<l;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&r.push(239,191,189);continue}if(a+1===l){(t-=3)>-1&&r.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&r.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&r.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;r.push(n)}else if(n<2048){if((t-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function $(e){return l.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,n,l){for(var i=0;i<l&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(12))},36:function(e,t,n){"use strict";t.byteLength=function(e){var t=d(e),n=t[0],l=t[1];return 3*(n+l)/4-l},t.toByteArray=function(e){var t,n,l=d(e),a=l[0],o=l[1],s=new r(function(e,t,n){return 3*(t+n)/4-n}(0,a,o)),c=0,u=o>0?a-4:a;for(n=0;n<u;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],s[c++]=t>>16&255,s[c++]=t>>8&255,s[c++]=255&t;2===o&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,s[c++]=255&t);1===o&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,s[c++]=t>>8&255,s[c++]=255&t);return s},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,r=[],a=0,o=n-i;a<o;a+=16383)r.push(c(e,a,a+16383>o?o:a+16383));1===i?(t=e[n-1],r.push(l[t>>2]+l[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],r.push(l[t>>10]+l[t>>4&63]+l[t<<2&63]+"="));return r.join("")};for(var l=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,s=a.length;o<s;++o)l[o]=a[o],i[a.charCodeAt(o)]=o;function d(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var i,r,a=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(l[(r=i)>>18&63]+l[r>>12&63]+l[r>>6&63]+l[63&r]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},37:function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,l,i){var r,a,o=8*i-l-1,s=(1<<o)-1,d=s>>1,c=-7,u=n?i-1:0,m=n?-1:1,h=e[t+u];for(u+=m,r=h&(1<<-c)-1,h>>=-c,c+=o;c>0;r=256*r+e[t+u],u+=m,c-=8);for(a=r&(1<<-c)-1,r>>=-c,c+=l;c>0;a=256*a+e[t+u],u+=m,c-=8);if(0===r)r=1-d;else{if(r===s)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,l),r-=d}return(h?-1:1)*a*Math.pow(2,r-l)},t.write=function(e,t,n,l,i,r){var a,o,s,d=8*r-i-1,c=(1<<d)-1,u=c>>1,m=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=l?0:r-1,p=l?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),(t+=a+u>=1?m/s:m*Math.pow(2,1-u))*s>=2&&(a++,s/=2),a+u>=c?(o=0,a=c):a+u>=1?(o=(t*s-1)*Math.pow(2,i),a+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,i),a=0));i>=8;e[n+h]=255&o,h+=p,o/=256,i-=8);for(a=a<<i|o,d+=i;d>0;e[n+h]=255&a,h+=p,a/=256,d-=8);e[n+h-p]|=128*g}},38:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},39:function(e,t,n){"use strict";n.r(t),n.d(t,"mainGridInstance",(function(){return AB})),n.d(t,"weftGridInstance",(function(){return FB})),n.d(t,"tempWeftGridInstance",(function(){return MB})),n.d(t,"tempWarpGridInstance",(function(){return OB})),n.d(t,"warpGridInstance",(function(){return DB})),n.d(t,"dentGridInstance",(function(){return WB})),n.d(t,"lSalvageMainGridInstance",(function(){return $B})),n.d(t,"lSalVageWeftGridInstance",(function(){return qB})),n.d(t,"lSalvageDentGridInstance",(function(){return jB})),n.d(t,"rSalvageMainGridInstance",(function(){return VB})),n.d(t,"rSalVageWeftGridInstance",(function(){return zB})),n.d(t,"rSalvageDentGridInstance",(function(){return UB})),n.d(t,"weftColorGridInstance",(function(){return XB})),n.d(t,"warpColorGridInstance",(function(){return KB})),n.d(t,"changeWarpColorGridInstance",(function(){return oL})),n.d(t,"changeWeftColorGridInstance",(function(){return sL})),n.d(t,"warpCreamingGridInstance",(function(){return JB})),n.d(t,"tieupGridInstance",(function(){return HB})),n.d(t,"wasm",(function(){return aL})),n.d(t,"drawFunction",(function(){return eL})),n.d(t,"instanceInitFunction",(function(){return QB})),n.d(t,"firstBeamGridInstance",(function(){return ZB})),n.d(t,"compressSeqString",(function(){return nL})),n.d(t,"functionGridInstance",(function(){return YB})),n.d(t,"densityGridInstance",(function(){return GB})),n.d(t,"rustPrintObject",(function(){return rL})),n.d(t,"compressPlanString",(function(){return iL})),n.d(t,"compressSeqPrefixString",(function(){return lL})),n.d(t,"reedElement",(function(){return NB})),n.d(t,"treadlesElement",(function(){return RB})),n.d(t,"loadingAnimationElement",(function(){return TB}));var l={};n.r(l),n.d(l,"hasBrowserEnv",(function(){return Po})),n.d(l,"hasStandardBrowserWebWorkerEnv",(function(){return Ro})),n.d(l,"hasStandardBrowserEnv",(function(){return Co}));var i={value:()=>{}};function r(){for(var e,t=0,n=arguments.length,l={};t<n;++t){if(!(e=arguments[t]+"")||e in l||/[\s.]/.test(e))throw new Error("illegal type: "+e);l[e]=[]}return new a(l)}function a(e){this._=e}function o(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",l=e.indexOf(".");if(l>=0&&(n=e.slice(l+1),e=e.slice(0,l)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function s(e,t){for(var n,l=0,i=e.length;l<i;++l)if((n=e[l]).name===t)return n.value}function d(e,t,n){for(var l=0,r=e.length;l<r;++l)if(e[l].name===t){e[l]=i,e=e.slice(0,l).concat(e.slice(l+1));break}return null!=n&&e.push({name:t,value:n}),e}a.prototype=r.prototype={constructor:a,on:function(e,t){var n,l=this._,i=o(e+"",l),r=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++r<a;)if(n=(e=i[r]).type)l[n]=d(l[n],e.name,t);else if(null==t)for(n in l)l[n]=d(l[n],e.name,null);return this}for(;++r<a;)if((n=(e=i[r]).type)&&(n=s(l[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new a(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,l,i=new Array(n),r=0;r<n;++r)i[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(r=0,n=(l=this._[e]).length;r<n;++r)l[r].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var l=this._[e],i=0,r=l.length;i<r;++i)l[i].value.apply(t,n)}};var c=r;function u(){}var m=function(e){return null==e?u:function(){return this.querySelector(e)}};function h(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function p(){return[]}var g=function(e){return null==e?p:function(){return this.querySelectorAll(e)}};var f=function(e){return function(){return this.matches(e)}};function y(e){return function(t){return t.matches(e)}}var v=Array.prototype.find;function b(){return this.firstElementChild}var w=Array.prototype.filter;function E(){return Array.from(this.children)}var I=function(e){return new Array(e.length)};function S(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}S.prototype={constructor:S,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var k=function(e){return function(){return e}};function x(e,t,n,l,i,r){for(var a,o=0,s=t.length,d=r.length;o<d;++o)(a=t[o])?(a.__data__=r[o],l[o]=a):n[o]=new S(e,r[o]);for(;o<s;++o)(a=t[o])&&(i[o]=a)}function T(e,t,n,l,i,r,a){var o,s,d,c=new Map,u=t.length,m=r.length,h=new Array(u);for(o=0;o<u;++o)(s=t[o])&&(h[o]=d=a.call(s,s.__data__,o,t)+"",c.has(d)?i[o]=s:c.set(d,s));for(o=0;o<m;++o)d=a.call(e,r[o],o,r)+"",(s=c.get(d))?(l[o]=s,s.__data__=r[o],c.delete(d)):n[o]=new S(e,r[o]);for(o=0;o<u;++o)(s=t[o])&&c.get(h[o])===s&&(i[o]=s)}function _(e){return e.__data__}function B(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function L(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var P="http://www.w3.org/1999/xhtml",C={svg:"http://www.w3.org/2000/svg",xhtml:P,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},N=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),C.hasOwnProperty(t)?{space:C[t],local:e}:e};function R(e){return function(){this.removeAttribute(e)}}function A(e){return function(){this.removeAttributeNS(e.space,e.local)}}function F(e,t){return function(){this.setAttribute(e,t)}}function M(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function O(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function D(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}var W=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function H(e){return function(){this.style.removeProperty(e)}}function q(e,t,n){return function(){this.style.setProperty(e,t,n)}}function j(e,t,n){return function(){var l=t.apply(this,arguments);null==l?this.style.removeProperty(e):this.style.setProperty(e,l,n)}}function V(e,t){return e.style.getPropertyValue(t)||W(e).getComputedStyle(e,null).getPropertyValue(t)}function z(e){return function(){delete this[e]}}function U(e,t){return function(){this[e]=t}}function Y(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function J(e){return e.trim().split(/^|\s+/)}function G(e){return e.classList||new X(e)}function X(e){this._node=e,this._names=J(e.getAttribute("class")||"")}function K(e,t){for(var n=G(e),l=-1,i=t.length;++l<i;)n.add(t[l])}function Z(e,t){for(var n=G(e),l=-1,i=t.length;++l<i;)n.remove(t[l])}function Q(e){return function(){K(this,e)}}function ee(e){return function(){Z(this,e)}}function te(e,t){return function(){(t.apply(this,arguments)?K:Z)(this,e)}}X.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ne(){this.textContent=""}function le(e){return function(){this.textContent=e}}function ie(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function re(){this.innerHTML=""}function ae(e){return function(){this.innerHTML=e}}function oe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function se(){this.nextSibling&&this.parentNode.appendChild(this)}function de(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ce(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===P&&t.documentElement.namespaceURI===P?t.createElement(e):t.createElementNS(n,e)}}function ue(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}var me=function(e){var t=N(e);return(t.local?ue:ce)(t)};function he(){return null}function pe(){var e=this.parentNode;e&&e.removeChild(this)}function ge(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fe(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ye(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function ve(e){return function(){var t=this.__on;if(t){for(var n,l=0,i=-1,r=t.length;l<r;++l)n=t[l],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function be(e,t,n){return function(){var l,i=this.__on,r=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var a=0,o=i.length;a<o;++a)if((l=i[a]).type===e.type&&l.name===e.name)return this.removeEventListener(l.type,l.listener,l.options),this.addEventListener(l.type,l.listener=r,l.options=n),void(l.value=t);this.addEventListener(e.type,r,n),l={type:e.type,name:e.name,value:t,listener:r,options:n},i?i.push(l):this.__on=[l]}}function we(e,t,n){var l=W(e),i=l.CustomEvent;"function"==typeof i?i=new i(t,n):(i=l.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Ee(e,t){return function(){return we(this,e,t)}}function Ie(e,t){return function(){return we(this,e,t.apply(this,arguments))}}var Se=[null];function ke(e,t){this._groups=e,this._parents=t}function xe(){return new ke([[document.documentElement]],Se)}ke.prototype=xe.prototype={constructor:ke,select:function(e){"function"!=typeof e&&(e=m(e));for(var t=this._groups,n=t.length,l=new Array(n),i=0;i<n;++i)for(var r,a,o=t[i],s=o.length,d=l[i]=new Array(s),c=0;c<s;++c)(r=o[c])&&(a=e.call(r,r.__data__,c,o))&&("__data__"in r&&(a.__data__=r.__data__),d[c]=a);return new ke(l,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return h(e.apply(this,arguments))}}(e):g(e);for(var t=this._groups,n=t.length,l=[],i=[],r=0;r<n;++r)for(var a,o=t[r],s=o.length,d=0;d<s;++d)(a=o[d])&&(l.push(e.call(a,a.__data__,d,o)),i.push(a));return new ke(l,i)},selectChild:function(e){return this.select(null==e?b:function(e){return function(){return v.call(this.children,e)}}("function"==typeof e?e:y(e)))},selectChildren:function(e){return this.selectAll(null==e?E:function(e){return function(){return w.call(this.children,e)}}("function"==typeof e?e:y(e)))},filter:function(e){"function"!=typeof e&&(e=f(e));for(var t=this._groups,n=t.length,l=new Array(n),i=0;i<n;++i)for(var r,a=t[i],o=a.length,s=l[i]=[],d=0;d<o;++d)(r=a[d])&&e.call(r,r.__data__,d,a)&&s.push(r);return new ke(l,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,_);var n=t?T:x,l=this._parents,i=this._groups;"function"!=typeof e&&(e=k(e));for(var r=i.length,a=new Array(r),o=new Array(r),s=new Array(r),d=0;d<r;++d){var c=l[d],u=i[d],m=u.length,h=B(e.call(c,c&&c.__data__,d,l)),p=h.length,g=o[d]=new Array(p),f=a[d]=new Array(p),y=s[d]=new Array(m);n(c,u,g,f,y,h,t);for(var v,b,w=0,E=0;w<p;++w)if(v=g[w]){for(w>=E&&(E=w+1);!(b=f[E])&&++E<p;);v._next=b||null}}return(a=new ke(a,l))._enter=o,a._exit=s,a},enter:function(){return new ke(this._enter||this._groups.map(I),this._parents)},exit:function(){return new ke(this._exit||this._groups.map(I),this._parents)},join:function(e,t,n){var l=this.enter(),i=this,r=this.exit();return"function"==typeof e?(l=e(l))&&(l=l.selection()):l=l.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?r.remove():n(r),l&&i?l.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,l=t._groups,i=n.length,r=l.length,a=Math.min(i,r),o=new Array(i),s=0;s<a;++s)for(var d,c=n[s],u=l[s],m=c.length,h=o[s]=new Array(m),p=0;p<m;++p)(d=c[p]||u[p])&&(h[p]=d);for(;s<i;++s)o[s]=n[s];return new ke(o,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var l,i=e[t],r=i.length-1,a=i[r];--r>=0;)(l=i[r])&&(a&&4^l.compareDocumentPosition(a)&&a.parentNode.insertBefore(l,a),a=l);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=L);for(var n=this._groups,l=n.length,i=new Array(l),r=0;r<l;++r){for(var a,o=n[r],s=o.length,d=i[r]=new Array(s),c=0;c<s;++c)(a=o[c])&&(d[c]=a);d.sort(t)}return new ke(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var l=e[t],i=0,r=l.length;i<r;++i){var a=l[i];if(a)return a}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,l=t.length;n<l;++n)for(var i,r=t[n],a=0,o=r.length;a<o;++a)(i=r[a])&&e.call(i,i.__data__,a,r);return this},attr:function(e,t){var n=N(e);if(arguments.length<2){var l=this.node();return n.local?l.getAttributeNS(n.space,n.local):l.getAttribute(n)}return this.each((null==t?n.local?A:R:"function"==typeof t?n.local?D:O:n.local?M:F)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?H:"function"==typeof t?j:q)(e,t,null==n?"":n)):V(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?z:"function"==typeof t?Y:U)(e,t)):this.node()[e]},classed:function(e,t){var n=J(e+"");if(arguments.length<2){for(var l=G(this.node()),i=-1,r=n.length;++i<r;)if(!l.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?te:t?Q:ee)(n,t))},text:function(e){return arguments.length?this.each(null==e?ne:("function"==typeof e?ie:le)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?re:("function"==typeof e?oe:ae)(e)):this.node().innerHTML},raise:function(){return this.each(se)},lower:function(){return this.each(de)},append:function(e){var t="function"==typeof e?e:me(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:me(e),l=null==t?he:"function"==typeof t?t:m(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),l.apply(this,arguments)||null)}))},remove:function(){return this.each(pe)},clone:function(e){return this.select(e?fe:ge)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var l,i,r=ye(e+""),a=r.length;if(!(arguments.length<2)){for(o=t?be:ve,l=0;l<a;++l)this.each(o(r[l],t,n));return this}var o=this.node().__on;if(o)for(var s,d=0,c=o.length;d<c;++d)for(l=0,s=o[d];l<a;++l)if((i=r[l]).type===s.type&&i.name===s.name)return s.value},dispatch:function(e,t){return this.each(("function"==typeof t?Ie:Ee)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var l,i=e[t],r=0,a=i.length;r<a;++r)(l=i[r])&&(yield l)}};var Te=xe;var _e=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function Be(e,t){var n=Object.create(e.prototype);for(var l in t)n[l]=t[l];return n}function Le(){}var Pe="\\s*([+-]?\\d+)\\s*",Ce="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Re=/^#([0-9a-f]{3,8})$/,Ae=new RegExp(`^rgb\\(${Pe},${Pe},${Pe}\\)$`),Fe=new RegExp(`^rgb\\(${Ne},${Ne},${Ne}\\)$`),Me=new RegExp(`^rgba\\(${Pe},${Pe},${Pe},${Ce}\\)$`),Oe=new RegExp(`^rgba\\(${Ne},${Ne},${Ne},${Ce}\\)$`),De=new RegExp(`^hsl\\(${Ce},${Ne},${Ne}\\)$`),We=new RegExp(`^hsla\\(${Ce},${Ne},${Ne},${Ce}\\)$`),He={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function $e(){return this.rgb().formatHex()}function qe(){return this.rgb().formatRgb()}function je(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Re.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Ve(t):3===n?new Je(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?ze(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?ze(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Ae.exec(e))?new Je(t[1],t[2],t[3],1):(t=Fe.exec(e))?new Je(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Me.exec(e))?ze(t[1],t[2],t[3],t[4]):(t=Oe.exec(e))?ze(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=De.exec(e))?et(t[1],t[2]/100,t[3]/100,1):(t=We.exec(e))?et(t[1],t[2]/100,t[3]/100,t[4]):He.hasOwnProperty(e)?Ve(He[e]):"transparent"===e?new Je(NaN,NaN,NaN,0):null}function Ve(e){return new Je(e>>16&255,e>>8&255,255&e,1)}function ze(e,t,n,l){return l<=0&&(e=t=n=NaN),new Je(e,t,n,l)}function Ue(e){return e instanceof Le||(e=je(e)),e?new Je((e=e.rgb()).r,e.g,e.b,e.opacity):new Je}function Ye(e,t,n,l){return 1===arguments.length?Ue(e):new Je(e,t,n,null==l?1:l)}function Je(e,t,n,l){this.r=+e,this.g=+t,this.b=+n,this.opacity=+l}function Ge(){return`#${Qe(this.r)}${Qe(this.g)}${Qe(this.b)}`}function Xe(){const e=Ke(this.opacity);return`${1===e?"rgb(":"rgba("}${Ze(this.r)}, ${Ze(this.g)}, ${Ze(this.b)}${1===e?")":`, ${e})`}`}function Ke(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ze(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qe(e){return((e=Ze(e))<16?"0":"")+e.toString(16)}function et(e,t,n,l){return l<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new nt(e,t,n,l)}function tt(e){if(e instanceof nt)return new nt(e.h,e.s,e.l,e.opacity);if(e instanceof Le||(e=je(e)),!e)return new nt;if(e instanceof nt)return e;var t=(e=e.rgb()).r/255,n=e.g/255,l=e.b/255,i=Math.min(t,n,l),r=Math.max(t,n,l),a=NaN,o=r-i,s=(r+i)/2;return o?(a=t===r?(n-l)/o+6*(n<l):n===r?(l-t)/o+2:(t-n)/o+4,o/=s<.5?r+i:2-r-i,a*=60):o=s>0&&s<1?0:a,new nt(a,o,s,e.opacity)}function nt(e,t,n,l){this.h=+e,this.s=+t,this.l=+n,this.opacity=+l}function lt(e){return(e=(e||0)%360)<0?e+360:e}function it(e){return Math.max(0,Math.min(1,e||0))}function rt(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function at(e,t,n,l,i){var r=e*e,a=r*e;return((1-3*e+3*r-a)*t+(4-6*r+3*a)*n+(1+3*e+3*r-3*a)*l+a*i)/6}_e(Le,je,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$e,formatHex:$e,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return tt(this).formatHsl()},formatRgb:qe,toString:qe}),_e(Je,Ye,Be(Le,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Je(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new Je(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Je(Ze(this.r),Ze(this.g),Ze(this.b),Ke(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ge,formatHex:Ge,formatHex8:function(){return`#${Qe(this.r)}${Qe(this.g)}${Qe(this.b)}${Qe(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Xe,toString:Xe})),_e(nt,(function(e,t,n,l){return 1===arguments.length?tt(e):new nt(e,t,n,null==l?1:l)}),Be(Le,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new nt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new nt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,l=n+(n<.5?n:1-n)*t,i=2*n-l;return new Je(rt(e>=240?e-240:e+120,i,l),rt(e,i,l),rt(e<120?e+240:e-120,i,l),this.opacity)},clamp(){return new nt(lt(this.h),it(this.s),it(this.l),Ke(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ke(this.opacity);return`${1===e?"hsl(":"hsla("}${lt(this.h)}, ${100*it(this.s)}%, ${100*it(this.l)}%${1===e?")":`, ${e})`}`}}));var ot=e=>()=>e;function st(e,t){return function(n){return e+n*t}}function dt(e){return 1==(e=+e)?ct:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(l){return Math.pow(e+l*t,n)}}(t,n,e):ot(isNaN(t)?n:t)}}function ct(e,t){var n=t-e;return n?st(e,n):ot(isNaN(e)?t:e)}var ut=function e(t){var n=dt(t);function l(e,t){var l=n((e=Ye(e)).r,(t=Ye(t)).r),i=n(e.g,t.g),r=n(e.b,t.b),a=ct(e.opacity,t.opacity);return function(t){return e.r=l(t),e.g=i(t),e.b=r(t),e.opacity=a(t),e+""}}return l.gamma=e,l}(1);function mt(e){return function(t){var n,l,i=t.length,r=new Array(i),a=new Array(i),o=new Array(i);for(n=0;n<i;++n)l=Ye(t[n]),r[n]=l.r||0,a[n]=l.g||0,o[n]=l.b||0;return r=e(r),a=e(a),o=e(o),l.opacity=1,function(e){return l.r=r(e),l.g=a(e),l.b=o(e),l+""}}}mt((function(e){var t=e.length-1;return function(n){var l=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[l],r=e[l+1],a=l>0?e[l-1]:2*i-r,o=l<t-1?e[l+2]:2*r-i;return at((n-l/t)*t,a,i,r,o)}})),mt((function(e){var t=e.length;return function(n){var l=Math.floor(((n%=1)<0?++n:n)*t),i=e[(l+t-1)%t],r=e[l%t],a=e[(l+1)%t],o=e[(l+2)%t];return at((n-l/t)*t,i,r,a,o)}}));var ht=function(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}},pt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gt=new RegExp(pt.source,"g");var ft,yt,vt=function(e,t){var n,l,i,r=pt.lastIndex=gt.lastIndex=0,a=-1,o=[],s=[];for(e+="",t+="";(n=pt.exec(e))&&(l=gt.exec(t));)(i=l.index)>r&&(i=t.slice(r,i),o[a]?o[a]+=i:o[++a]=i),(n=n[0])===(l=l[0])?o[a]?o[a]+=l:o[++a]=l:(o[++a]=null,s.push({i:a,x:ht(n,l)})),r=gt.lastIndex;return r<t.length&&(i=t.slice(r),o[a]?o[a]+=i:o[++a]=i),o.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,l=0;l<t;++l)o[(n=s[l]).i]=n.x(e);return o.join("")})},bt=0,wt=0,Et=0,It=0,St=0,kt=0,xt="object"==typeof performance&&performance.now?performance:Date,Tt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function _t(){return St||(Tt(Bt),St=xt.now()+kt)}function Bt(){St=0}function Lt(){this._call=this._time=this._next=null}function Pt(e,t,n){var l=new Lt;return l.restart(e,t,n),l}function Ct(){St=(It=xt.now())+kt,bt=wt=0;try{!function(){_t(),++bt;for(var e,t=ft;t;)(e=St-t._time)>=0&&t._call.call(void 0,e),t=t._next;--bt}()}finally{bt=0,function(){var e,t,n=ft,l=1/0;for(;n;)n._call?(l>n._time&&(l=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:ft=t);yt=e,Rt(l)}(),St=0}}function Nt(){var e=xt.now(),t=e-It;t>1e3&&(kt-=t,It=e)}function Rt(e){bt||(wt&&(wt=clearTimeout(wt)),e-St>24?(e<1/0&&(wt=setTimeout(Ct,e-xt.now()-kt)),Et&&(Et=clearInterval(Et))):(Et||(It=xt.now(),Et=setInterval(Nt,1e3)),bt=1,Tt(Ct)))}Lt.prototype=Pt.prototype={constructor:Lt,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?_t():+n)+(null==t?0:+t),this._next||yt===this||(yt?yt._next=this:ft=this,yt=this),this._call=e,this._time=n,Rt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Rt())}};var At=function(e,t,n){var l=new Lt;return t=null==t?0:+t,l.restart(n=>{l.stop(),e(n+t)},t,n),l},Ft=c("start","end","cancel","interrupt"),Mt=[],Ot=function(e,t,n,l,i,r){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var l,i=e.__transition;function r(s){var d,c,u,m;if(1!==n.state)return o();for(d in i)if((m=i[d]).name===n.name){if(3===m.state)return At(r);4===m.state?(m.state=6,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete i[d]):+d<t&&(m.state=6,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete i[d])}if(At((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(s))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,l=new Array(u=n.tween.length),d=0,c=-1;d<u;++d)(m=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(l[++c]=m);l.length=c+1}}function a(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(o),n.state=5,1),r=-1,a=l.length;++r<a;)l[r].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),o())}function o(){for(var l in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=Pt((function(e){n.state=1,n.timer.restart(r,n.delay,n.time),n.delay<=e&&r(e-n.delay)}),0,n.time)}(e,n,{name:t,index:l,group:i,on:Ft,tween:Mt,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:0})};function Dt(e,t){var n=Ht(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Wt(e,t){var n=Ht(e,t);if(n.state>3)throw new Error("too late; already running");return n}function Ht(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}var $t,qt=function(e,t){var n,l,i,r=e.__transition,a=!0;if(r){for(i in t=null==t?null:t+"",r)(n=r[i]).name===t?(l=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(l?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[i]):a=!1;a&&delete e.__transition}},jt=180/Math.PI,Vt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},zt=function(e,t,n,l,i,r){var a,o,s;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(s=e*n+t*l)&&(n-=e*s,l-=t*s),(o=Math.sqrt(n*n+l*l))&&(n/=o,l/=o,s/=o),e*l<t*n&&(e=-e,t=-t,s=-s,a=-a),{translateX:i,translateY:r,rotate:Math.atan2(t,e)*jt,skewX:Math.atan(s)*jt,scaleX:a,scaleY:o}};function Ut(e,t,n,l){function i(e){return e.length?e.pop()+" ":""}return function(r,a){var o=[],s=[];return r=e(r),a=e(a),function(e,l,i,r,a,o){if(e!==i||l!==r){var s=a.push("translate(",null,t,null,n);o.push({i:s-4,x:ht(e,i)},{i:s-2,x:ht(l,r)})}else(i||r)&&a.push("translate("+i+t+r+n)}(r.translateX,r.translateY,a.translateX,a.translateY,o,s),function(e,t,n,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:n.push(i(n)+"rotate(",null,l)-2,x:ht(e,t)})):t&&n.push(i(n)+"rotate("+t+l)}(r.rotate,a.rotate,o,s),function(e,t,n,r){e!==t?r.push({i:n.push(i(n)+"skewX(",null,l)-2,x:ht(e,t)}):t&&n.push(i(n)+"skewX("+t+l)}(r.skewX,a.skewX,o,s),function(e,t,n,l,r,a){if(e!==n||t!==l){var o=r.push(i(r)+"scale(",null,",",null,")");a.push({i:o-4,x:ht(e,n)},{i:o-2,x:ht(t,l)})}else 1===n&&1===l||r.push(i(r)+"scale("+n+","+l+")")}(r.scaleX,r.scaleY,a.scaleX,a.scaleY,o,s),r=a=null,function(e){for(var t,n=-1,l=s.length;++n<l;)o[(t=s[n]).i]=t.x(e);return o.join("")}}}var Yt=Ut((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Vt:zt(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Jt=Ut((function(e){return null==e?Vt:($t||($t=document.createElementNS("http://www.w3.org/2000/svg","g")),$t.setAttribute("transform",e),(e=$t.transform.baseVal.consolidate())?(e=e.matrix,zt(e.a,e.b,e.c,e.d,e.e,e.f)):Vt)}),", ",")",")");function Gt(e,t){var n,l;return function(){var i=Wt(this,e),r=i.tween;if(r!==n)for(var a=0,o=(l=n=r).length;a<o;++a)if(l[a].name===t){(l=l.slice()).splice(a,1);break}i.tween=l}}function Xt(e,t,n){var l,i;if("function"!=typeof n)throw new Error;return function(){var r=Wt(this,e),a=r.tween;if(a!==l){i=(l=a).slice();for(var o={name:t,value:n},s=0,d=i.length;s<d;++s)if(i[s].name===t){i[s]=o;break}s===d&&i.push(o)}r.tween=i}}function Kt(e,t,n){var l=e._id;return e.each((function(){var e=Wt(this,l);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return Ht(e,l).value[t]}}var Zt=function(e,t){var n;return("number"==typeof t?ht:t instanceof je?ut:(n=je(t))?(t=n,ut):vt)(e,t)};function Qt(e){return function(){this.removeAttribute(e)}}function en(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tn(e,t,n){var l,i,r=n+"";return function(){var a=this.getAttribute(e);return a===r?null:a===l?i:i=t(l=a,n)}}function nn(e,t,n){var l,i,r=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===r?null:a===l?i:i=t(l=a,n)}}function ln(e,t,n){var l,i,r;return function(){var a,o,s=n(this);if(null!=s)return(a=this.getAttribute(e))===(o=s+"")?null:a===l&&o===i?r:(i=o,r=t(l=a,s));this.removeAttribute(e)}}function rn(e,t,n){var l,i,r;return function(){var a,o,s=n(this);if(null!=s)return(a=this.getAttributeNS(e.space,e.local))===(o=s+"")?null:a===l&&o===i?r:(i=o,r=t(l=a,s));this.removeAttributeNS(e.space,e.local)}}function an(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function on(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function sn(e,t){var n,l;function i(){var i=t.apply(this,arguments);return i!==l&&(n=(l=i)&&on(e,i)),n}return i._value=t,i}function dn(e,t){var n,l;function i(){var i=t.apply(this,arguments);return i!==l&&(n=(l=i)&&an(e,i)),n}return i._value=t,i}function cn(e,t){return function(){Dt(this,e).delay=+t.apply(this,arguments)}}function un(e,t){return t=+t,function(){Dt(this,e).delay=t}}function mn(e,t){return function(){Wt(this,e).duration=+t.apply(this,arguments)}}function hn(e,t){return t=+t,function(){Wt(this,e).duration=t}}function pn(e,t){if("function"!=typeof t)throw new Error;return function(){Wt(this,e).ease=t}}function gn(e,t,n){var l,i,r=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?Dt:Wt;return function(){var a=r(this,e),o=a.on;o!==l&&(i=(l=o).copy()).on(t,n),a.on=i}}var fn=Te.prototype.constructor;function yn(e){return function(){this.style.removeProperty(e)}}function vn(e,t,n){return function(l){this.style.setProperty(e,t.call(this,l),n)}}function bn(e,t,n){var l,i;function r(){var r=t.apply(this,arguments);return r!==i&&(l=(i=r)&&vn(e,r,n)),l}return r._value=t,r}function wn(e){return function(t){this.textContent=e.call(this,t)}}function En(e){var t,n;function l(){var l=e.apply(this,arguments);return l!==n&&(t=(n=l)&&wn(l)),t}return l._value=e,l}var In=0;function Sn(e,t,n,l){this._groups=e,this._parents=t,this._name=n,this._id=l}function kn(){return++In}var xn=Te.prototype;Sn.prototype=function(e){return Te().transition(e)}.prototype={constructor:Sn,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=m(e));for(var l=this._groups,i=l.length,r=new Array(i),a=0;a<i;++a)for(var o,s,d=l[a],c=d.length,u=r[a]=new Array(c),h=0;h<c;++h)(o=d[h])&&(s=e.call(o,o.__data__,h,d))&&("__data__"in o&&(s.__data__=o.__data__),u[h]=s,Ot(u[h],t,n,h,u,Ht(o,n)));return new Sn(r,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=g(e));for(var l=this._groups,i=l.length,r=[],a=[],o=0;o<i;++o)for(var s,d=l[o],c=d.length,u=0;u<c;++u)if(s=d[u]){for(var m,h=e.call(s,s.__data__,u,d),p=Ht(s,n),f=0,y=h.length;f<y;++f)(m=h[f])&&Ot(m,t,n,f,h,p);r.push(h),a.push(s)}return new Sn(r,a,t,n)},selectChild:xn.selectChild,selectChildren:xn.selectChildren,filter:function(e){"function"!=typeof e&&(e=f(e));for(var t=this._groups,n=t.length,l=new Array(n),i=0;i<n;++i)for(var r,a=t[i],o=a.length,s=l[i]=[],d=0;d<o;++d)(r=a[d])&&e.call(r,r.__data__,d,a)&&s.push(r);return new Sn(l,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,l=t.length,i=n.length,r=Math.min(l,i),a=new Array(l),o=0;o<r;++o)for(var s,d=t[o],c=n[o],u=d.length,m=a[o]=new Array(u),h=0;h<u;++h)(s=d[h]||c[h])&&(m[h]=s);for(;o<l;++o)a[o]=t[o];return new Sn(a,this._parents,this._name,this._id)},selection:function(){return new fn(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=kn(),l=this._groups,i=l.length,r=0;r<i;++r)for(var a,o=l[r],s=o.length,d=0;d<s;++d)if(a=o[d]){var c=Ht(a,t);Ot(a,e,n,d,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Sn(l,this._parents,e,n)},call:xn.call,nodes:xn.nodes,node:xn.node,size:xn.size,empty:xn.empty,each:xn.each,on:function(e,t){var n=this._id;return arguments.length<2?Ht(this.node(),n).on.on(e):this.each(gn(n,e,t))},attr:function(e,t){var n=N(e),l="transform"===n?Jt:Zt;return this.attrTween(e,"function"==typeof t?(n.local?rn:ln)(n,l,Kt(this,"attr."+e,t)):null==t?(n.local?en:Qt)(n):(n.local?nn:tn)(n,l,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var l=N(e);return this.tween(n,(l.local?sn:dn)(l,t))},style:function(e,t,n){var l="transform"==(e+="")?Yt:Zt;return null==t?this.styleTween(e,function(e,t){var n,l,i;return function(){var r=V(this,e),a=(this.style.removeProperty(e),V(this,e));return r===a?null:r===n&&a===l?i:i=t(n=r,l=a)}}(e,l)).on("end.style."+e,yn(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var l,i,r;return function(){var a=V(this,e),o=n(this),s=o+"";return null==o&&(this.style.removeProperty(e),s=o=V(this,e)),a===s?null:a===l&&s===i?r:(i=s,r=t(l=a,o))}}(e,l,Kt(this,"style."+e,t))).each(function(e,t){var n,l,i,r,a="style."+t,o="end."+a;return function(){var s=Wt(this,e),d=s.on,c=null==s.value[a]?r||(r=yn(t)):void 0;d===n&&i===c||(l=(n=d).copy()).on(o,i=c),s.on=l}}(this._id,e)):this.styleTween(e,function(e,t,n){var l,i,r=n+"";return function(){var a=V(this,e);return a===r?null:a===l?i:i=t(l=a,n)}}(e,l,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var l="style."+(e+="");if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==t)return this.tween(l,null);if("function"!=typeof t)throw new Error;return this.tween(l,bn(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Kt(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,En(e))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}));var e},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var l,i=Ht(this.node(),n).tween,r=0,a=i.length;r<a;++r)if((l=i[r]).name===e)return l.value;return null}return this.each((null==t?Gt:Xt)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?cn:un)(t,e)):Ht(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?mn:hn)(t,e)):Ht(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(pn(t,e)):Ht(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;Wt(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,l=n._id,i=n.size();return new Promise((function(r,a){var o={value:a},s={value:function(){0==--i&&r()}};n.each((function(){var n=Wt(this,l),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(o),t._.interrupt.push(o),t._.end.push(s)),n.on=t})),0===i&&r()}))},[Symbol.iterator]:xn[Symbol.iterator]};var Tn={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function _n(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}Te.prototype.interrupt=function(e){return this.each((function(){qt(this,e)}))},Te.prototype.transition=function(e){var t,n;e instanceof Sn?(t=e._id,e=e._name):(t=kn(),(n=Tn).time=_t(),e=null==e?null:e+"");for(var l=this._groups,i=l.length,r=0;r<i;++r)for(var a,o=l[r],s=o.length,d=0;d<s;++d)(a=o[d])&&Ot(a,e,t,d,o,n||_n(a,t));return new Sn(l,this._parents,e,t)};const{abs:Bn,max:Ln,min:Pn}=Math;function Cn(e){return[+e[0],+e[1]]}function Nn(e){return[Cn(e[0]),Cn(e[1])]}["w","e"].map(Rn),["n","s"].map(Rn),["n","w","e","s","nw","ne","sw","se"].map(Rn);function Rn(e){return{type:e}}function An(e){return((e=Math.exp(e))+1/e)/2}(function e(t,n,l){function i(e,i){var r,a,o=e[0],s=e[1],d=e[2],c=i[0],u=i[1],m=i[2],h=c-o,p=u-s,g=h*h+p*p;if(g<1e-12)a=Math.log(m/d)/t,r=function(e){return[o+e*h,s+e*p,d*Math.exp(t*e*a)]};else{var f=Math.sqrt(g),y=(m*m-d*d+l*g)/(2*d*n*f),v=(m*m-d*d-l*g)/(2*m*n*f),b=Math.log(Math.sqrt(y*y+1)-y),w=Math.log(Math.sqrt(v*v+1)-v);a=(w-b)/t,r=function(e){var l,i=e*a,r=An(b),c=d/(n*f)*(r*(l=t*i+b,((l=Math.exp(2*l))-1)/(l+1))-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[o+c*h,s+c*p,d*r/An(t*i+b)]}}return r.duration=1e3*a*t/Math.SQRT2,r}return i.rho=function(t){var n=Math.max(.001,+t),l=n*n;return e(n,l,l*l)},i})(Math.SQRT2,2,4);function Fn(e,t,n){this.k=e,this.x=t,this.y=n}Fn.prototype={constructor:Fn,scale:function(e){return 1===e?this:new Fn(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Fn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new Fn(1,0,0);Fn.prototype;let Mn=!1;const On=0,Dn=0;let Wn=4,Hn=4;const $n="DRAWING";let qn={pixelSize:10,startRow:1,endRow:20,startColumn:0,endColumn:19};let jn=$n,Vn="",zn=10,Un=3,Yn="radio-weave",Jn=!1,Gn=!1,Xn=!1,Kn=!0,Zn=!1,Qn=!1,el=!1,tl=!0,nl=!0,ll=!1,il=!0,rl=!0,al=!1,ol=!0,sl="BOTH_VISIBLE",dl="INNER_GRID",cl="OUTER_GRID",ul="BOTH_INVISIBLE",ml={start:0,end:0},hl={start:0,end:0},pl={start:0,end:0},gl={start:0,end:0};const fl={GRAPHICALYESWITHNUMERICYES:"graphicalYesWithNumericYes",GRAPHICALYESWITHNUMERICNO:"graphicalYesWithNumericNo",GRAPHICALNOWITHNUMERICYES:"graphicalNoWithNumericYes",GRAPHICALNOWITHNUMERICNO:"graphicalNoWithNumericNo",WATERJETLETIS:"waterjetLetis"},yl="draft-pegplan-design-mode",vl="direct-drawing-design-mode",bl="pegplan-design-mode",wl="draw-on-command-mode",El="draft-text-design-mode",Il="draft-draw-design-mode",Sl="pegplan-text-design-mode",kl="pegplan-draw-design-mode",xl="ascending",Tl="descending";let _l=[{loomTypeValue:"none",loomTypeName:"None",noOfHook:0,tableData:{},visibleRow:[]},{loomTypeValue:"pt7",loomTypeName:"Pt-7",noOfHook:0,tableData:{},visibleRow:[]},{loomTypeValue:"rapier-manual-dobby",loomTypeName:"Rapier Manual Dobby",noOfHook:40,tableData:{"shaft-start":1,"shaft-end":20,"shaft-num":20,"fidder-start":21,"fidder-end":28,"fidder-num":8,"density-start":33,"density-end":40,"density-num":8,"cramming-start":30,"cramming-end":30,"cramming-num":1},visibleRow:["Shaft","Fidder","Cramming","Density"]},{loomTypeValue:"chines-dobby",loomTypeName:"Chines Dobby .wjl",noOfHook:40,tableData:{"shaft-start":1,"shaft-end":20,"shaft-num":20,"fidder-start":21,"fidder-end":28,"fidder-num":8,"cramming-start":30,"cramming-end":30,"cramming-num":1},visibleRow:["Shaft","Fidder","Cramming"]},{loomTypeValue:"action-cad",loomTypeName:"Action Cad .heb",noOfHook:40,tableData:{"shaft-start":1,"shaft-end":24,"shaft-num":24,"fidder-start":33,"fidder-end":40,"fidder-num":8,"cramming-start":25,"cramming-end":25,"cramming-num":1,"density-start":26,"density-end":32,"density-num":7},visibleRow:["Shaft","Fidder","Cramming","Density"]},{loomTypeValue:"airjet-dobby",loomTypeName:"Airjet Dobby .dat",noOfHook:32,tableData:{"shaft-start":1,"shaft-end":16,"shaft-num":16,"fidder-start":17,"fidder-end":24,"fidder-num":8,"density-start":25,"density-end":32,"density-num":8},visibleRow:["Shaft","Fidder","Density"]},{loomTypeValue:"rifa",loomTypeName:"RIFA .bin",noOfHook:32,tableData:{"shaft-start":1,"shaft-end":20,"shaft-num":20,"density-start":21,"density-end":23,"density-num":3,"cramming-start":24,"cramming-end":24,"cramming-num":1,"fidder-start":25,"fidder-end":32,"fidder-num":8},visibleRow:["Shaft","Density","Cramming","Fidder"]},{loomTypeValue:"spactrum",loomTypeName:"Spactrum",noOfHook:32,tableData:{"shaft-start":1,"shaft-end":20,"shaft-num":20,"fidder-start":21,"fidder-end":28,"fidder-num":8,"density-start":29,"density-end":40,"density-num":12},visibleRow:["Shaft","Fidder","Density"]},{loomTypeValue:"db1-profile",loomTypeName:"Staubli 1859.db1",noOfHook:40,tableData:{"shaft-start":1,"shaft-end":28,"shaft-num":28,"fidder-start":1,"fidder-end":8,"fidder-num":8,"cramming-start":9,"cramming-end":9,"cramming-num":1},visibleRow:["Shaft","Fidder","Cramming"]},{loomTypeValue:"bnx-profile",loomTypeName:"Nanjinbana .bnx",noOfHook:40,tableData:{"shaft-start":1,"shaft-end":16,"shaft-num":16,"fidder-start":17,"fidder-end":24,"fidder-num":8,"density-start":25,"density-end":32,"density-num":8},visibleRow:["Shaft","Fidder","Density"]}],Bl=sl,Ll=!1,Pl=!0;let Cl=!1,Nl=!1;let Rl=10;const Al=e=>{Wn=e},Fl=e=>{Hn=e},Ml=e=>{Ll=e},Ol=e=>{Vn=e},Dl=e=>{Gn=e},Wl=e=>{rl=e},Hl=e=>{ol=e},$l=e=>{Zn=e},ql=e=>{Qn=e},jl=e=>{el=e},Vl=()=>{Cl=!Cl},zl=e=>{tl=e},Ul="newfile",Yl="editfile",Jl="",Gl="Pegplan",Xl="Draft",Kl="Design",Zl="Weft",Ql="Warp",ei="Denting",ti="Creaming Bar",ni="Density Bar",li="Skip Dent",ii="Double Beam",ri="Extra Warp",ai=["rgb(0,0,0)","rgb(255,128,0)","rgb(255,0,255)","rgb(0,255,255)","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"],oi=["rgb(255,0,0)","rgb(0,0,255)","rgb(255,255,0)","rgb(0,255,0)","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"],si=["rgb(255,255,255)","rgb(255 ,0 ,0)","rgb(0,0,255)","rgb(0,255,0)","rgb(255,0,128)","rgb(255,255,0)","rgb(0,128,255)","rgb(0,128,0)","rgb(255,128,0)","rgb(255,0,255)","rgb(0,255,255)","rgb(192,192,192)","rgb(0,128,128)","rgb(128,0,128)","rgb(0,200,110)","#000000","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"],di=e=>{Pl=e};class ci{constructor(e,t){this.color_code=e,this.index=t}}var ui=class{constructor(e,t=!1,n=!1,l=!1,i=!1,r=!1){this.size=e,this.isWeftColor=t,this.isFunctionCanvas=n,this.isWarpColor=l,this.isWarpCreamingCanvas=i,this.isDencityCanvas=r,this.cells=n||i?[]:Array.apply(null,Array(e)).map((function(e,t){return new ci("A",t)})),this.fixNumericText=""}setFixNumericText(e){this.fixNumericText=e}getVisibleCells(e,t,n=!1){if(this.isWarpColor){if(n){let n=this.size,l=[],i=this.cells.sort((e,t)=>e.index-t.index).map(e=>e.color_code);for(let r=e;r<=t;r++)l.push(i[r%n]);return l}return this.cells.filter(n=>e<=n.index&&t>=n.index).sort((e,t)=>e.index-t.index).map(e=>e.color_code)}if(this.isWarpCreamingCanvas){if(n){let n=this.size,l=[];for(let i=e;i<=t;i++){let e=parseInt(i/n),t=this.cells.find(e=>e.index==i%n);t&&l.push({...t,index:t.index+n*e})}return l}return this.cells.filter(n=>e<=n.index&&t>=n.index).sort((e,t)=>e.index-t.index)}if(this.isWeftColor){if(n){let n=this.size;const l=n-t%n,i=l+(t-e+1);let r=[],a=this.cells.sort((e,t)=>e.index-t.index).map(e=>e.color_code);for(let e=l;e<=i;e++)r.push(a[e%n]);return r}return this.cells.filter(n=>e<=this.size-n.index&&t>=this.size-n.index).sort((e,t)=>e.index-t.index).map(e=>e.color_code)}if(this.isFunctionCanvas||this.isDencityCanvas){if(n){let n=this.size;const l=n-(t%n==0?n:t%n),i=l+(t-e+1);let r=[];for(let e=l;e<=i;e++){let t=parseInt(e/n),l=this.cells.find(t=>t.index==e%n);l&&r.push({...l,index:l.index+n*t})}return r}return this.cells.filter(n=>e<=this.size-n.index&&t>=this.size-n.index)}return[]}set_all_value_from_string(e,t=!1){try{let n=JSON.parse(e);n&&(this.size=n.size,this.isWeftColor=n.isWeftColor,this.isFunctionCanvas=n.isFunctionCanvas,this.isWarpColor=n.isWarpColor,this.isWarpCreamingCanvas=n.isWarpCreamingCanvas,this.isDencityCanvas=t,this.cells=n.cells)}catch(e){}}remove_cell(e){if(this.isWarpColor||this.isWarpCreamingCanvas){let t=[];for(let n=0;n<this.cells.length;n++){let l=this.cells[n];l.index!=e&&(l.index>e?t.push({...l,index:l.index-1}):t.push(l))}this.cells=t,this.size=this.size-1}if(this.isWeftColor||this.isFunctionCanvas){let t=[];for(let n=0;n<this.cells.length;n++){let l=this.cells[n];l.index!=this.size-e-1&&(l.index>this.size-e-1?t.push({...l,index:l.index-1}):t.push(l))}this.cells=t,this.size=this.size-1}}add_cell(e){console.log("add_index",e,this),this.isWarpColor&&(this.cells=this.cells.map(t=>({...t,index:t.index>=e?t.index+1:t.index})),this.cells.push(new ci("A",e))),this.isWarpCreamingCanvas&&(this.cells=this.cells.map(t=>({...t,index:t.index>=e?t.index+1:t.index}))),this.isFunctionCanvas&&(this.cells=this.cells.map(t=>({...t,index:this.size-t.index-1<=e?t.index+1:t.index}))),this.isWeftColor&&(this.cells=this.cells.map(t=>({...t,index:this.size-t.index<=e?t.index+1:t.index})),this.cells.push(new ci("A",this.size-e))),this.size=this.size+1}update_size(e){let t=this.size;if(this.size=e,this.isWeftColor){this.cells=this.cells.map(n=>({...n,index:e+n.index-t}));let n=Array.apply(null,Array(e)).map((function(e,t){return new ci("A",t)}));this.cells.forEach(e=>{let t=n.findIndex(t=>t.index==e.index);-1!=t&&(n[t].color_code=e.color_code)}),this.cells=n}if(this.isWarpColor){if(t>e)this.cells=this.cells.filter(t=>t.index<e);else if(t<e)for(let n=t;n<e;n++)this.cells.push(new ci("A",n))}else if(!this.isFunctionCanvas&&!this.isWarpCreamingCanvas){console.log("else if case");let t=Array.apply(null,Array(e)).map((function(e,t){return new ci("A",t)}));this.cells.forEach(e=>{let n=t.findIndex(t=>t.index==e.index);-1!=n&&(t[n].color_code=e.color_code)}),this.cells=t}}update_cell(e,t){let n=this.cells.findIndex(t=>t.index==e);t&&(-1==n?this.cells.push(new ci(t,e)):this.cells[n].color_code=t)}update_function_cell(e,t){let n=this.cells.findIndex(t=>t.index==e);t&&(-1==n?this.cells.push(new ci(t,e)):this.cells.splice(n,1))}findElementFromIndex(e){return this.cells.find(t=>t.index==e)}getMinimumIndex(){return Math.min(...this.cells.map(e=>e.index))}getMaximumIndex(){return Math.max(...this.cells.map(e=>e.index))}};const mi=document.getElementById("l-salvage-weft-canvas"),hi=document.getElementById("l-salvage-main-canvas"),pi=document.getElementById("l-salvage-dent-canvas"),gi=document.getElementById("left-salvage"),fi=document.getElementById("Total-Lsalvage"),yi=mi.getContext("2d"),vi=hi.getContext("2d"),bi=pi.getContext("2d"),wi=(document.getElementById("l-salvage-weft-subparent"),document.getElementById("l-salvage-dent-container"),document.getElementById("l-salvage-main-subparent"),document.getElementById("l-salvage-dent-click-canvas")),Ei=wi.getContext("2d"),Ii=()=>{Ml(!1)},Si=e=>{Ll&&((e=>{const t=mi.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top,i=qB.cell_size(),r=parseInt(n/i)+parseInt(l/i)*qB.cols();qB.add_cell(r,$B,DB)})(e),_i())},ki=e=>{Ml(!0),(e=>{const t=mi.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top,i=qB.cell_size(),r=parseInt(n/i)+parseInt(l/i)*qB.cols();qB.click_on_cell(r,$B,DB)})(e),_i()},xi=e=>{e.preventDefault();const t=pi.getBoundingClientRect(),n=jB.cols(),l=(e.clientX-t.left)%(10*n),i=(e.clientY-t.top)%10,r=parseInt(i/10),a=parseInt(l/10)+r*jB.cols();0==e.button?jB.add_click_cell(a,!0):2==e.button&&jB.add_click_cell(a,!1),Pi()},Ti=e=>{(e=>{const t=pi.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top,i=jB.cell_size(),r=parseInt(n/i)+parseInt(l/i)*jB.cols();jB.add_cell(r)})(e),Li()},_i=()=>{const e=qB.cols(),t=qB.rows(),n=qB.cell_size(),l=On,i=Dn,r=document.createElement("canvas");r.width=e*n,r.height=t*n;const a=r.getContext("2d");a.clearRect(0,0,r.width,r.height),yi.clearRect(0,0,mi.width,mi.height),mi.width=r.width,mi.height=r.height;for(let r=0;r<e+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l+r*n,i),a.lineTo(l+r*n,i+t*n),a.lineWidth=r%Wn==0?1.5:.5,a.stroke(),a.closePath();for(let r=0;r<t+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l,i+r*n),a.lineTo(l+e*n,i+r*n),a.lineWidth=(t-r)%Hn==0?1.5:.5,a.stroke(),a.closePath();const o=new Uint32Array(aL.memory.buffer,qB.cells(),qB.selected_l_salvage_weftgrid_length());if(a.beginPath(),o.forEach(e=>{a.fillRect(e%qB.cols()*n,parseInt(e/qB.cols())*n,n,n)}),a.closePath(),Mn){const e=yi.createPattern(r,"repeat");yi.rect(0,0,mi.width,mi.height),yi.fillStyle=e,yi.fill()}else yi.drawImage(r,0,0);Bi()},Bi=()=>{if(Number(fi.value)>0){const e=$B.cols(),t=$B.rows(),n=1*AB.width(),l=Number(parseFloat(1*AB.height()).toFixed(2)),i=On,r=Dn,a=document.createElement("canvas");a.width=Math.ceil(e*n),a.height=Math.ceil(t*l);const o=a.getContext("2d");o.clearRect(0,0,a.width,a.height),vi.clearRect(0,0,hi.width,hi.height);for(let a=0;a<e+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.lineWidth=a%Wn==0?1.5:.5,o.stroke(),o.closePath();for(let a=0;a<t+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.lineWidth=(t-a)%Hn==0?1.5:.5,o.stroke(),o.closePath();const s=new Uint32Array(aL.memory.buffer,$B.cells(),$B.selected_l_salvage_maingrid_length());if(o.beginPath(),s.forEach(e=>{o.fillRect(e%$B.cols()*n,parseInt(e/$B.cols())*l,n,l)}),o.closePath(),gi.style.width="auto",Mn){hi.width=a.width,hi.height=a.height*Un;const e=vi.createPattern(a,"repeat");vi.rect(0,0,hi.width,hi.height),vi.fillStyle=e,vi.fill()}else hi.height=a.height,hi.width=a.width,vi.drawImage(a,0,0)}},Li=()=>{const e=jB.cols(),t=jB.rows(),n=jB.cell_size(),l=On,i=Dn,r=document.createElement("canvas");r.width=e*n,r.height=t*n;const a=r.getContext("2d");a.clearRect(0,0,r.width,r.height),bi.clearRect(0,0,pi.width,pi.height),pi.width=r.width,pi.height=r.height;for(let r=0;r<e+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l+r*n,i),a.lineTo(l+r*n,i+t*n),a.stroke(),a.closePath();for(let r=0;r<t+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l,i+r*n),a.lineTo(l+e*n,i+r*n),a.stroke(),a.closePath();const o=new Uint32Array(aL.memory.buffer,jB.cells(),jB.selected_l_salvage_dentgrid_length());if(a.beginPath(),o.forEach(t=>{a.fillRect(t%e*n,parseInt(t/e)*n,n,n)}),a.closePath(),Mn){const e=bi.createPattern(r,"repeat");bi.rect(0,0,pi.width,pi.height),bi.fillStyle=e,bi.fill()}else bi.drawImage(r,0,0);Pi()},Pi=()=>{const e=new Uint32Array(aL.memory.buffer,jB.click_cells(),jB.click_l_salvage_dentgrid_length()),t=jB.cols(),n=jB.rows(),l=jB.cell_size(),i=On,r=Dn,a=document.createElement("canvas");a.width=t*l,a.height=l;const o=a.getContext("2d");o.clearRect(0,0,a.width,a.height),Ei.clearRect(0,0,wi.width,wi.height),wi.width=a.width,wi.height=a.height;for(let e=0;e<t+1;e++)o.beginPath(),o.strokeStyle="white",o.moveTo(i+e*l,r),o.lineTo(i+e*l,r+n*l),o.stroke(),o.closePath();for(let e=0;e<n+1;e++)o.beginPath(),o.strokeStyle="white",o.moveTo(i,r+e*l),o.lineTo(i+t*l,r+e*l),o.stroke(),o.closePath();if(o.font="10px serif",e.forEach((t,n)=>{t>0&&o.fillText(e[n],(n+1)*l-4,8)}),Mn){const e=Ei.createPattern(a,"repeat");Ei.rect(0,0,wi.width,wi.height),Ei.fillStyle=e,Ei.fill()}else Ei.drawImage(a,0,0)},Ci=document.getElementById("r-salvage-weft-canvas"),Ni=document.getElementById("r-salvage-main-canvas"),Ri=document.getElementById("right-salvage"),Ai=(document.getElementById("r-salvage-dent-container"),document.getElementById("r-salvage-dent-click-canvas")),Fi=Ai.getContext("2d"),Mi=document.getElementById("r-salvage-dent-canvas"),Oi=document.getElementById("Total-Rsalvage"),Di=Mi.getContext("2d"),Wi=Ci.getContext("2d"),Hi=Ni.getContext("2d"),$i=(document.getElementById("r-salvage-weft-subparent"),document.getElementById("r-salvage-main-subparent"),e=>{Ll&&(ji(e),zi())}),qi=e=>{Ml(!0),Vi(e),zi()},ji=e=>{const t=Ci.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top,i=zB.cell_size(),r=parseInt(n/i)+parseInt(l/i)*zB.cols();zB.add_cell(r,VB,DB)},Vi=e=>{const t=Ci.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top,i=zB.cell_size(),r=parseInt(n/i)+parseInt(l/i)*zB.cols();zB.click_on_cell(r,VB,DB)},zi=()=>{const e=zB.cols(),t=zB.rows(),n=zB.cell_size(),l=On,i=Dn,r=document.createElement("canvas");r.width=e*n,r.height=t*n;const a=r.getContext("2d");a.clearRect(0,0,r.width,r.height),Wi.clearRect(0,0,Ci.width,Ci.height),Ci.width=r.width,Ci.height=r.height;for(let r=0;r<e+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l+r*n,i),a.lineTo(l+r*n,i+t*n),a.lineWidth=r%Wn==0?1.5:.5,a.stroke(),a.closePath();for(let r=0;r<t+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l,i+r*n),a.lineTo(l+e*n,i+r*n),a.lineWidth=(t-r)%Hn==0?1.5:.5,a.stroke(),a.closePath();const o=new Uint32Array(aL.memory.buffer,zB.cells(),zB.selected_l_salvage_weftgrid_length());if(a.beginPath(),o.forEach(e=>{a.fillRect(e%zB.cols()*n,parseInt(e/zB.cols())*n,n,n)}),a.closePath(),Mn){const e=Wi.createPattern(r,"repeat");Wi.rect(0,0,Ci.width,Ci.height),Wi.fillStyle=e,Wi.fill()}else Wi.drawImage(r,0,0);Ui()},Ui=()=>{if(Number(Oi.value)>0){const e=VB.cols(),t=VB.rows(),n=1*AB.width(),l=Number(parseFloat(1*AB.height()).toFixed(2)),i=On,r=Dn,a=document.createElement("canvas");a.width=Math.ceil(e*n),a.height=Math.ceil(t*l);const o=a.getContext("2d");o.clearRect(0,0,a.width,a.height),Hi.clearRect(0,0,Ni.width,Ni.height);for(let a=0;a<e+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.lineWidth=a%Wn==0?1.5:.5,o.stroke(),o.closePath();for(let a=0;a<t+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.lineWidth=(t-a)%Hn==0?1.5:.5,o.stroke(),o.closePath();const s=new Uint32Array(aL.memory.buffer,VB.cells(),VB.selected_l_salvage_maingrid_length());if(o.beginPath(),s.forEach(e=>{o.fillRect(e%VB.cols()*n,parseInt(e/VB.cols())*l,n,l)}),o.closePath(),Ri.style.width="auto",Mn){Ni.width=a.width,Ni.height=a.height*Un;const e=Hi.createPattern(a,"repeat");Hi.rect(0,0,Ni.width,Ni.height),Hi.fillStyle=e,Hi.fill()}else Ni.height=a.height,Ni.width=a.width,Hi.drawImage(a,0,0)}},Yi=()=>{const e=new Uint32Array(aL.memory.buffer,UB.click_cells(),UB.click_l_salvage_dentgrid_length()),t=UB.cols(),n=UB.rows(),l=UB.cell_size(),i=On,r=Dn,a=document.createElement("canvas");a.width=t*l,a.height=l;const o=a.getContext("2d");o.clearRect(0,0,a.width,a.height),Fi.clearRect(0,0,Ai.width,Ai.height),Ai.width=a.width,Ai.height=a.height;for(let e=0;e<t+1;e++)o.beginPath(),o.strokeStyle="white",o.moveTo(i+e*l,r),o.lineTo(i+e*l,r+n*l),o.stroke(),o.closePath();for(let e=0;e<n+1;e++)o.beginPath(),o.strokeStyle="white",o.moveTo(i,r+e*l),o.lineTo(i+t*l,r+e*l),o.stroke(),o.closePath();if(o.font="10px serif",e.forEach((t,n)=>{t>0&&o.fillText(e[n],(n+1)*l-4,8)}),Mn){const e=Fi.createPattern(a,"repeat");Fi.rect(0,0,Ai.width,Ai.height),Fi.fillStyle=e,Fi.fill()}else Fi.drawImage(a,0,0)},Ji=e=>{e.preventDefault();const t=Mi.getBoundingClientRect(),n=UB.cols(),l=(e.clientX-t.left)%(10*n),i=(e.clientY-t.top)%10,r=parseInt(i/10),a=parseInt(l/10)+r*UB.cols();0==e.button?UB.add_click_cell(a,!0):2==e.button&&UB.add_click_cell(a,!1),Yi()},Gi=e=>{(e=>{const t=Mi.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top,i=UB.cell_size(),r=parseInt(n/i)+parseInt(l/i)*UB.cols();UB.add_cell(r)})(e),(()=>{const e=UB.cols(),t=UB.rows(),n=UB.cell_size(),l=On,i=Dn,r=document.createElement("canvas");r.width=e*n,r.height=t*n;const a=r.getContext("2d");a.clearRect(0,0,r.width,r.height),Di.clearRect(0,0,Mi.width,Mi.height),Mi.width=r.width,Mi.height=r.height;for(let r=0;r<e+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l+r*n,i),a.lineTo(l+r*n,i+t*n),a.stroke(),a.closePath();for(let r=0;r<t+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l,i+r*n),a.lineTo(l+e*n,i+r*n),a.stroke(),a.closePath();const o=new Uint32Array(aL.memory.buffer,UB.cells(),UB.selected_l_salvage_dentgrid_length());if(a.beginPath(),o.forEach(t=>{a.fillRect(t%e*n,parseInt(t/e)*n,n,n)}),a.closePath(),Mn){const e=Di.createPattern(r,"repeat");Di.rect(0,0,Mi.width,Mi.height),Di.fillStyle=e,Di.fill()}else Di.drawImage(r,0,0);Yi()})()},Xi=document.getElementById("first-beam-canvas-container"),Ki=document.getElementById("first-beam-canvas"),Zi=Ki.getContext("2d"),Qi=()=>{rr()},er=()=>ZB.is_different_beam_used(),tr=e=>{const t=Ki.getBoundingClientRect(),n=ZB.cell_size(),l=ZB.cols(),i=ZB.rows(),r=(e.clientX-t.left)%(l*n),a=e.clientY-t.top,o=qn.startColumn+parseInt(r/n),s=i-parseInt(a/n)-1;ZB.click_on_cell_new(s,o%l,AB,DB),ar()},nr=e=>{Ml(!1)},lr=e=>{oI(ii),Ll&&tr(e)},ir=e=>{console.log("mouse down called"),Ml(!0),tr(e)},rr=()=>{const e=ZB.cols(),t=ZB.rows(),n=ZB.cell_size(),l=On,i=Dn,r=document.createElement("canvas");r.width=e*n,r.height=t*n;const a=r.getContext("2d");a.fillStyle="white",a.fillRect(0,0,r.width,r.height),a.fillStyle="black",Zi.clearRect(0,0,Ki.width,Ki.height),a.lineWidth=.5;for(let r=0;r<e+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l+r*n,i),a.lineTo(l+r*n,i+t*n),a.stroke(),a.closePath();for(let r=0;r<t+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l,i+r*n),a.lineTo(l+e*n,i+r*n),a.stroke(),a.closePath();const o=new Uint32Array(aL.memory.buffer,ZB.cells(),ZB.selected_beamgrid_length());if(a.beginPath(),o.forEach((e,l)=>{a.fillRect(l*n,(t-e)*n,n,n)}),a.closePath(),Mn){Ki.height=r.height,Ki.width=r.width*zn;const e=Zi.createPattern(r,"repeat");Zi.rect(0,0,Ki.width,Ki.height),Zi.fillStyle=e,Zi.fill()}else Ki.height=r.height,Ki.width=r.width,Zi.drawImage(r,0,0);Xi.style.height=Ki.height+1+"px"},ar=()=>{const e=ZB.cols(),t=qn.startColumn,n=qn.endColumn,l=Mn?n-t+1:Math.min(n-t+1,e),i=ZB.rows(),r=ZB.cell_size(),a=document.createElement("canvas");a.width=l*r,a.height=i*r;const o=a.getContext("2d");o.fillStyle="white",o.fillRect(0,0,a.width,a.height),o.fillStyle="black";const s=ZB.get_visible_cells(t,Mn?n:Math.min(n,e-1),Mn),d=bb(s)?JSON.parse(s):[];for(let e=0;e<l+1;e++)o.beginPath(),o.strokeStyle="grey",o.moveTo(e*r,0),o.lineTo(e*r,i*r),o.lineWidth=(e+t)%Wn==0?1.5:.5,o.stroke(),o.closePath();for(let e=0;e<i+1;e++)o.beginPath(),o.strokeStyle="grey",o.moveTo(0,e*r),o.lineTo(l*r,e*r),o.stroke(),o.closePath();d.forEach((e,t)=>{o.fillRect(t*r,(i-e)*r,r,r)}),Xi.style.height=a.height+1+"px",Ki.height=a.height,Ki.width=a.width,Zi.drawImage(a,0,0)},or=document.getElementById("main-content"),sr=document.getElementById("draft-in-part-model"),dr=document.getElementById("draft-in-part-trigger");let cr,ur=0,mr=-1,hr=[];const pr=()=>{nv(),Ol("draft-in-part-model"),gr(),sr.style.display="block",sr.style.animation="slide-down 0.3s ease"},gr=()=>{ur=0,hr.length>0&&hr.forEach(e=>{vr(e)})},fr=()=>{Ol(""),sr.style.display="none"},yr=e=>{if(e.target.checked){let t=e.target.id;mr=parseInt(t.split("-").at(-1)),console.log("currentSelectedPart ",mr)}},vr=e=>{console.log("add part called");let t=`\n    <div class="draft-part-container-row draft-part-heading-row">\n      <div></div>\n      <div>Part Name</div>\n      <div>Draft Plan</div>\n      <div>Warp Seq</div>\n     \n    </div>\n  \n    <div class="draft-part-container-row">\n    <input type="radio" class="draft-in-part-radio" id="draft-in-part-radio-${ur+1}" name="selected-part">\n      <div>\n        <div><textarea rows="5" class="part-name">${e?e.partName:""}</textarea></div>\n        \n      </div>\n      <div>\n        <div><textarea rows="5" class="part-numeric">${e?e.partDraftPlan:""}</textarea></div>\n      <div class="draft-in-part-totalendsperdent-value draft-part-container-second-row">${e?`${e.partEnds}/${e.partDents}`:""}</div>\n      </div>\n      <div class="warp-seq-container" style="display:flex;flex-direction:row">\n        ${e&&Array.isArray(e.partWarpSeq)?e.partWarpSeq.map((t,n)=>`<div>\n          <div> <textarea rows="5" class="part-seq">${t}</textarea></div>\n          <div><div class="draft-in-part-totalwarpseq-value draft-part-container-second-row">${0==n?"Warp Sequence = "+e.partEnds:""}</div></div>\n          </div>`).join(""):'<div>\n        <div> <textarea rows="5" class="part-seq"></textarea></div>\n        <div><div class="draft-in-part-totalwarpseq-value draft-part-container-second-row"></div></div>\n        </div>'}\n\n       \n      </div>\n      <div class="add-warp-seq">+<div>\n    </div>`,n=document.createElement("div");n.id="draft-in-part-"+(ur+1),n.className="draft-part-container",n.innerHTML=t,cr.appendChild(n),Ir(),ur++},br=e=>{let t=e.target.closest(".draft-part-container");mr=parseInt(t.id.split("-").at(-1)),document.getElementById("draft-in-part-radio-"+mr).checked=!0},wr=e=>{console.log("text area chagne",e);let t=e.target.closest(".draft-part-container"),n=e.target.classList.value;if("part-name"==n);else if("part-numeric"==n)((e,t)=>{console.log("calulateEndsPerDent called",e,t);let n=mb(e);const l=Pv(String(n).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e))),i=String(n).split("\n").filter(e=>e.length>0).length;console.log("ends per demnt elent",t.querySelector(".draft-in-part-totalendsperdent-value")),t.querySelector(".draft-in-part-totalendsperdent-value").innerText=`Total Ends/Dent -: ${l}/${i}`})(e.target.value,t);else if(n="part-seq"){let n=((e,t)=>{let n=t.querySelectorAll(".part-seq"),l=[];for(let e=0;e<n.length;e++){let t=n.item(e);t&&t.value&&l.push(t.value)}console.log("split string are",l);let i=[];for(let e=0;e<l.length;e++){let t=l[e].trim(),n=Dv(t);if(-1==i.findIndex(e=>e==n)&&0!=i.length)return!1;i.push(n)}return console.log("warpTotalArray is",i),i.length>0&&(t.querySelector(".draft-in-part-totalwarpseq-value").innerText="Warp Sequence = "+i[0]),!0})(e.target.value,t);e.target.style.border=n?"1px solid black":"1px solid red"}},Er=e=>{let t=e.target.closest(".draft-part-container"),n=parseInt(t.id.split("-").at(-1));Sr(n),Ir()},Ir=()=>{document.querySelectorAll(".draft-in-part-radio").forEach(e=>{e.removeEventListener("change",yr),e.addEventListener("change",yr)});let e=sr.getElementsByTagName("textarea");for(let t=0;t<e.length;t++)e.item(t).removeEventListener("focus",br),e.item(t).addEventListener("focus",br),e.item(t).removeEventListener("change",wr),e.item(t).addEventListener("change",wr);let t=sr.getElementsByClassName("add-warp-seq");for(let e=0;e<t.length;e++)t.item(e).removeEventListener("click",Er),t.item(e).addEventListener("click",Er)},Sr=(e,t)=>{const n=`\n  <div> <textarea rows="5" class="part-seq" value=${t?t.partWarpSeq:""}></textarea></div>\n  <div><div class="draft-in-part-totalwarpseq-value draft-part-container-second-row">${t?t.partWarpSeq:""}</div></div>\n  `,l=document.createElement("div");l.innerHTML=n,l.style.marginLeft="5px";const i=document.getElementById("draft-in-part-"+e),r=i.querySelector(".warp-seq-container");i.querySelector(".draft-part-heading-row").appendChild(document.createElement("div")),r.appendChild(l)},kr=()=>{let e=document.getElementById("draft-in-part-"+mr);e&&(e.parentNode.removeChild(e),Ir(),ur--)},xr=e=>{let t=e.querySelector(".part-name").value,n=e.querySelector(".part-numeric").value,l=e.querySelector(".part-seq").value,i=e.querySelectorAll(".part-seq"),r=mb(n),a=[];for(let e=0;e<i.length;e++){let t=i.item(e);t.value&&a.push(t.value)}const o=Pv(String(r).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e))),s=String(r).split("\n").filter(e=>e.length>0).length,d=Dv(String(l).split("/")[0].trim());return console.log("warpTasda",d,"totalEnd",o),Number(o)==Number(d)?(e.querySelector(".part-numeric").style.border="1px solid black",hr.push({partName:t,partDraftPlan:n,partWarpSeq:a,partEnds:o,partDents:s}),!0):(e.querySelector(".part-numeric").style.border="1px solid red",!1)},Tr=()=>{let e=cr.querySelectorAll(".draft-part-container");hr=[];for(let t=0;t<e.length;t++){let n=e.item(t);if(!xr(n))return hr=[],!1}return console.log("draft part data is",hr),!0},_r=()=>{Tr()&&fr()};let Br="A",Lr={},Pr={};const Cr=document.getElementById("warp-color-container"),Nr=document.getElementById("warp-color-canvas"),Rr=Nr.getContext("2d"),Ar=document.getElementById("warpcolor-context-menu"),Fr=document.getElementById("warp-creaming-canvas"),Mr=Fr.getContext("2d"),Or=document.getElementById("warp-creaming-container"),Dr=()=>{const e=JB.size,t=qn.startColumn,n=qn.endColumn,l=Mn?n-t+1:Math.min(qn.endColumn-t+1,e),i=Rl,r=Rl,a=document.createElement("canvas");a.width=l*r,a.height=1*i;const o=a.getContext("2d");if(o.fillStyle="white",o.fillRect(0,0,a.width,a.height),o.fillStyle="black",Mr.clearRect(0,0,Fr.width,Fr.height),JB.getVisibleCells(t,Mn?n:Math.min(qn.endColumn,e-1),Mn).forEach(e=>{o.fillStyle="red",o.fillRect((e.index-t)*r,0,r,i)}),Bl==sl){for(let e=0;e<l+1;e++)o.beginPath(),o.strokeStyle="grey",o.moveTo(e*r,0),o.lineTo(e*r,1*i),o.lineWidth=(e+t)%Wn==0?1.5:.5,o.stroke(),o.closePath();for(let e=0;e<2;e++)o.beginPath(),o.strokeStyle="grey",o.moveTo(0,e*i),o.lineTo(l*r,e*i),o.lineWidth=.5,o.stroke(),o.closePath()}else if(Bl==dl){o.lineWidth=.5;for(let e=0;e<l+1;e++)o.beginPath(),o.strokeStyle="grey",o.moveTo(e*r,0),o.lineTo(e*r,1*i),o.stroke(),o.closePath();for(let e=0;e<2;e++)o.beginPath(),o.strokeStyle="grey",o.moveTo(0,e*i),o.lineTo(l*r,e*i),o.stroke(),o.closePath()}else if(Bl==cl){o.lineWidth=1.5;for(let e=0;e<l+1;e++)(e+t)%Wn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(e*r,0),o.lineTo(e*r,1*i),o.stroke(),o.closePath());for(let e=0;e<2;e++)(1-e)%Hn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(0,e*i),o.lineTo(l*r,e*i),o.stroke(),o.closePath())}else{o.lineWidth=1.5;for(let e=0;e<l+1;e+=l)o.beginPath(),o.strokeStyle="grey",o.moveTo(e*r,0),o.lineTo(e*r,1*i),o.stroke(),o.closePath();for(let e=0;e<2;e+=1)(1-e)%Hn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(0,e*i),o.lineTo(l*r,e*i),o.stroke(),o.closePath())}Fr.width=a.width,Fr.height=a.height,Mr.drawImage(a,0,0)},Wr=()=>{const e=JB.size,t=qn.startColumn,n=qn.endColumn,l=Mn?n-t+1:Math.min(qn.endColumn-t+1,e),i=Rl,r=document.createElement("canvas");r.width=l*i,r.height=30;const a=r.getContext("2d");if(a.fillStyle="white",a.fillRect(0,0,r.width,r.height),a.fillStyle="black",a.beginPath(),KB.getVisibleCells(t,Mn?n:Math.min(qn.endColumn,e-1),Mn).forEach((e,t)=>{a.fillStyle=Lr[e],a.fillRect(t*i,0,i,30)}),a.closePath(),Bl==sl){for(let e=0;e<l+1;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(e*i,0),a.lineTo(e*i,30),a.lineWidth=(e+t)%Wn==0?1.5:.5,a.stroke(),a.closePath();for(let e=0;e<2;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(0,30*e),a.lineTo(l*i,30*e),a.lineWidth=.5,a.stroke(),a.closePath()}else if(Bl==dl){a.lineWidth=.5;for(let e=0;e<l+1;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(e*i,0),a.lineTo(e*i,30),a.stroke(),a.closePath();for(let e=0;e<2;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(0,30*e),a.lineTo(0+l*i,30*e),a.stroke(),a.closePath()}else if(Bl==cl){a.lineWidth=1.5;for(let e=0;e<l+1;e++)(e+t)%Wn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(e*i,0),a.lineTo(e*i,30),a.stroke(),a.closePath());for(let e=0;e<2;e++)e%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(0,30*e),a.lineTo(l*i,30*e),a.stroke(),a.closePath())}else{a.lineWidth=1.5;for(let e=0;e<l+1;e+=l)e%Wn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(e*i,0),a.lineTo(e*i,30),a.stroke(),a.closePath());for(let e=0;e<2;e+=1)e%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(0,30*e),a.lineTo(l*i,30*e),a.stroke(),a.closePath())}Cr.style.height=r.height+"px",Nr.width=r.width,Nr.height=r.height,Rr.clearRect(0,0,Nr.width,Nr.height),Rr.drawImage(r,0,0)},Hr=()=>{Wr()},$r=e=>{const t=Nr.getBoundingClientRect(),n=Rl,l=(qn.startColumn+parseInt((e.clientX-t.left)%(KB.size*n)/n))%KB.size;console.log("index is",l),KB.update_cell(l,Br),Wr(),"radio-weave"!=Yn&&dI()},qr=e=>{um!=El&&(Gb(Ub.WARP),0==e.button&&jn==$n&&(Ml(!0),$r(e)))},jr=e=>{(e=>{const t=Fr.getBoundingClientRect(),n=Rl,l=(parseInt((e.clientX-t.left)%(JB.size*n)/n)+qn.startColumn)%KB.size;JB.update_function_cell(l,Km),Dr()})(e),Ml(!0)},Vr=e=>{um!=El&&(Ll&&jn==$n&&($r(e),"radio-color"==Yn?wI():"radio-interlacement"==Yn&&EI()),oI(Ql,e))},zr=()=>{oI(ri)};let Ur="weft",Yr=document.getElementById("warpWeftEditnumber"),Jr=document.getElementById("totalWarpWeft"),Gr=document.getElementById("totalWarpWeftLabel"),Xr=document.getElementById("warpweft-modal-title");const Kr=document.getElementById("edit-sequence-error-message"),Zr=e=>{Ur=e},Qr=(e,t)=>{console.log("input object is",e);let n="",l={},i=0;for(let e=0;e<=KB.getMaximumIndex();e++){let t=KB.findElementFromIndex(e);t?(i>0&&(n+=i.toString()+"\n"),n+=t.color_code+"\n",i=0):i++}e.rightsalvage&&(Gp.isSalvageVisible||t)&&(l[cb(e.rightsalvage.draft.pattern)]=isNaN(parseInt(e.rightsalvage.draft.pattern))?0:parseInt(e.rightsalvage.draft.pattern)),e.leftsalvage&&(Gp.isSalvageVisible||t)&&(l[cb(e.leftsalvage.draft.pattern)]+=isNaN(parseInt(e.leftsalvage.draft.pattern))?0:parseInt(e.leftsalvage.draft.pattern));let r={};for(let e=0;e<n.length;e++)Rv(n[e])&&(r[n[e]]?r[n[e]]=r[n[e]]+1:r[n[e]]=1);if(Object.keys(r).forEach(n=>{l[n]?l[n]=l[n]+r[n]*(Gp.isFullReedSpaceVisible||t?e.bodyRepeat:1):l[n]=r[n]*(Gp.isFullReedSpaceVisible||t?e.bodyRepeat:1)}),e.extrapart&&(Gp.isFullReedSpaceVisible||t)){let t=e.extrapart.tar,i=n.replaceAll("\n","").replaceAll(" ","");for(let e=0;e<t;e++){let t=i[e%i.length];l[t]+=1}}let a=Object.keys(l).sort(),o={};a.forEach(e=>{e&&(o[e]=l[e])}),l=o;let s="";return Object.keys(l).forEach(e=>{s+=`${l[e]}${e}\n`}),s=s.trim(),s},ea=()=>{let e="";if("weft"==Ur){Gb(Ub.WEFT),Gr.innerText="Total Weft",Xr.innerHTML="Edit Weft";let t=0;if(um==Il){for(let n=XB.size-1;n>=XB.getMinimumIndex();n--){let l=XB.findElementFromIndex(n);l?(t>0&&(e+=t.toString()+"\n"),e+=l.color_code+"\n",t=0):t++}let n=nL(e.toUpperCase());Av(n,"["),Yr.value=zv(nL(n),!1).replace(/[\s]+/g,"\n"),ta(Yr.value)}else Yr.value=XB.fixNumericText,ta(Yr.value)}else{Gb(Ub.WARP),Gr.innerText="Total Warp",Xr.innerHTML="Edit Warp";let t=0;if(um==Il){for(let n=0;n<=KB.getMaximumIndex();n++){let l=KB.findElementFromIndex(n);l?(t>0&&(e+=t.toString()+"\n"),e+=l.color_code+"\n",t=0):t++}let n=nL(e.toUpperCase());Av(n,"["),Yr.value=zv(nL(n),!1).replace(/[\s]+/g,"\n"),ta(Yr.value)}else Yr.value=KB.fixNumericText,ta(Yr.value)}},ta=e=>{Jr.value=Dv(e)},na=e=>{let t=String(e.target.value),n={".":" ","{":"[","}":"]","(":"[",")":"]"},l=Yr.selectionStart;t=t.split("").map(e=>n[e]||e).join(""),Yr.value=t,Yr.setSelectionRange(l,l),Yr.focus(),ta(t)},la=()=>{if(Av(Yr.value,"[")!=Av(Yr.value,"]"))return Kr.style.display="block",Kr.innerText="Check Brackets Properly",setTimeout(()=>{Kr.style.display="none"},6e3),!1;Kr.style.display="none";let e=1,t=mb(String(Yr.value).toUpperCase());return"weft"==Ur&&(XB.cells=[],String(t).split("\n").filter(e=>e.length>0).forEach(t=>{t.split(" ").forEach(t=>{let n=isNaN(parseInt(t))?1:parseInt(t);for(let t=0;t<n;t++)e++})}),XB.size<e-1&&(XB.size=e-1,YB.update_size(XB.size),GB.update_size(XB.size)),e=1,String(t).split("\n").filter(e=>e.length>0).forEach(t=>{t.split(" ").forEach(t=>{let n=isNaN(parseInt(t))?1:parseInt(t);for(let l=0;l<n;l++)XB.update_cell(XB.size-e,cb(t)),e++})}),XB.setFixNumericText(Yr.value),gE()),"warp"==Ur&&(KB.cells=[],e=0,String(t).split("\n").filter(e=>e.length>0).forEach(t=>{t.split(" ").forEach(t=>{let n=isNaN(parseInt(t))?1:parseInt(t);for(let t=0;t<n;t++)e++})}),console.log("Reach index is",e),KB.size<e&&(KB.size=e),e=0,String(t).split("\n").filter(e=>e.length>0).forEach(t=>{t.split(" ").forEach(t=>{let n=isNaN(parseInt(t))?1:parseInt(t);for(let l=0;l<n;l++)KB.update_cell(e,t.slice(-1)),e++})}),console.log("warpcolor grid index is",KB),KB.setFixNumericText(Yr.value),Cm()),console.log("warp color seq is",KB),"radio-color"==Yn&&wI(),"radio-interlacement"==Yn&&EI(),!0},ia=()=>{la()&&(document.getElementById("edit-sequance-modal").style.display="none")},ra=document.getElementById("pegplan-edit-num"),aa=document.getElementById("total-picks"),oa=document.getElementById("edit-pegplan-error-message"),sa=e=>{let t=String(e.target.value),n={".":" ","{":"[","}":"]","(":"[",")":"]"},l=ra.selectionStart;t=t.split("").map(e=>n[e]||e).join(""),ra.value=t,ra.setSelectionRange(l,l),ra.focus();let i=mb(t,!0);const r=String(i).split("\n").filter(e=>e.length>0).length;aa.value=r;let a=DB.cols();String(i).split("\n").forEach(e=>{Math.max(...e.split(" "))>a&&(a=Math.max(...e.split(" ")))}),da(a)},da=e=>{let t=0;for(let n=0;n<e;n++)t+=String(n).length+1;t-=10,t=Math.max(25,t),ra.cols=t},ca=(e=!1)=>{if(Av(ra.value,"[")!=Av(ra.value,"]"))return oa.style.display="block",oa.innerText="Check Brackets Properly",setTimeout(()=>{oa.style.display="none"},6e3),!1;oa.style.display="none";let t=mb(ra.value.trimEnd()).trimEnd();t=0==t.length?ra.value:t;let n=0,l=DB.cols();return String(t).split("\n").forEach(e=>{n++,Math.max(...e.split(" "))>l&&(l=Math.max(...e.split(" ")))}),l>40?(oa.style.display="block",oa.innerText="Shaft must be lesser than 40",setTimeout(()=>{oa.style.display="none"},6e3),!1):(oa.style.display="none",!(e&&l>24&&!confirm(`You are input ${l} Shaft, Are you Sure to use More then 24 Shaft?`))&&(DB.new_edit_pegplan_numeric(FB,AB,HB,t.trim(),l,n,ra.value),XB.update_size(n),YB.update_size(n),GB.update_size(n),console.log("dencity grid instance",GB),Hf.value=n,Ol(""),hE({target:{scrollTop:0}}),FB.change_draft_dimension(AB,DB,WB,ZB,HB,l,df,n),ry(!0),Cm(),gE(),Dm(),rI(),!0))},ua=()=>{ca(!0)&&(ho.style.display="none")},ma=document.getElementById("machine-file-pick"),ha=document.getElementById("machine-file-repeat"),pa=document.getElementById("machine-file-total-pick"),ga=document.getElementById("machine-file-shaft"),fa=document.getElementById("machine-file-fidder"),ya=document.getElementById("machine-file-cramming"),va=new Image,ba=()=>{va.src="assets/machine-file-filled.png";let e=(()=>{let e=[];ib();let t=rb(),n=String(t).split("\n").filter(e=>e);console.log("newLineSplitPegplanNumeric",n);let l=0,i=0,r="";for(let t=0;t<n.length;t++)if(0==l)if(n[t].includes("[")){r.length>0&&(e.push({pegplanContent:r,repeat:1}),r="",i=0);let a=0,o=t+1,s=0;for(l=1;!n[o].includes("]");)a+=1,o+=1,l+=1;i=o-t+1,s=n.slice(t,o+1).join("\n").split("X")[1];let d=n.slice(t,o+1).join("\n").split("X")[0].replace("[","").replace("]","");if(i*s>40){let t=0,n=Math.floor(i*s/40);for(let l=0;l<n;l++)e.push({pegplanContent:d,repeat:parseInt(s)}),t+=i;if(t!=i*s){let t=i*s%40;e.push({pegplanContent:d.split("\n").slice(0,t).join("\n"),repeat:1})}i=0,r=""}else e.push({pegplanContent:d,repeat:parseInt(s)}),i=0,r=""}else 40==i&&(e.push({pegplanContent:r,repeat:1}),r="",i=0),r+=n[t]+"\n",i+=1,t+1==n.length&&(e.push({pegplanContent:r,repeat:1}),r="",i=0);else l-=1;return e})();if(console.log("new tabContentArray is",e),pl.start&&pl.end&&(ga.value=`${pl.start} to ${pl.end}`),ml.start&&ml.end&&(fa.value=`${ml.start} to ${ml.end}`),hl.start&&hl.end&&(ya.value=""+hl.end),e.length>0){let t=document.querySelector(".file-generator-tabs");document.querySelector(".file-generator-contents").innerHTML='<canvas id="loop-canvas"></canvas>',t.innerHTML="",e.forEach((e,n)=>{t.innerHTML+=`<span><img src="assets/refresh_sign.png" height="16" width="16" />&nbsp;&nbsp;Loop${n+1}</span>`});let n=document.querySelectorAll(".file-generator-tabs span");n.forEach((t,l)=>{t.addEventListener("click",()=>{n.forEach(e=>{e.classList.remove("active")}),(e=>{console.log("currentTableConent is",e);let t=e.pegplanContent,n=String(t).split("\n").filter(e=>e);console.log("pegplanStringArray",n);const l=document.getElementById("loop-canvas"),i=l.getContext("2d");i.clearRect(0,0,l.width,l.height);console.log("value of col is",40);const r=n.length;ma.value=r,ha.value=e.repeat,pa.value=aa.value;const a=30,o=30;l.width=Math.ceil(800)+30,l.height=Math.ceil(20*r)+30;for(let e=0;e<41;e++)e>0&&(i.textAlign="center",i.fillStyle="black",i.font="14px Rubik",i.fillText(e,20+20*e,20)),i.beginPath(),i.strokeStyle="black",i.moveTo(a+20*e,o),i.lineTo(a+20*e,o+20*r),i.stroke(),i.closePath();for(let e=0;e<r+1;e++)e>0&&(i.textAlign="center",i.fillStyle="black",i.font="14px Rubik",i.fillText(e,10,25+20*e)),i.beginPath(),i.strokeStyle="black",i.moveTo(a,o+20*e),i.lineTo(830,o+20*e),i.stroke(),i.closePath();n.forEach((e,t)=>{let n=t;e.split(" ").filter(e=>e).forEach(e=>{let t=20*(e-1)+a,l=20*n+o;i.drawImage(va,t+3,l+2)})})})(e[l]),n[l].classList.add("active")})})}},wa=document.getElementById("dropdown-item-print"),Ea=document.getElementById("graphical-pegplan-modal"),Ia=document.getElementById("graphical-pegplan-model-yes"),Sa=document.getElementById("graphical-pegplan-model-no"),ka="default",xa="yes",Ta="no";let _a=ka;const Ba=Ea.querySelector(".modal-desc"),La=()=>{if(_a==ka)Ba.innerHTML="Do You Want Graphical With Numeric Pegplan ?",_a=xa;else{let e=_a==xa?fl.GRAPHICALYESWITHNUMERICYES:fl.GRAPHICALNOWITHNUMERICYES;Kg(e),Pa()}},Pa=()=>{Ea.style.display="none"},Ca=()=>{if(_a==ka)Ba.innerHTML="Do You Want Numeric With Graphical Pegplan ?",_a=Ta;else{let e=_a==xa?fl.GRAPHICALYESWITHNUMERICNO:fl.GRAPHICALNOWITHNUMERICNO;Kg(e),Pa()}},Na=()=>{Kg(fl.GRAPHICALYESWITHNUMERICYES,!0)},Ra=(e,t)=>"warp"==t?Pr[e]&&Pr[e].yarnName?Pr[e].yarnName:e:"weft"==t?th[e]&&th[e].yarnName?th[e].yarnName:e:void 0,Aa=e=>{const t=String(e).split("\n").filter(e=>e);let n=[];return t.forEach(e=>{const t=String(e).match(/^\d+/)[0],l=String(e).substr(t.length);let i=t.padStart(4," ")+" - "+l;n.push(i)}),n.join("\n")},Fa=e=>{let t=mb(e).split(/[\s\n]+/),n={};for(let e=0;e<t.length;e++){let l=cb(t[e]),i=parseInt(t[e]);i=isNaN(i)?0:i,n[l]?n[l]+=i:n[l]=i}return n},Ma=document.getElementById("pattern-editor-trigger"),Oa=document.getElementById("pattern-editor-model"),Da=document.querySelector("#pattern-editor-model #modal-desc");let Wa=100,Ha=!1;const $a=(e,t,n)=>{let l={};for(let t=65;t<=90;t++){let n=t<=91,i=String.fromCharCode(t);n&&(e[i]?l[i]=e[i]:l[i]=0)}console.log("totalYarnWiseCount is",l);let i="";return Object.keys(l).forEach((e,r)=>{let a="",o="warp"==t?Lr[e]:Qm[e],s=18;if(n.forEach(t=>{let n=t.seq.split(" ");1==n.length?(n[0].includes(e)?isNaN(parseInt(n[0]))?a+='<td class="postfixHeader">1</td>':a+=`<td class="postfixHeader">${parseInt(n[0])}</td>`:a+='<td class="postfixHeader"></td>',s--):n.forEach((t,n)=>{t.includes(e)?isNaN(parseInt(t))?a+='<td class="postfixHeader">1</td>':a+=`<td class="postfixHeader">${parseInt(t)}</td>`:a+='<td class="postfixHeader"></td>',s--})}),s>0)for(let e=0;e<s;e++)a+='<td class="postfixHeader"></td>';i+=`<tr><td class="warpWeftColumn">${e}</td>${Ha?`<td class="yarnName" style="width:${Wa}px">${Ra(e,t)}</td>`:""}<td class="colorColumn" style="background-color:${o};"></td><td class="totalColumn">${l[e]}</td><td class="percentageColumn">${((e,t)=>parseFloat(e[t]/(e=>{let t=0;for(let n in e)e.hasOwnProperty(n)&&"number"==typeof e[n]&&(t+=e[n]);return t})(e)*100).toFixed(2)+"%")(l,e)}</td>${a}</tr>`}),i},qa=e=>{const t=document.getElementById(`pattern-editor-${e}-canvas`),n=document.getElementById(`pattern-editor-small-${e}-canvas`),l=t.getContext("2d"),i=n.getContext("2d"),r="warp"==e?KB.size:XB.size,a="warp"==e?KB.cells:XB.cells;let o="warp"==e?Lr:Qm;const s=Rl,d=On,c=Dn;t.width=r*Rl,t.height=30,l.fillStyle="white",l.fillRect(0,0,t.width,t.height),l.fillStyle="black",l.clearRect(0,0,t.width,t.height),l.beginPath(),a.forEach(t=>{let n="warp"==e?t.index:r-t.index-1;l.fillStyle=o[t.color_code],l.fillRect(n*s,0,s,30)}),l.closePath();for(let e=0;e<r+1;e++)l.beginPath(),l.strokeStyle="grey",l.moveTo(d+e*s,c),l.lineTo(d+e*s,c+30),l.lineWidth=.5,l.stroke(),l.closePath();for(let e=0;e<2;e++)l.beginPath(),l.strokeStyle="grey",l.moveTo(d,c+30*e),l.lineTo(d+r*s,c+30*e),l.lineWidth=.5,l.stroke(),l.closePath();const u=Math.floor(63.6*window.innerWidth/100),m=0==Math.floor(u/(3*r))?1:Math.floor(u/(3*r)),h=document.createElement("canvas"),p=h.getContext("2d");h.width=m*r,h.height=30,n.width=u,n.height=30,p.beginPath(),a.forEach(t=>{let n="warp"==e?t.index:r-t.index-1;p.fillStyle=o[t.color_code],p.fillRect(n*m,0,m,30)}),p.closePath(),i.clearRect(0,0,n.width,n.height);const g=i.createPattern(h,"repeat");i.rect(0,0,n.width,n.height),i.fillStyle=g,i.fill()},ja=(e,t,n)=>((e,t,n)=>{let l="";console.log("seq array is",n);let i=18;if(n.forEach(e=>{let t=e.seq.split(" ");1==t.length?(l+='<td class="postfixHeader">1</td>',i--):t.forEach((n,r)=>{r+1==t.length?l+=`<td class="postfixHeader">${e.repeat}</td>`:l+='<td class="postfixHeader"></td>',i--})}),i>0)for(let e=0;e<i;e++)l+='<td class="postfixHeader"></td>';return`<tr><td class="warpWeftColumn">${"warp"==t?"Warp":"Weft"}</td>${Ha?`<td class="yarnName" style="width:${Wa}px">\n        Yarn Name\n      </td>`:""}<td class="colorColumn">Color</td><td class="totalColumn">Total</td><td class="percentageColumn">%</td>${l}</tr>`})(0,t,n)+$a(e,t,n),Va=()=>{let e=Fv(),t=Qv(),n=ab().split(/\s+/g),l=ob().split(/\s+/g);console.log("warpSeqString is ",n),console.log("weftSeqString is ",l);let i=[],r=[];if(Array.isArray(n)){let e=0;n.forEach((t,l)=>{if(0==e)if(t.includes("[")){let t=l;for(;!n[t].includes("]");)t++;e=t-l;let r=n.slice(l,t+1).join(" ").split("X");if(2==r.length){let e=r[0].replace("[","").replace("]",""),t=Number(r[1]);i.push({seq:e,repeat:t})}}else i.push({seq:t,repeat:1});else e-=1}),-1==i.findIndex(e=>1!=e.repeat)&&(i=[{seq:i.map(e=>e.seq).join(" "),repeat:1}])}if(Array.isArray(l)){let e=0;l.forEach((t,n)=>{if(0==e)if(t.includes("[")){let t=n;for(;!l[t].includes("]");)t++;e=t-n;let i=l.slice(n,t+1).join(" ").split("X");if(2==i.length){let e=i[0].replace("[","").replace("]",""),t=Number(i[1]);r.push({seq:e,repeat:t})}}else r.push({seq:t,repeat:1});else e-=1}),-1==r.findIndex(e=>1!=e.repeat)&&(r=[{seq:r.map(e=>e.seq).join(" "),repeat:1}])}Object.keys(Pr).forEach(e=>{let t=Ra(e,"warp");t.length>1&&(14*t.length>Wa&&(Wa=14*t.length),Ha=!0)}),Object.keys(th).forEach(e=>{let t=Ra(e,"weft");t.length>1&&(4*t.length>Wa&&(Wa=4*t.length),Ha=!0)}),console.log("yarnNam ecelsas",Wa);let a=`<div>\n  <div class="pattern-editor-table-container">\n  <table class="pattern-editor-table">${ja(e,"warp",i)}</table></div><div class="pattern-editor-canvas-container"><canvas id="pattern-editor-warp-canvas"></canvas></div><div><canvas id="pattern-editor-small-warp-canvas"></canvas></div></div><div><div class="pattern-editor-table-container"><table class="pattern-editor-table">${ja(t,"weft",r)}</table></div><div class="pattern-editor-canvas-container"><canvas id="pattern-editor-weft-canvas"></canvas></div><div><canvas id="pattern-editor-small-weft-canvas"></canvas></div></div>`;Da.innerHTML="",Da.innerHTML=a,qa("warp"),qa("weft")},za=document.getElementById("header-warp-editor-trigger"),Ua=document.getElementById("header-weft-editor-trigger"),Ya=document.getElementById("header-edit-dent-trigger"),Ja=document.getElementById("header-draft-editor-trigger"),Ga=document.getElementById("header-pegplan-editor-trigger"),Xa=(document.getElementById("header-design-notes-trigger"),document.getElementById("header-edit-design-trigger"),document.getElementById("new-file")),Ka=document.getElementById("new-file-modal"),Za=document.getElementById("edit-salvage-trigger"),Qa=document.getElementById("draft-warp-seq"),eo=document.getElementById("weave-generator-trigger"),to=document.getElementById("weave-generator-modal"),no=(document.querySelectorAll(".close-button"),document.querySelectorAll(".btn-cancel")),lo=document.getElementById("warpcolor-sequence-trigger"),io=document.getElementById("weftcolor-sequence-trigger"),ro=document.getElementById("edit-sequance-modal"),ao=document.getElementById("edit-dent-modal"),oo=document.getElementById("wsEditDraft-trigger"),so=(document.getElementById("setting-details-trigger"),document.getElementById("setting-details-modal"),document.getElementById("account-modal-trigger"),document.getElementById("avatar-account-modal"),document.getElementById("setting-modal-trigger")),co=document.getElementById("avatar-setting-modal"),uo=(document.getElementById("create-new-ticket-trigger"),document.getElementById("create-ticket-modal"),document.getElementById("edit-draft-num-modal")),mo=document.getElementById("wcEditPegplan-trigger"),ho=document.getElementById("pegplan-modal"),po=(document.getElementById("loom-profile-model"),document.getElementById("generate-machine-file")),go=document.getElementById("generate-machine-file-model");function fo(e,t,n,l,i){const r=t.querySelector(".close"),a=t.querySelector(".modal-title");a&&(a.innerText=i);const o=()=>{Ol(""),t.style.display="none"};document.addEventListener("keydown",e=>{"Escape"==e.key&&o()}),e.addEventListener("click",()=>{Vn!=t.id&&(nv(),["wsEditDraft-trigger","header-draft-editor-trigger"].includes(e.id)&&Rh(),"new-file"==e.id&&sy(),["wcEditPegplan-trigger","header-pegplan-editor-trigger"].includes(e.id)&&((()=>{let e=uE==kl?DB.convert_new_index_to_numeric():DB.get_fix_numeric_text();ra.value=e,da(DB.cols()),oI(Gl),Gb(Ub.NONE),sa({target:{value:e}})})(),document.getElementById("warpCanvasMenu").style.display="none"),"weave-generator-trigger"==e.id&&(()=>{let e=document.querySelectorAll(".tabs h3"),t=document.querySelectorAll(".tab-content div");e.forEach((n,l)=>{n.addEventListener("click",()=>{t.forEach(e=>{e.classList.remove("active")}),e.forEach(e=>{e.classList.remove("active")}),t[l].classList.add("active"),e[l].classList.add("active")})})})(),"generate-machine-file"==e.id&&ba(),"dropdown-item-print"==e.id&&(Ba.innerHTML="Do You Want Graphical Pegplan?",_a=ka),["weftcolor-sequence-trigger","header-weft-editor-trigger"].includes(e.id)&&(Zr("weft"),ea()),["warpcolor-sequence-trigger","header-warp-editor-trigger"].includes(e.id)&&(Zr("warp"),ea()),"pattern-editor-trigger"==e.id&&Va(),document.getElementById("weftSubContext")&&(document.getElementById("weftSubContext").style.display="none"),document.getElementById("weftcolor-context-menu")&&(document.getElementById("weftcolor-context-menu").style.display="none"),document.getElementById("warpcolor-context-menu")&&(document.getElementById("warpcolor-context-menu").style.display="none"),document.getElementById("mainContextMenu")&&(document.getElementById("mainContextMenu").style.display="none"),document.getElementById("warpCanvasMenu")&&(document.getElementById("warpCanvasMenu").style.display="none"),(e=>{let t=document.querySelectorAll(".modal");(e=>{e.forEach(e=>{e.style.width="100%",e.style.height="100%",e.style.left=0})})(t);for(let n=0;n<t.length;n++){let l=document.getElementById(Vn),i=document.getElementById(e.id);"edit-sequance-modal"!=Vn||"edit-draft-num-modal"!=e.id||"edit-sequance-modal"!=t[n].id||"warp"!=Ur?("edit-sequance-modal"!=Vn||"pegplan-modal"!=e.id||"edit-sequance-modal"!=t[n].id||"weft"!=Ur)&&!("edit-draft-num-modal"==Vn&&"edit-sequance-modal"==e.id&&"edit-draft-num-modal"==t[n].id&&"warp"==Ur||"pegplan-modal"==Vn&&"edit-sequance-modal"==e.id&&"pegplan-modal"==t[n].id&&"weft"==Ur)?t[n].style.display="none":(l.style.left=0,l.style.width="50%",i.style.left="50%",i.style.width="50%"):(l.style.left=0,l.style.width="50%",i.style.left="50%",i.style.width="50%")}Ol("")})(t),t.style.display="block",t.style.animation="slide-down 0.3s ease",["dropdown-item-print-preview","print-preview-header-trigger"].includes(e.id)&&og(),Ol(t.id))}),e.id,e.id,e.id,e.id,e.id,r&&r.addEventListener("click",o),l&&l.forEach(e=>{e.addEventListener("click",o)})}var yo=n(0),vo=n(8),bo=n(3);function wo(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Eo(e,t){this._pairs=[],e&&Object(bo.a)(e,this,t)}const Io=Eo.prototype;Io.append=function(e,t){this._pairs.push([e,t])},Io.toString=function(e){const t=e?function(t){return e.call(this,t,wo)}:wo;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var So=Eo;function ko(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function xo(e,t,n){if(!t)return e;const l=n&&n.encode||ko,i=n&&n.serialize;let r;if(r=i?i(t,n):yo.a.isURLSearchParams(t)?t.toString():new So(t,n).toString(l),r){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}var To=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){yo.a.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},_o=n(1),Bo={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Lo={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:So,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]};const Po="undefined"!=typeof window&&"undefined"!=typeof document,Co=(No="undefined"!=typeof navigator&&navigator.product,Po&&["ReactNative","NativeScript","NS"].indexOf(No)<0);var No;const Ro="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts;var Ao={...l,...Lo};var Fo=function(e){function t(e,n,l,i){let r=e[i++];const a=Number.isFinite(+r),o=i>=e.length;if(r=!r&&yo.a.isArray(l)?l.length:r,o)return yo.a.hasOwnProp(l,r)?l[r]=[l[r],n]:l[r]=n,!a;l[r]&&yo.a.isObject(l[r])||(l[r]=[]);return t(e,n,l[r],i)&&yo.a.isArray(l[r])&&(l[r]=function(e){const t={},n=Object.keys(e);let l;const i=n.length;let r;for(l=0;l<i;l++)r=n[l],t[r]=e[r];return t}(l[r])),!a}if(yo.a.isFormData(e)&&yo.a.isFunction(e.entries)){const n={};return yo.a.forEachEntry(e,(e,l)=>{t(function(e){return yo.a.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),l,n,0)}),n}return null};const Mo={transitional:Bo,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",l=n.indexOf("application/json")>-1,i=yo.a.isObject(e);i&&yo.a.isHTMLForm(e)&&(e=new FormData(e));if(yo.a.isFormData(e))return l&&l?JSON.stringify(Fo(e)):e;if(yo.a.isArrayBuffer(e)||yo.a.isBuffer(e)||yo.a.isStream(e)||yo.a.isFile(e)||yo.a.isBlob(e))return e;if(yo.a.isArrayBufferView(e))return e.buffer;if(yo.a.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let r;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Object(bo.a)(e,new Ao.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,l){return Ao.isNode&&yo.a.isBuffer(e)?(this.append(t,e.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((r=yo.a.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Object(bo.a)(r?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||l?(t.setContentType("application/json",!1),function(e,t,n){if(yo.a.isString(e))try{return(t||JSON.parse)(e),yo.a.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Mo.transitional,n=t&&t.forcedJSONParsing,l="json"===this.responseType;if(e&&yo.a.isString(e)&&(n&&!this.responseType||l)){const n=!(t&&t.silentJSONParsing)&&l;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw _o.a.from(e,_o.a.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ao.classes.FormData,Blob:Ao.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};yo.a.forEach(["delete","get","head","post","put","patch"],e=>{Mo.headers[e]={}});var Oo=Mo;const Do=yo.a.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);const Wo=Symbol("internals");function Ho(e){return e&&String(e).trim().toLowerCase()}function $o(e){return!1===e||null==e?e:yo.a.isArray(e)?e.map($o):String(e)}function qo(e,t,n,l,i){return yo.a.isFunction(l)?l.call(this,t,n):(i&&(t=n),yo.a.isString(t)?yo.a.isString(l)?-1!==t.indexOf(l):yo.a.isRegExp(l)?l.test(t):void 0:void 0)}class jo{constructor(e){e&&this.set(e)}set(e,t,n){const l=this;function i(e,t,n){const i=Ho(t);if(!i)throw new Error("header name must be a non-empty string");const r=yo.a.findKey(l,i);(!r||void 0===l[r]||!0===n||void 0===n&&!1!==l[r])&&(l[r||t]=$o(e))}const r=(e,t)=>yo.a.forEach(e,(e,n)=>i(e,n,t));return yo.a.isPlainObject(e)||e instanceof this.constructor?r(e,t):yo.a.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?r((e=>{const t={};let n,l,i;return e&&e.split("\n").forEach((function(e){i=e.indexOf(":"),n=e.substring(0,i).trim().toLowerCase(),l=e.substring(i+1).trim(),!n||t[n]&&Do[n]||("set-cookie"===n?t[n]?t[n].push(l):t[n]=[l]:t[n]=t[n]?t[n]+", "+l:l)})),t})(e),t):null!=e&&i(t,e,n),this}get(e,t){if(e=Ho(e)){const n=yo.a.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let l;for(;l=n.exec(e);)t[l[1]]=l[2];return t}(e);if(yo.a.isFunction(t))return t.call(this,e,n);if(yo.a.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ho(e)){const n=yo.a.findKey(this,e);return!(!n||void 0===this[n]||t&&!qo(0,this[n],n,t))}return!1}delete(e,t){const n=this;let l=!1;function i(e){if(e=Ho(e)){const i=yo.a.findKey(n,e);!i||t&&!qo(0,n[i],i,t)||(delete n[i],l=!0)}}return yo.a.isArray(e)?e.forEach(i):i(e),l}clear(e){const t=Object.keys(this);let n=t.length,l=!1;for(;n--;){const i=t[n];e&&!qo(0,this[i],i,e,!0)||(delete this[i],l=!0)}return l}normalize(e){const t=this,n={};return yo.a.forEach(this,(l,i)=>{const r=yo.a.findKey(n,i);if(r)return t[r]=$o(l),void delete t[i];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(i):String(i).trim();a!==i&&delete t[i],t[a]=$o(l),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return yo.a.forEach(this,(n,l)=>{null!=n&&!1!==n&&(t[l]=e&&yo.a.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(e=>n.set(e)),n}static accessor(e){const t=(this[Wo]=this[Wo]={accessors:{}}).accessors,n=this.prototype;function l(e){const l=Ho(e);t[l]||(!function(e,t){const n=yo.a.toCamelCase(" "+t);["get","set","has"].forEach(l=>{Object.defineProperty(e,l+n,{value:function(e,n,i){return this[l].call(this,t,e,n,i)},configurable:!0})})}(n,e),t[l]=!0)}return yo.a.isArray(e)?e.forEach(l):l(e),this}}jo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),yo.a.reduceDescriptors(jo.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}}),yo.a.freezeMethods(jo);var Vo=jo;function zo(e,t){const n=this||Oo,l=t||n,i=Vo.from(l.headers);let r=l.data;return yo.a.forEach(e,(function(e){r=e.call(n,r,i.normalize(),t?t.status:void 0)})),i.normalize(),r}function Uo(e){return!(!e||!e.__CANCEL__)}function Yo(e,t,n){_o.a.call(this,null==e?"canceled":e,_o.a.ERR_CANCELED,t,n),this.name="CanceledError"}yo.a.inherits(Yo,_o.a,{__CANCEL__:!0});var Jo=Yo,Go=n(9);var Xo=Ao.hasStandardBrowserEnv?{write(e,t,n,l,i,r){const a=[e+"="+encodeURIComponent(t)];yo.a.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),yo.a.isString(l)&&a.push("path="+l),yo.a.isString(i)&&a.push("domain="+i),!0===r&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Ko(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}var Zo=Ao.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function l(n){let l=n;return e&&(t.setAttribute("href",l),l=t.href),t.setAttribute("href",l),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=l(window.location.href),function(e){const t=yo.a.isString(e)?l(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0};var Qo=function(e,t){e=e||10;const n=new Array(e),l=new Array(e);let i,r=0,a=0;return t=void 0!==t?t:1e3,function(o){const s=Date.now(),d=l[a];i||(i=s),n[r]=o,l[r]=s;let c=a,u=0;for(;c!==r;)u+=n[c++],c%=e;if(r=(r+1)%e,r===a&&(a=(a+1)%e),s-i<t)return;const m=d&&s-d;return m?Math.round(1e3*u/m):void 0}};function es(e,t){let n=0;const l=Qo(50,250);return i=>{const r=i.loaded,a=i.lengthComputable?i.total:void 0,o=r-n,s=l(o);n=r;const d={loaded:r,total:a,progress:a?r/a:void 0,bytes:o,rate:s||void 0,estimated:s&&a&&r<=a?(a-r)/s:void 0,event:i};d[t?"download":"upload"]=!0,e(d)}}var ts="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){let l=e.data;const i=Vo.from(e.headers).normalize();let r,a,{responseType:o,withXSRFToken:s}=e;function d(){e.cancelToken&&e.cancelToken.unsubscribe(r),e.signal&&e.signal.removeEventListener("abort",r)}if(yo.a.isFormData(l))if(Ao.hasStandardBrowserEnv||Ao.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if(!1!==(a=i.getContentType())){const[e,...t]=a?a.split(";").map(e=>e.trim()).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...t].join("; "))}let c=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",n=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(t+":"+n))}const u=Ko(e.baseURL,e.url);function m(){if(!c)return;const l=Vo.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders());!function(e,t,n){const l=n.config.validateStatus;n.status&&l&&!l(n.status)?t(new _o.a("Request failed with status code "+n.status,[_o.a.ERR_BAD_REQUEST,_o.a.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),d()}),(function(e){n(e),d()}),{data:o&&"text"!==o&&"json"!==o?c.response:c.responseText,status:c.status,statusText:c.statusText,headers:l,config:e,request:c}),c=null}if(c.open(e.method.toUpperCase(),xo(u,e.params,e.paramsSerializer),!0),c.timeout=e.timeout,"onloadend"in c?c.onloadend=m:c.onreadystatechange=function(){c&&4===c.readyState&&(0!==c.status||c.responseURL&&0===c.responseURL.indexOf("file:"))&&setTimeout(m)},c.onabort=function(){c&&(n(new _o.a("Request aborted",_o.a.ECONNABORTED,e,c)),c=null)},c.onerror=function(){n(new _o.a("Network Error",_o.a.ERR_NETWORK,e,c)),c=null},c.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const l=e.transitional||Bo;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new _o.a(t,l.clarifyTimeoutError?_o.a.ETIMEDOUT:_o.a.ECONNABORTED,e,c)),c=null},Ao.hasStandardBrowserEnv&&(s&&yo.a.isFunction(s)&&(s=s(e)),s||!1!==s&&Zo(u))){const t=e.xsrfHeaderName&&e.xsrfCookieName&&Xo.read(e.xsrfCookieName);t&&i.set(e.xsrfHeaderName,t)}void 0===l&&i.setContentType(null),"setRequestHeader"in c&&yo.a.forEach(i.toJSON(),(function(e,t){c.setRequestHeader(t,e)})),yo.a.isUndefined(e.withCredentials)||(c.withCredentials=!!e.withCredentials),o&&"json"!==o&&(c.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&c.addEventListener("progress",es(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&c.upload&&c.upload.addEventListener("progress",es(e.onUploadProgress)),(e.cancelToken||e.signal)&&(r=t=>{c&&(n(!t||t.type?new Jo(null,e,c):t),c.abort(),c=null)},e.cancelToken&&e.cancelToken.subscribe(r),e.signal&&(e.signal.aborted?r():e.signal.addEventListener("abort",r)));const h=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(u);h&&-1===Ao.protocols.indexOf(h)?n(new _o.a("Unsupported protocol "+h+":",_o.a.ERR_BAD_REQUEST,e)):c.send(l||null)}))};const ns={http:Go.a,xhr:ts};yo.a.forEach(ns,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}});const ls=e=>"- "+e,is=e=>yo.a.isFunction(e)||null===e||!1===e;var rs=e=>{e=yo.a.isArray(e)?e:[e];const{length:t}=e;let n,l;const i={};for(let r=0;r<t;r++){let t;if(n=e[r],l=n,!is(n)&&(l=ns[(t=String(n)).toLowerCase()],void 0===l))throw new _o.a(`Unknown adapter '${t}'`);if(l)break;i[t||"#"+r]=l}if(!l){const e=Object.entries(i).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build"));let n=t?e.length>1?"since :\n"+e.map(ls).join("\n"):" "+ls(e[0]):"as no adapter specified";throw new _o.a("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return l};function as(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Jo(null,e)}function os(e){as(e),e.headers=Vo.from(e.headers),e.data=zo.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return rs(e.adapter||Oo.adapter)(e).then((function(t){return as(e),t.data=zo.call(e,e.transformResponse,t),t.headers=Vo.from(t.headers),t}),(function(t){return Uo(t)||(as(e),t&&t.response&&(t.response.data=zo.call(e,e.transformResponse,t.response),t.response.headers=Vo.from(t.response.headers))),Promise.reject(t)}))}const ss=e=>e instanceof Vo?e.toJSON():e;function ds(e,t){t=t||{};const n={};function l(e,t,n){return yo.a.isPlainObject(e)&&yo.a.isPlainObject(t)?yo.a.merge.call({caseless:n},e,t):yo.a.isPlainObject(t)?yo.a.merge({},t):yo.a.isArray(t)?t.slice():t}function i(e,t,n){return yo.a.isUndefined(t)?yo.a.isUndefined(e)?void 0:l(void 0,e,n):l(e,t,n)}function r(e,t){if(!yo.a.isUndefined(t))return l(void 0,t)}function a(e,t){return yo.a.isUndefined(t)?yo.a.isUndefined(e)?void 0:l(void 0,e):l(void 0,t)}function o(n,i,r){return r in t?l(n,i):r in e?l(void 0,n):void 0}const s={url:r,method:r,data:r,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(e,t)=>i(ss(e),ss(t),!0)};return yo.a.forEach(Object.keys(Object.assign({},e,t)),(function(l){const r=s[l]||i,a=r(e[l],t[l],l);yo.a.isUndefined(a)&&r!==o||(n[l]=a)})),n}const cs={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{cs[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const us={};cs.transitional=function(e,t,n){function l(e,t){return"[Axios v1.6.3] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,r)=>{if(!1===e)throw new _o.a(l(i," has been removed"+(t?" in "+t:"")),_o.a.ERR_DEPRECATED);return t&&!us[i]&&(us[i]=!0,console.warn(l(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,r)}};var ms={assertOptions:function(e,t,n){if("object"!=typeof e)throw new _o.a("options must be an object",_o.a.ERR_BAD_OPTION_VALUE);const l=Object.keys(e);let i=l.length;for(;i-- >0;){const r=l[i],a=t[r];if(a){const t=e[r],n=void 0===t||a(t,r,e);if(!0!==n)throw new _o.a("option "+r+" must be "+n,_o.a.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new _o.a("Unknown option "+r,_o.a.ERR_BAD_OPTION)}},validators:cs};const hs=ms.validators;class ps{constructor(e){this.defaults=e,this.interceptors={request:new To,response:new To}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=ds(this.defaults,t);const{transitional:n,paramsSerializer:l,headers:i}=t;void 0!==n&&ms.assertOptions(n,{silentJSONParsing:hs.transitional(hs.boolean),forcedJSONParsing:hs.transitional(hs.boolean),clarifyTimeoutError:hs.transitional(hs.boolean)},!1),null!=l&&(yo.a.isFunction(l)?t.paramsSerializer={serialize:l}:ms.assertOptions(l,{encode:hs.function,serialize:hs.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let r=i&&yo.a.merge(i.common,i[t.method]);i&&yo.a.forEach(["delete","get","head","post","put","patch","common"],e=>{delete i[e]}),t.headers=Vo.concat(r,i);const a=[];let o=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const s=[];let d;this.interceptors.response.forEach((function(e){s.push(e.fulfilled,e.rejected)}));let c,u=0;if(!o){const e=[os.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,s),c=e.length,d=Promise.resolve(t);u<c;)d=d.then(e[u++],e[u++]);return d}c=a.length;let m=t;for(u=0;u<c;){const e=a[u++],t=a[u++];try{m=e(m)}catch(e){t.call(this,e);break}}try{d=os.call(this,m)}catch(e){return Promise.reject(e)}for(u=0,c=s.length;u<c;)d=d.then(s[u++],s[u++]);return d}getUri(e){return xo(Ko((e=ds(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}yo.a.forEach(["delete","get","head","options"],(function(e){ps.prototype[e]=function(t,n){return this.request(ds(n||{},{method:e,url:t,data:(n||{}).data}))}})),yo.a.forEach(["post","put","patch"],(function(e){function t(t){return function(n,l,i){return this.request(ds(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:l}))}}ps.prototype[e]=t(),ps.prototype[e+"Form"]=t(!0)}));var gs=ps;class fs{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const l=new Promise(e=>{n.subscribe(e),t=e}).then(e);return l.cancel=function(){n.unsubscribe(t)},l},e((function(e,l,i){n.reason||(n.reason=new Jo(e,l,i),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new fs((function(t){e=t})),cancel:e}}}var ys=fs;const vs={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(vs).forEach(([e,t])=>{vs[t]=e});var bs=vs;const ws=function e(t){const n=new gs(t),l=Object(vo.a)(gs.prototype.request,n);return yo.a.extend(l,gs.prototype,n,{allOwnKeys:!0}),yo.a.extend(l,n,null,{allOwnKeys:!0}),l.create=function(n){return e(ds(t,n))},l}(Oo);ws.Axios=gs,ws.CanceledError=Jo,ws.CancelToken=ys,ws.isCancel=Uo,ws.VERSION="1.6.3",ws.toFormData=bo.a,ws.AxiosError=_o.a,ws.Cancel=ws.CanceledError,ws.all=function(e){return Promise.all(e)},ws.spread=function(e){return function(t){return e.apply(null,t)}},ws.isAxiosError=function(e){return yo.a.isObject(e)&&!0===e.isAxiosError},ws.mergeConfig=ds,ws.AxiosHeaders=Vo,ws.formToJSON=e=>Fo(yo.a.isHTMLForm(e)?new FormData(e):e),ws.getAdapter=rs,ws.HttpStatusCode=bs,ws.default=ws;var Es=ws;const Is="https://api.maxweave.com/v1",Ss=()=>{const e=localStorage.getItem("token");let t=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id;return Es.get(`${Is}/draft-plan/get-draft-plan/${t}`,{headers:{token:e}})},ks=e=>{const t=localStorage.getItem("token");return Es.post(Is+"/main-design/create",e,{headers:{token:t}})},xs=e=>{const t=localStorage.getItem("token");return Es.get(`${Is}/main-design/delete-weave-design/${e}`,{headers:{token:t}})},Ts=()=>{const e=localStorage.getItem("token");let t=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id;return Es.get(`${Is}/main-design/get-main-design/${t}`,{headers:{token:e}})},_s=()=>{const e=localStorage.getItem("token");let t=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id;return Es.get(`${configObject.APP_API}/peg-plan/get-peg-plan/${t}`,{headers:{token:e}})},Bs=e=>{const t=localStorage.getItem("token");return Es.post(Is+"/color-palette/create",e,{headers:{token:t}})},Ls=()=>{const e=localStorage.getItem("token");let t=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id;return Es.get(`${Is}/color-palette/get-color-palette/${t}`,{headers:{token:e}})},Ps=document.getElementById("open-color-palette-modal"),Cs=document.getElementsByClassName("open-color-palette-trigger");let Ns,Rs,As,Fs,Ms,Os=[];const Ds=e=>{if(e.yarnDetail){for(let t=0;t<e.yarnDetail.length;t++){let n=e.yarnDetail[t].yarnLetter,l=e.yarnDetail[t].colorCode,i=e.yarnDetail[t].yarnType,r=e.yarnDetail[t].yarnName,a=e.yarnDetail[t].yarnWarpOrWeft;"warp"==a?(Lr[n]=l,(i||r)&&(Pr[n]={yarnType:i,yarnName:r})):"weft"==a?(Qm[n]=l,(i||r)&&(th[n]={yarnType:i,yarnName:r})):"function"==a&&(eh[n]=l)}tw()}},Ws=e=>{console.log("clicked",e);let t=Os.find(t=>t.id==e.target.id);As=t,(e=>{let t=e.yarnDetail,n=t.filter(e=>"warp"==e.yarnWarpOrWeft),l=t.filter(e=>"weft"==e.yarnWarpOrWeft),i=t.filter(e=>"function"==e.yarnWarpOrWeft);Fs.value=e.name,Rs.innerHTML="",Rs.innerHTML+=`<div>\n        <div>Warp</div>\n        ${n.map(e=>`<div style="background-color:${e.colorCode};border:1px solid grey;color:${["#000000","rgb(0,0,0)"].includes(e.colorCode)?"white":"black"}">${e.yarnLetter}</div>`).join("")}\n    </div>`,Rs.innerHTML+=`<div>\n    <div>Weft</div>\n    ${l.map(e=>`<div style="background-color:${e.colorCode};border:1px solid grey;color:${["#000000","rgb(0,0,0)"].includes(e.colorCode)?"white":"black"}">${e.yarnLetter}</div>`).join("")}\n</div>`,Rs.innerHTML+=`<div>\n<div>Fun</div>\n${i.map((e,t)=>`<div style="background-color:${e.colorCode};border:1px solid grey;color:${["#000000","rgb(0,0,0)"].includes(e.colorCode)?"white":"black"}">${t+1}</div>`).join("")}\n</div>`})(As),console.log("selectedColorPaletteData",As)},Hs=e=>{console.log("value of e is",e.target.value);let t=String(e.target.value);if(t.length>0){let e=Os.filter(e=>String(e.name).toLowerCase().includes(t.toLowerCase()));for(let e=0;e<Os.length;e++){document.getElementById(Os[e].id).style.display="none"}for(let t=0;t<e.length;t++){document.getElementById(e[t].id).style.display="block"}}else for(let e=0;e<Os.length;e++){document.getElementById(Os[e].id).style.display="block"}},$s=()=>{(async()=>{try{let e=await Ls();Os=e.data.DATA,Ns.innerHTML="";for(let e=0;e<Os.length;e++)Ns.innerHTML+=`<div id="${Os[e].id}">${Os[e].name}</div>`;for(let e=0;e<Os.length;e++){document.getElementById(Os[e].id).addEventListener("click",Ws)}}catch(e){console.log("err is",e)}})(),nv(),Ps.style.display="block",Ps.style.animation="slide-down 0.3s ease"},qs=()=>{Ns.innerHTML="",Ps.style.display="none",Ol("")},js=()=>{Ds(As),qs()},Vs=document.getElementById("weft-selector-modal"),zs=document.getElementById("set-weft-selector-trigger");let Us,Ys,Js,Gs={};const Xs=e=>{Gs={...e}},Ks=()=>{const e=Vs.querySelector("#modal-desc");e.innerHTML="",e.style.display="flex",e.style.flexDirection="row";const t=document.createElement("div"),n=document.createElement("div"),l=document.createElement("div");l.innerText="Weft Yarn";const i=document.createElement("div");i.innerText="Selector",t.appendChild(l),n.appendChild(i);const r=document.createElement("form");let a=nb(ob());console.log("Weft Color is",Qm),a.forEach(e=>{let n=document.createElement("div");n.innerText=e,t.appendChild(n);const l=document.createElement("div"),i=document.createElement("input");i.name="weft-selector-"+e,i.id="weft-selector-"+e,i.min=1,i.type="number",i.style.width="100%",i.style.height="100%",l.appendChild(i),r.appendChild(l)}),n.appendChild(r),e.appendChild(t),e.appendChild(n),Object.keys(Gs).forEach(e=>{Vs.querySelector("#weft-selector-"+e).value=Gs[e]})},Zs=()=>{nv(),Vs.style.display="block",Vs.style.animation="slide-down 0.3s ease",Ks()},Qs=()=>{Vs.style.display="none"},ed=()=>{let e=Vs.querySelector("form");const t=new FormData(e),n=Object.fromEntries(t);let l={};Object.keys(n).forEach(e=>{l[e.at(-1)]=n[e]}),Xs(l)},td=()=>{ed(),Qs()},nd=()=>{Qs()},ld=document.getElementById("set-density-trigger"),id=document.getElementById("set-density-modal");let rd,ad,od,sd=[];const dd=e=>{sd=[...e]},cd=e=>{"Escape"===e.key&&md()},ud=()=>{document.addEventListener("keydown",cd),(()=>{let e=document.getElementsByClassName("dencity-modal-input");for(let t=0;t<e.length;t++){let n=e.item(t),l=Number(ub(n.id.split("-").at(-1)));n.value=sd[l-1]?sd[l-1]:""}})(),nv(),id.style.display="block",id.style.animation="slide-down 0.3s ease",Ol("set-density-modal")},md=()=>{document.removeEventListener("keydown",cd),id.style.display="none",Ol("")},hd=()=>{let e=document.getElementsByClassName("dencity-modal-input");for(let t=0;t<e.length;t++){let n=e.item(t),l=n.value,i=Number(ub(n.id.split("-").at(-1)));isNaN(i)||(sd[i-1]=l)}},pd=()=>{hd(),md()},gd=document.getElementById("recent-list-parent"),fd=e=>{if(console.log("Darta",e),e.name&&e.id&&(Ld.innerText=e.name,vd(e),(e=>{qf.value=e.unit,Ef.value=e.shaft,NB.value=e.reed,jf.value=e.perinch,vf.value=e.leftSalvageWidth,Lf.value=e.bodyWidth,bf.value=e.rightSalvageWidth,If.value=e.leftSalvageWarpDent,Sf.value=e.bodyWarpDent,kf.value=e.rightSalvageWarpDent,Af.value=e.warpDencity,Ff.value=parseFloat(e.weftDencity).toFixed(2),Df.value=e.designHeight,Wf.value=e.designWidth,Hf.value=e.weftHeight,$f.value=e.warpWidth,Mf.value=e.gridHeight,Of.value=e.gridWidth,Tf.value=parseInt(Number(e.reed)/Number(e.perinch)*Number(e.bodyWidth)),Cf.value=Tf.value*Number(Sf.value),xf.value=parseInt(Number(NB.value)/Number(jf.value)*Number(vf.value)),_f.value=parseInt(Number(NB.value)/Number(jf.value)*Number(bf.value)),Bf.value=Number(xf.value)+Number(Tf.value)+Number(_f.value),Pf.value=xf.value*Number(If.value),Oi.value=_f.value*Number(kf.value),Rf.value=Number(Pf.value)+Number(Cf.value)+Number(Oi.value),wf.value=Number(vf.value)+Number(Lf.value)+Number(bf.value),ry()})(e)),e.designWidth&&Xf(Number(e.designWidth)),e.colorPaletteId&&Ds(e.colorPaletteId),e.extraWarp&&JB.set_all_value_from_string(e.extraWarp),bb(e.leftSalvage)&&bv(JSON.parse(e.leftSalvage)),bb(e.rightSalvage)&&wv(JSON.parse(e.rightSalvage)),e.creaming&&YB.set_all_value_from_string(e.creaming),e.density&&bb(e.density)){let t=JSON.parse(e.density);t&&Array.isArray(t.cells)&&t.cells.length>0?GB.set_all_value_from_string(e.density,!0):Array.apply(null,Array(t.size)).map((function(e,t){return new ci("A",t)}))}if(e.draftDesignModeType&&pm(e.draftDesignModeType),e.pegPlanDesignModeType&&pE(e.pegPlanDesignModeType),e.draftPlan&&e.draftPlan.length>0&&(Ph.value=e.draftPlan,FB.change_no_of_rows(Number(e.shaft)),Fh()),e.pegPlan&&e.pegPlan.length>0&&(ra.value=e.pegPlan,DB.change_no_of_cols(Number(e.shaft)),ca()),e.warpPattern&&e.warpPattern.length>0&&(Zr("warp"),Yr.value=e.warpPattern,la()),e.weftPattern&&e.weftPattern.length>0&&(Zr("weft"),Yr.value=e.weftPattern,la()),e.skipDent){const t=new Uint32Array(e.skipDent.split(","));t.length==WB.cols()?WB.change_click_cells(t):WB.change_click_cells(Array(WB.cols()).fill(0)),Bh()}if(e.notes&&Ig(e.notes),e.doubleBeam){let t=new Uint32Array(e.doubleBeam.split(","));t=-1==t.findIndex(e=>![1,2].includes(e))?t:Array(t.length).fill(1),FB.cols()>t.length?ZB.reset_cell_from_size(FB.cols()):ZB.change_cells(t,FB.cols()),Qi()}var t;e.weftSelectorMapping&&(bb(e.weftSelectorMapping)?Xs(JSON.parse(e.weftSelectorMapping)):Xs({})),e.densityMapping&&(bb(e.densityMapping)?dd(JSON.parse(e.densityMapping)):dd([])),e.draftWithPart&&Array.isArray(e.draftWithPart.designWithPart)&&Array.isArray(e.draftWithPart.draftParts)&&(Kh(e.draftWithPart.designWithPart),t=e.draftWithPart.draftParts,hr=t),rI(),iI({target:{scrollLeft:0}}),hE({target:{scrollTop:0}}),ry(!0)},yd=e=>{let t=localStorage.getItem(ou.RECENT_FILE),n=t?JSON.parse(t):[];n=n.filter(t=>t.id!=e),localStorage.setItem(ou.RECENT_FILE,JSON.stringify(n));for(let e=0;e<n.length;e++)gd.innerHTML+=` <li class="dropdown-item load-design" id="recent-design-${n[e].id}">\n    <div class="flex item-menu item-center">\n      <p>${n[e].name}</p>\n    </div>\n  </li>\n  <hr/>`;for(let e=0;e<n.length;e++)document.getElementById("recent-design-"+n[e].id).addEventListener("click",()=>{fd(n[e])})},vd=e=>{let t=localStorage.getItem(ou.RECENT_FILE),n=t?JSON.parse(t):[];n=n.filter(t=>t.id!=e.id),n=[e,...n].slice(0,7),localStorage.setItem(ou.RECENT_FILE,JSON.stringify(n)),gd.innerHTML="";for(let e=0;e<n.length;e++)gd.innerHTML+=` <li class="dropdown-item load-design" id="recent-design-${n[e].id}">\n    <div class="flex item-menu item-center">\n      <p>${n[e].name}</p>\n    </div>\n  </li>`;for(let e=0;e<n.length;e++)document.getElementById("recent-design-"+n[e].id).addEventListener("click",()=>{fd(n[e])})},bd=()=>{document.getElementsByClassName("load-design");(()=>{let e=localStorage.getItem(ou.RECENT_FILE),t=e?JSON.parse(e):[];gd.innerHTML="";for(let e=0;e<t.length;e++)gd.innerHTML+=` <li class="dropdown-item load-design" id="recent-design-${t[e].id}">\n    <div class="flex item-menu item-center">\n    \n      <p>${t[e].name}</p>\n    </div>\n  </li>`;for(let e=0;e<t.length;e++)document.getElementById("recent-design-"+t[e].id).addEventListener("click",()=>{fd(t[e])})})(),Ld.innerText="Untitled"},wd=document.getElementById("confirm-dialog"),Ed=document.getElementById("confirm-dialog-message"),Id=document.getElementById("confirm-dialog-ok-button"),Sd=document.getElementById("confirm-dialog-cancel-button"),kd=(e,t="Yes",n="No")=>(Ed.innerHTML=e,Id.innerHTML=t,Sd.innerHTML=n,wd.showModal(),new Promise((e,t)=>{const n=e=>{"Escape"==e.key&&(Id.removeEventListener("click",l),Sd.removeEventListener("click",i),wd.removeEventListener("keydown",n))},l=()=>{console.log("ok clicked"),Sd.removeEventListener("click",i),wd.removeEventListener("keydown",n),Id.removeEventListener("click",l),wd.close(),e(!0)},i=()=>{console.log("cancel clicked"),Id.removeEventListener("click",l),wd.removeEventListener("keydown",n),Sd.removeEventListener("click",i),wd.close(),e(!1)};Id.addEventListener("click",l),Sd.addEventListener("click",i),wd.addEventListener("keydown",n)})),xd=new Event("beforeExportProcessDone");let Td,_d=!1;const Bd=document.getElementById("save-maindesign-modal"),Ld=document.getElementById("file-name-navbar"),Pd=document.getElementById("save-maindesign-modal-trigger"),Cd=document.getElementById("save-as-maindesign-modal-trigger"),Nd=document.getElementById("close-file-trigger");let Rd,Ad,Fd,Md="",Od="",Dd=[];const Wd=e=>{Dd=e},Hd=e=>{for(let e=0;e<Dd.length;e++){document.getElementById(Dd[e].id).classList.remove("maindesign-file-active")}e.currentTarget.classList.add("maindesign-file-active");let t=Dd.find(t=>t.id==e.currentTarget.id);Td=t,Rd.value=t.name},$d=e=>{console.log("rename clicked",Td,e.target.parentNode);let t=document.getElementById(Td.id),n=t.querySelector(".open-pegplan-data-content-file-name"),l=t.querySelector("input");n&&(n.style.display="none"),l&&(l.value=Td.name,l.style.display="block",l.focus(),l.addEventListener("keydown",qd))},qd=async e=>{if("Enter"==e.key){console.log("eeeeee",e.target.value);let t={mainDesignId:Td.id,name:e.target.value};try{let n=await ks(t);vd(n.data.DATA),Toastify({text:"File Saved Successfully",className:"info",style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast(),console.log("resData is",n);let l=document.getElementById(Td.id),i=l.querySelector(".open-pegplan-data-content-file-name");i.innerText=e.target.value;let r=l.querySelector("input");i.style.display="block",r.style.display="none",l.classList.remove("maindesign-file-active"),Td=null}catch(e){console.log("inside error",e)}}},jd=async e=>{await kd("Are you sure you want to permanently delete this file?")?(console.log("delete design",Td),xs(Td.id).then(e=>{console.log("delete design succuss fully",e.data),Vd(),Rd.value="",deleteFromRecentDesign(Td.id),Td=null}).catch(e=>console.log("delete design failed"))):console.log("do not delete it")},Vd=async()=>{try{let e=await Ts();Wd(e.data.DATA),Fd.innerHTML="";for(let e=0;e<Dd.length;e++)Fd.innerHTML+=`<div class="open-pegplan-data-container-content" id="${Dd[e].id}">\n      <div class="open-pegplan-data-content-image">\n        <img src="maxweavefev.png" width="100">\n      </div>\n        <div class="open-pegplan-data-content-file-name">${Dd[e].name}</div>\n        <input style="display:none;"/>\n      </div>`;const t=document.getElementById("savemaindesign-renameDeleteMenu");for(let e=0;e<Dd.length;e++){const n=document.getElementById(Dd[e].id);Cw(n,t),n.addEventListener("contextmenu",Hd),n.addEventListener("click",Hd)}const n=document.getElementById("savemaindesign-rename-trigger-element"),l=document.getElementById("savemaindesign-delete-trigger-element");n.addEventListener("click",$d),l.addEventListener("click",jd)}catch(e){console.log("err is",e)}},zd=()=>{nv(),Vd(),Bd.style.display="block",Bd.style.animation="slide-down 0.3s ease"},Ud=()=>{Bd.style.display="none",Ol("")},Yd=e=>{let t=String(e.target.value);if(t.length>0){let e=Dd.filter(e=>String(e.name).toLowerCase().includes(t.toLowerCase()));for(let e=0;e<Dd.length;e++){document.getElementById(Dd[e].id).style.display="none"}for(let t=0;t<e.length;t++){document.getElementById(e[t].id).style.display="block"}}else for(let e=0;e<Dd.length;e++){document.getElementById(Dd[e].id).style.display="block"}},Jd=async e=>{let t=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id,n=Dd.find(e=>e.name.trim()==Od);Md=n?n.id:"";let l=um==Il?FB.convert_new_index_to_numeric(WB):FB.get_fix_numeric_text(),i=mb(l);const r=Pv(String(i).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e)));let a=uE==kl?DB.convert_new_index_to_numeric():DB.get_fix_numeric_text(),o=mb(a,!0);const s=String(o).split("\n").length;let d="",c="",u="",m="",h=0;if(um==Il){for(let e=XB.size-1;e>=XB.getMinimumIndex();e--){let t=XB.findElementFromIndex(e);t?(h>0&&(d+=h.toString()+"\n"),d+=t.color_code+"\n",h=0):h++}h=0,u=nL(d.toUpperCase());for(let e=0;e<=KB.getMaximumIndex();e++){let t=KB.findElementFromIndex(e);t?(h>0&&(c+=h.toString()+"\n"),c+=t.color_code+"\n",h=0):h++}m=nL(c.toUpperCase())}else m=KB.fixNumericText,u=XB.fixNumericText;let p=await(async()=>{let e=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id,t=[];Object.keys(Lr).forEach(e=>{t.push({yarnType:Pr[e]?Pr[e].yarnType:"",yarnName:Pr[e]?Pr[e].yarnName:"",yarnLetter:e,yarnWarpOrWeft:"warp",colorCode:Lr[e]})}),Object.keys(Qm).forEach(e=>{t.push({yarnType:th[e]?th[e].yarnType:"",yarnName:th[e]?th[e].yarnName:"",yarnLetter:e,yarnWarpOrWeft:"weft",colorCode:Qm[e]})}),Object.keys(eh).forEach(e=>{t.push({yarnType:"",yarnName:"",yarnLetter:e,yarnWarpOrWeft:"function",colorCode:eh[e]})});let n={colorPaletteId:"",user:e,name:Rd.value+"-color-palette",yarnDetail:t,isFileConnected:!0};try{return(await Bs(n)).data.DATA.id}catch(e){console.log("inside error",e)}})();const g=new Uint32Array(aL.memory.buffer,WB.click_cells(),WB.click_dentgrid_length()).toString(),f=new Uint32Array(aL.memory.buffer,ZB.cells(),ZB.selected_beamgrid_length()).toString();console.log("color palette id is",p);let y={pegPlan:a,draftPlan:l,warpPattern:m,weftPattern:u,user:t,name:Od,shaft:FB.rows().toString(),mainDesignId:Md,picks:s.toString(),ends:r.toString(),unit:qf.value,reed:NB.value,perinch:jf.value,leftSalvageWidth:gf,bodyWidth:yf,rightSalvageWidth:ff,leftSalvageWarpDent:If.value,bodyWarpDent:Sf.value,rightSalvageWarpDent:kf.value,warpDencity:Af.value,weftDencity:Ff.value,designHeight:Df.value,designWidth:Wf.value,gridHeight:Mf.value,gridWidth:Of.value,weftHeight:Hf.value,warpWidth:$f.value,skipDent:g,doubleBeam:f,draftWithPart:{designWithPart:Vh,draftParts:hr},extraWarp:JSON.stringify(JB),creaming:JSON.stringify(YB),density:JSON.stringify(GB),leftSalvage:JSON.stringify(gv),rightSalvage:JSON.stringify(fv),weftSelectorMapping:JSON.stringify(Gs),densityMapping:JSON.stringify(sd),draftDesignModeType:um,pegPlanDesignModeType:uE,notes:fg,colorPaletteId:p};try{let e=await ks(y);if(vd(e.data.DATA),Ld.innerText=Od,_d)return void document.dispatchEvent(xd);Toastify({text:"File Saved Successfully",className:"info",style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast(),console.log("resData is",e)}catch(e){console.log("inside error",e)}nv(),nv()},Gd=async()=>{Od=Rd.value.trim(),Dd.find(e=>e.name==Od)&&!await kd("Do You Want To Replace it?")||(Jd(),Ud())},Xd=async(e=!1)=>{_d=e;let t=await Ts();Wd(t.data.DATA),Od=Ld.innerText,"Untitled"!=Od?Jd():zd()},Kd=async()=>{Ld.innerText;await kd("Do You Want To Save It?")?zd():window.location.reload(!0)},Zd=()=>{if((()=>{if(DB.cols()>28)return Toastify({text:"More than 28 shaft now allowed in .db1 file",style:{background:"linear-gradient(135deg,#FF0200, #F6A5A5)"}}).showToast(),!0;let e=nb(ob());console.log("weft selector mappibg",Gs);for(let t=0;t<e.length;t++){if(!Number(Gs[e[t]]))return Toastify({text:"Please Select Weft Selector For Yarn - "+Ra(e[t],"weft"),style:{background:"linear-gradient(135deg,#FF0200, #F6A5A5)"}}).showToast(),e[t]}return e.forEach(e=>{if(!Gs[e])return!0}),!1})())return;let e=DB.convert_new_index_to_numeric(!0),t=String(e).split("\n"),n=t.filter(e=>e).length,l="",i=DB.cols();l+=Number(n).toString(2).padStart(16,"0").split("").reverse().join(""),l+=Number(i).toString(2).padStart(8,"0").split("").reverse().join("").padEnd(16,"0"),t.forEach((e,t)=>{let i=(e=>{let t="0".repeat(16);const n=e.split(" ").map(Number);for(const e of n)e>=1&&e<=16&&(t=t.substr(0,e-1)+"1"+t.substr(e));return t+"0".repeat(16)})(e),r=XB.cells.find(e=>e.index==n-t-1),a=GB.cells.find(e=>e.index==n-t-1);if(r){let e=r.color_code,t=Number(Gs[e]);t&&(i=ac(i,15+t,"1"))}if(a){let e=a.color_code,t=String(e).charCodeAt(0)-65+1;t<4&&t>0&&(i=ac(i,t+23,"1"))}l+=i});let r=Ld.innerText;sc(dc(l),r+".bnx")},Qd=e=>{let t=ml.start+pl.end,n=ml.end+pl.end,l=hl.start,i=String(e);"9"!=l.toString()&&(i=i.replace("32",(Number(32)+Number(l)).toString()));for(let e=Number(t);e<=Number(n);e++)if(-1!=i.search(e)){i=i.replace(e,33+e-Number(t));break}return(e=>{let t="0".repeat(40);const n=e.split(" ").map(Number);for(const e of n)e>=1&&e<=40&&(t=t.substr(0,e-1)+"1"+t.substr(e));return t})(i)},ec=()=>{if((()=>{if(DB.cols()>28)return Toastify({text:"More than 28 shaft now allowed in .db1 file",style:{background:"linear-gradient(135deg,#FF0200, #F6A5A5)"}}).showToast(),!0;let e=nb(ob());console.log("weft selector mappibg",Gs);for(let t=0;t<e.length;t++){if(!Number(Gs[e[t]]))return Toastify({text:"Please Select Weft Selector For Yarn - "+Ra(e[t],"weft"),style:{background:"linear-gradient(135deg,#FF0200, #F6A5A5)"}}).showToast(),e[t]}return e.forEach(e=>{if(!Gs[e])return!0}),!1})())return;let e=((e=!0,t=0)=>{let n=DB.get_new_print_pegplan_data(!1);console.log("pegplan numeric text is",n);let l=String(n).split("\n").filter(e=>e),i=[...l];if(ml.start&&ml.end&&hl.start&&hl.end){let e=tb();console.log("fidder color ",e);let n=[];l.forEach((l,i)=>{let r=XB.findElementFromIndex(XB.size-i-1),a=YB.findElementFromIndex(XB.size-i-1);if(r){let i=l+" "+(Number(e[r.color_code])+(t?Number(pl.end):0));a&&(i+=" "+(t||hl.start)),n.push(i)}else{let e=l+" "+ml.start;a&&(e+=" "+(t||hl.start)),n.push(e)}}),i=[...n]}if(e){let e=compressPlanString(i.join("\n"));return String(e).trim()}return i.join("\n")})(!1,32).split("\n"),t=e.length,n="";e.forEach(e=>{let t=Qd(e);n+=t}),n+="0".repeat(64),n+=Number(t).toString(2).padStart(16,"0");const l=Ld.innerText,i=dc(n);let r=cc(Number(t).toString(2).padStart(16,"0"));i[i.length-2]=r[0],i[i.length-1]=r[1],sc(i,l+".db1"),console.log("export db1 file called")},tc=async()=>{if(console.log("download button clicked"),(()=>{let e=nb(ob());console.log("weft selector mappibg",Gs);for(let t=0;t<e.length;t++){if(!Number(Gs[e[t]]))return Toastify({text:"Please Select Weft Selector For Yarn - "+Ra(e[t],"weft"),style:{background:"linear-gradient(135deg,#FF0200, #F6A5A5)"}}).showToast(),e[t]}return e.forEach(e=>{if(!Gs[e])return!0}),!1})())return;const e=Ld.innerText;let t=DB.cols();ml.start,ml.end,pl.start;const n=pl.end;hl.start,hl.end;if(t>n&&vb("This File Contains more shaft than "+n),t>20&&!await kd("This File Contains More than 20 shaft,only first 20 shafts will be considered,Do you want to export it?"))return;let l=DB.convert_new_index_to_numeric(!0),i=String(l).split("\n"),r=i.filter(e=>e).length,a="";i.forEach((e,t)=>{let n=(e=>{let t="0".repeat(20);const n=e.split(" ").map(Number);for(const e of n)e>=1&&e<=20&&(t=t.substr(0,e-1)+"1"+t.substr(e));return t+"0".repeat(12)})(e),l=XB.cells.find(e=>e.index==r-t-1),i=GB.cells.find(e=>e.index==r-t-1),o=YB.cells.find(e=>e.index==r-t-1);if(l){let e=l.color_code,t=Number(Gs[e]);t&&(n=ac(n,23+t,"1"))}if(i){let e=i.color_code,t=String(e).charCodeAt(0)-65+1;t<4&&t>0&&(n=ac(n,t+19,"1"))}o&&(n=ac(n,23,"1")),a+=n});sc(dc(a),e+".bin"),console.log("rifa bin download button clicked")},nc=async()=>{if((()=>{let e=nb(ob());console.log("weft selector mappibg",Gs);for(let t=0;t<e.length;t++){if(!Number(Gs[e[t]]))return Toastify({text:"Please Select Weft Selector For Yarn - "+Ra(e[t],"weft"),style:{background:"linear-gradient(135deg,#FF0200, #F6A5A5)"}}).showToast(),e[t]}return e.forEach(e=>{if(!Gs[e])return!0}),!1})())return;const e=Ld.innerText;DB.cols();let t=oc(),n="",l=(e=>{let t=[],n=String(e).split("\n"),l=0,i=0,r="";for(let e=0;e<n.length;e++)if(0==l)if(n[e].includes("[")){r.length>0&&(t.push({pegplanContent:r,repeat:1}),r="",i=0);let a=0,o=e+1,s=0;for(l=1;!n[o].includes("]");)a+=1,o+=1,l+=1;i=o-e+1,s=n.slice(e,o+1).join("\n").split("X")[1];let d=n.slice(e,o+1).join("\n").split("X")[0].replace("[","").replace("]","");if(i*s>1/0){let e=0,n=Math.floor(i*s/(1/0));for(let l=0;l<n;l++)t.push({pegplanContent:d,repeat:parseInt(s)}),e+=i;if(e!=i*s){let e=i*s%(1/0);t.push({pegplanContent:d.split("\n").slice(0,e).join("\n"),repeat:1})}i=0,r=""}else t.push({pegplanContent:d,repeat:parseInt(s)}),i=0,r=""}else i==1/0&&(t.push({pegplanContent:r,repeat:1}),r="",i=0),r+=n[e]+"\n",i+=1,e+1==n.length&&(t.push({pegplanContent:r,repeat:1}),r="",i=0);else l-=1;return t})(iL(t)),i=""+uc(l.length).toString(2).padStart(8,"0").padEnd(32,"0"),r="";l.forEach(e=>{let t=e.pegplanContent.trim().split("\n").length,n=Number(t).toString(2).padStart(32,"0"),l=n.substring(24,32)+n.substring(16,24)+n.substring(8,16)+n.substring(0,8);r+=l});let a="";l.forEach(e=>{let t=Number(e.repeat).toString(2).padStart(32,"0"),n=t.substring(24,32)+t.substring(16,24)+t.substring(8,16)+t.substring(0,8);a+=n});let o="";l.forEach(e=>{e.pegplanContent.trim().split("\n").forEach(e=>{let t=((e,t=40)=>{let n="0".repeat(t);String(e).split(" ").forEach(e=>{n=ac(n,Number(e)-1,"1")}),n=n.split("").reverse().join("");let l="";for(const e of n)l+=String(e).charCodeAt(0).toString(2).padStart(8,"0");return l})(e);o+=t})}),n+="0111011101101010011011000010011001110011011000100000000000000000",n+=i,n+="1101000001100100011100010000001000001100011000110111000100000010",n+=r,n+=a,n+=o;sc(cc(n),e+".wjl")},lc=document.getElementById("download-file-trigger"),ic=()=>{Xd(!0)},rc=()=>{let e=Cc.value;"rifa"==e?tc():"pt7"==e?pc():"chines-dobby"==e?nc():"db1-profile"==e?ec():"bnx-profile"==e?Zd():Toastify({text:"Please Select Loom Profile",className:"info",style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast()},ac=(e,t,n)=>{let l=e.split("");return l[t]=n,l=l.join(""),l},oc=(e=!0)=>{let t=DB.get_new_print_pegplan_data(!1);console.log("pegplan numeric text is",t);let n=String(t).split("\n").filter(e=>e),l=[...n];if(ml.start&&ml.end&&hl.start&&hl.end){let e=tb();console.log("fidder color ",e);let t=[];n.forEach((n,l)=>{let i=XB.findElementFromIndex(XB.size-l-1),r=YB.findElementFromIndex(XB.size-l-1);if(i){let l=n+" "+e[i.color_code];r&&(l+=" "+hl.start),t.push(l)}else{let e=n+" "+ml.start;r&&(e+=" "+hl.start),t.push(e)}}),l=[...t]}if(e){let e=iL(l.join("\n"));return String(e).trim()}return l.join("\n")};async function sc(e,t){let n=new Blob([new Uint8Array(e)],{type:"application/octet-stream"}),l=document.createElement("a");l.href=URL.createObjectURL(n),l.download=t,document.body.appendChild(l),l.click(),document.body.removeChild(l)}function dc(e){let t=String(e);if(t.length%8!=0)throw new Error("The length of the bit string must be a multiple of 8.");const n=t.length/8,l=new Uint8Array(n);for(let e=0;e<n;e++){const n=t.slice(8*e,8*(e+1)).split("").reverse().join("");l[e]=parseInt(n,2)}return l}const cc=e=>{let t=String(e);if(t.length%8!=0)throw new Error("The length of the bit string must be a multiple of 8.");const n=t.length/8,l=new Uint8Array(n);for(let e=0;e<n;e++){const n=t.slice(8*e,8*(e+1));l[e]=parseInt(n,2)}return l},uc=e=>Number(e).toString(2);document.getElementById("download-file-trigger");function mc(e){return Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}const hc=(e,t)=>{for(let n=t;n<=t+11;n++)if(e.includes(n.toString()))return n;return!1},pc=()=>{if((()=>{let e=nb(ob());console.log("weft selector mappibg",Gs);for(let t=0;t<e.length;t++){if(!Number(Gs[e[t]]))return Toastify({text:"Please Select Weft Selector For Yarn - "+Ra(e[t],"weft"),style:{background:"linear-gradient(135deg,#FF0200, #F6A5A5)"}}).showToast(),e[t]}return e.forEach(e=>{if(!Gs[e])return!0}),!1})())return;let e=DB.cols(),t="\n        4a 41 54 37 30 30 2d 4d 43 41 52 44 2d 44 41 54 41 \n        20 66 69 6c 65 5f 69 6e 66 6f 20 2d 2d 2d 2d 2d 2d \n        2d 2d 2d 2d 2d 0d 0a 74 64 6d 5f 66 69 6c 65 6e 61 6d \n        65 20 22 43 6f 6d 62 69 6e 61 74 69 6f 6e 2d 31 22 \n        0d 0a 74 64 6d 5f 67 72 6f 75 70 6e 61 6d 65 20 22 \n        22 0d 0a 23 65 6e 64 5f 6f 66 5f 64 61 74 61 0d 0a \n        4a 41 54 37 30 30 2d 4d 43 41 52 44 2d 44 41 54 41 \n        20 70 61 74 74 65 72 6e 5f 66 70 20 2d 2d 2d 2d 2d \n        2d 2d 2d 2d 2d 2d 0d 0a 70 61 74 74 65 72 6e 5f 6e \n        61 6d 65 20 22 22 0d 0a 56 65 72 73 69 6f 6e 20 20 \n        20 20 20 20 31 30 0d 0a 6d 61 63 68 69 6e 65 74 79 \n        70 65 20 22 4a 41 54 37 31 30 22 0d 0a 73 68 65 64 \n        20 22 64 6f 62 62 79 22 0d 0a 66 61 62 72 69 63 74 \n        79 70 65 20 22 64 6f 62 62 79 22 0d 0a 70 69 6c 65 \n        20 22 6d 65 63 68 61 6e 69 63 61 6c 22 0d 0a 74 61 \n        6b 65 75 70 20 22 63 68 61 6e 67 65 61 62 6c 65 22 \n        0d 0a 61 69 72 74 75 63 6b 65 72 20 22 6e 6f 22 0d \n        0a 73 65 6c 76 61 67 65 20 22 77 69 74 68 6f 75 74 \n        22 0d 0a 73 65 6c 65 63 74 65 64 5f 69 64 20 20 30 \n        0d 0a 23 70 61 74 74 65 72 6e 5f 69 64 20 30 0d 0a \n        44 65 6e 73 69 74 79 55 6e 69 74 20 30 0d 0a 53 79 \n        6e 63 4d 6f 64 65 20 30 0d 0a 53 65 6c 76 61 67 65 \n        53 79 6e 63 4d 6f 64 65 20 31 30 30 30 0d 0a 55 73 \n        65 57 61 6b 75 20 36 35 35 33 35 0d 0a 53 65 6c 76 \n        61 67 65 41 73 79 6e 63 4e 75 6d 20 34 0d 0a 44 65 \n        6e 73 69 74 79 52 61 74 65 20 31 30 30 30 0d 0a 44 \n        65 6e 73 69 74 79 52 61 74 65 50 69 6c 65 20 31 30 \n        30 30 0d 0a 44 65 6e 73 69 74 79 52 61 74 65 42 6f \n        72 64 65 72 20 31 30 30 30 0d 0a 44 65 6e 73 69 74 \n        79 52 61 74 65 47 72 6f 75 6e 64 20 31 30 30 30 0d \n        0a 6c 69 6e 65 73 20 31 32 0d 0a 23 53 74 65 70 20 \n        43 6f 6c 6f 72 20 52 65 70 2e 20 44 65 6e 73 20 43 \n        66 63 20 42 6f 72 20 4f 72 69 20 50 69 6c 20 50 2d \n        4c 65 6e 20 41 76 65 20 53 68 65 20 54 2d 53 20 53 \n        65 6c 2e 20 54 75 63 6b 49 6e 20 53 74 72 4f 6e 20 \n        53 74 72 4f 66 66 0d 0a",n=Ld.innerText,l='"'+n+'"',i=mc((new TextEncoder).encode(l));t=t.replace(/\s+/g,""),t=t.replace("22436f6d62696e6174696f6e2d3122",i);let r="UseWaku "+(Math.pow(2,e)-1).toString();r="\r\n"+r+"\r\n";let a=mc((new TextEncoder).encode(r));t=t.replace("0d0a55736557616b752036353533350d0a",a);let[o,s,d]=(()=>{let e=DB.convert_new_index_to_numeric(!0),t="",n=DB.rows();console.log("weft color ",XB.cells),String(e).split("\n").forEach((e,l)=>{let i=String(e),r=GB.cells.find(e=>e.index==n-l-1),a=YB.cells.find(e=>e.index==n-l-1),o=XB.cells.find(e=>e.index==n-l-1);if(r){i+=" "+(String(r.color_code).charCodeAt(0)-65+31)}a&&(i+=" 30"),o&&(i+=" "+o.color_code),t+=i+"\n"}),t=iL(t.trim());let l=Mv(t),i="",r=1;for(let e=0;e<l.length;e++){let t=l[e].repeatedPart.split("\n"),n=l[e].outerRepeat;t.forEach((e,l)=>{let a="";a+=String(r).padStart(4,0),a+=" ";const o=e.trim().split(" ").at(-1);a+=Gs[o],a+=" ",1==n?a+="0":0==l?a+=n:l+1==t.length?a+="1000":a+="0",a+=" ";let s=hc(e,31);if(s){let e=10*Number(sd[s%31]);isNaN(e)&&(e="0"),a+=e+" "}else a+="0 ";a+="0 ",a+="0 ",a+="0 ",a+="0 ",a+="0 ",a+="0 ",a+="0 ",e.includes(30)?a+="1 ":a+="0 ",a+="0 ",a+="0 ",a+="0 ",a+="0 ",i+=a+"\r\n",r++})}return[i,r,l]})(),c="lines "+(s-1).toString();c="\r\n"+c+"\r\n";let u=mc((new TextEncoder).encode(c));t=t.replace("0d0a6c696e65732031320d0a",u);let m=o+("waku_lines "+(s-1)+"\r\n")+(e=>{let t=DB.cols(),n="",l=1;if(Array.isArray(e))for(let i=0;i<e.length;i++){String(e[i].repeatedPart).split("\n").forEach(e=>{let i="",r="",a=0;for(let n=0;n<t;n++)e.split(" ").includes(String(n+1))&&(r+="0",a+=Math.pow(2,n));i+=`${l.toString().padStart(4,0)} ${a}\r\n`,n+=i,l++})}return n})(d)+"#end_of_data\r\n";t+=mc((new TextEncoder).encode(m)),sc(function(e){let t=[];for(let n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t}(t),n+".pt7")},gc=e=>{if(!(e instanceof Uint8Array)||4!==e.length)throw new Error("Input must be a Uint8Array of length 4.");return new DataView(e.buffer).getInt32(0,!0)},fc=document.getElementById("upload-db1-file-trigger"),yc=document.getElementById("upload-db1-file-input"),vc=()=>{qc(),Cc.value="db1-profile",Hc({target:{value:Cc.value}},Cc.value)},bc=e=>{const t=hl.start,n=new Uint8Array(e);let l=(e=>{if(e instanceof Uint8Array){let t=e[0],n=e[1],l=Number(t).toString(2).padStart(8,"0")+Number(n).toString(2).padStart(8,"0");return parseInt(l,2)}})(n.slice(-2)),i="",r="",a=[],o=9!=t?31+t:31;for(let e=0;e<l;e++){let t=n.slice(5*e,5*(e+1)),s="",d="";for(let e=0;e<t.length;e++){if(e<4&&(s+=t[e].toString(2).padStart(8,"0").split("").reverse().join("")),4==e){let n=t[e].toString(2).padStart(8,"0").split("").reverse().findIndex(e=>Number(e));i+=String.fromCharCode(n+65)+"\n"}d+=t[e].toString(2).padStart(8,"0").split("").reverse().join("")}Number(d.at(o))&&a.push(new ci("A",l-e-1)),s=s.slice(0,28).split("").map((e,t)=>Number(e)?""+(t+1):"").filter(e=>e).join(" "),r+=s+"\n"}Zr("weft"),Yr.value=i,la(),ra.value=r.trim(),YB.cells=a,ca()},wc=e=>{const t=e.target.files[0];if(!t)return;nv();const n=new FileReader;n.onload=function(e){const t=e.target.result;bc(t)},n.onerror=function(e){console.error("Failed to read file: "+e.target.error.code)},n.readAsArrayBuffer(t)},Ec=document.getElementById("upload-wjl-file-trigger"),Ic=document.getElementById("upload-wjl-file-input"),Sc=()=>{qc(),Cc.value="chines-dobby",Hc({target:{value:Cc.value}},Cc.value)},kc=e=>{const t=e.target.files[0];if(!t)return;nv();const n=new FileReader;n.onload=function(e){(e=>{console.log("buffer",e);let t=pl.end,n=ml.start,l=ml.end,i=hl.start;const r=new Uint8Array(e);r.slice(0,8);let a=r[8],o=(r.slice(12,20),Array.apply(null,Array(a)).map((function(e,t){return{loop:"Loop"+(t+1),noOfPick:0,pegplanForCurrentLoop:"",repeat:0}}))),s=20;for(let e=0;e<a;e++){let t=r.slice(s,s+4);o[e].noOfPick=gc(t),s+=4}for(let e=0;e<a;e++){let t=r.slice(s,s+4);o[e].repeat=gc(t),s+=4}let d="",c=0,u=[],m="";if(Array.isArray(o)){o.forEach(e=>{let a="",o="";for(let d=0;d<e.noOfPick;d++){let d=r.slice(s,s+40).reverse().map((e,t)=>"1"==String.fromCharCode(e)?t+1:0).filter(e=>e),m=d.filter(e=>e<=t).join(" "),h=d.filter(e=>e>t);h.length>0?h.forEach(t=>{if(t>=n&&t<=l&&(o+=String.fromCharCode(t-n+65)+"\n",c+=1),t==i)for(let t=0;t<e.repeat;t++)u.push(new ci("A",c+t*e.noOfPick))}):(o+="A\n",c+=1),a+=m+"\n",s+=40}c+=e.noOfPick*(e.repeat-1),e.pegplanForCurrentLoop=a.trim(),m+=`[${o}]X${e.repeat}\n`,d+=`[${a}]X${e.repeat}\n`}),d=d.trim(),ra.value=d,DB.change_no_of_cols(t),ca();let e=YB.size;YB.cells=u.map(t=>({...t,index:e-t.index})),Zr("weft"),Yr.value=m,la(),hh(),Cm()}else vb("File is not valid")})(e.target.result)},n.onerror=function(e){console.error("Failed to read file: "+e.target.error.code)},n.readAsArrayBuffer(t)},xc=document.getElementById("select-loom-profile"),Tc=document.getElementById("loom-profile-modal-default"),_c=document.getElementById("loom-profile-modal-apply"),Bc=document.getElementById("loom-profile-modal-submit"),Lc=document.getElementById("no-of-hook"),Pc=document.getElementById("loom-profile-model"),Cc=document.getElementById("loom-type"),Nc=document.getElementById("loom-profile-table");let Rc="";const Ac=()=>{su(),$c()},Fc=e=>isNaN(e)?0:e,Mc=()=>{const e=document.getElementById("fidder-num"),t=document.getElementById("shaft-num"),n=document.getElementById("cramming-num"),l=document.getElementById("density-num");if(e){const t=document.getElementById("fidder-start"),n=document.getElementById("fidder-end");e.value=Fc(Number(n.value)-Number(t.value)+1)}if(t){const e=document.getElementById("shaft-start"),n=document.getElementById("shaft-end");t.value=Fc(Number(n.value)-Number(e.value)+1)}if(n){const e=document.getElementById("cramming-start"),t=document.getElementById("cramming-end");n.value=Fc(Number(t.value)-Number(e.value)+1)}if(l){const e=document.getElementById("density-start"),t=document.getElementById("density-end");l.value=Fc(Number(t.value)-Number(e.value)+1)}},Oc=()=>{ml.start=0,ml.end=0,hl.start=0,hl.end=0,pl.start=0,pl.end=0,gl.start=0,gl.end=0;const e=document.getElementById("fidder-start"),t=document.getElementById("fidder-end"),n=document.getElementById("cramming-start"),l=document.getElementById("cramming-end"),i=document.getElementById("shaft-start"),r=document.getElementById("shaft-end"),a=document.getElementById("density-start"),o=document.getElementById("density-end");e&&t&&(ml.start=Number(e.value),ml.end=Number(t.value)),n&&l&&(hl.start=Number(n.value),hl.end=Number(l.value)),i&&r&&(pl.start=Number(i.value),pl.end=Number(r.value)),a&&o&&(gl.start=Number(a.value),gl.end=Number(o.value)),Dc()},Dc=()=>{["rapier-manual-dobby","none"].includes(Cc.value)?(po.classList.add("list-disable"),di(!1)):(po.classList.remove("list-disable"),di(!0))},Wc=()=>{Oc(),"chines-dobby"==Rc&&Ic.click(),"db1-profile"==Rc&&yc.click(),$c()},Hc=(e,t="")=>{t&&(Rc=t);let n=_l.find(t=>t.loomTypeValue==e.target.value),l=["airjet-dobby","rifa"].includes(e.target.value),i=["airjet-dobby","rifa","rapier-manual-dobby","chines-dobby","action-cad","spactrum","db1-profile","bnx-profile"].includes(e.target.value);if(Nc.innerHTML="",console.log("current loom profiuke",n),n){let e=n.visibleRow;if(Lc.value=n.noOfHook,e.length>0){let t="";e.forEach(e=>{t+=` <tr><td><input ${l?"readonly":""} type="number" min="0" id="${e.toLowerCase()}-start" /></td>\n            <td><input ${l?"readonly":""} type="number" min="0" id="${e.toLowerCase()}-end" /></td>\n            <td><input ${l?"readonly":""} type="number" min="0" id="${e.toLowerCase()}-num" readonly/></td>\n            <td>\n           ${e}\n            </td></tr>`});let r=`<tr>\n            <th>Start</th>\n            <th>End</th>\n            <th>Num</th>\n            <th>Description</th></tr>${t}\n          `;Nc.innerHTML=r,i&&Object.keys(n.tableData).forEach(e=>{document.getElementById(e).value=n.tableData[e]}),l||e.forEach(e=>{document.getElementById(e.toLowerCase()+"-start").addEventListener("change",Mc),document.getElementById(e.toLowerCase()+"-end").addEventListener("change",Mc)})}}},$c=()=>{Ol(""),Pc.style.display="none",Rc=""},qc=()=>{nv(),Ol("loom-profile-model"),Pc.style.display="block",Pc.style.animation="slide-down 0.3s ease"},jc=document.getElementById("checkbox-skipped-dent"),Vc=document.getElementById("checkbox-function"),zc=document.getElementById("checkbox-extrawarp"),Uc=document.getElementById("checkbox-draft-visibility"),Yc=document.getElementById("checkbox-reed"),Jc=document.getElementById("checkbox-pegplan-visibility"),Gc=document.getElementById("checkbox-density"),Xc=document.getElementById("checkbox-doublebeam"),Kc=document.getElementById("checkbox-tieupmode"),Zc=(document.getElementById("checkbox-maindesign"),document.getElementById("form-color-panel")),Qc=document.getElementById("checkbox-color-palette"),eu=(document.getElementById("checkbox-direct-drawing"),document.getElementById("checkbox-drawing-toolbar"),document.getElementById("checkbox-weft-color")),tu=document.getElementById("checkbox-warp-color");let nu=!0;const lu=e=>{gm(),du("isDraftPlanVisible",Xu)},iu=()=>{fm(),du("isPegplanVisible",Ku)},ru=()=>{nu=!nu,console.log("isReed visible",nu),nu?(jc.disabled=!1,ih.style.display="flex"):(jc.disabled=!0,ih.style.display="none"),Dm(),rI(),du("isReedVisibible",nu)},au=()=>{console.log("part init isDraftPlanVisible",Nl),Qc.checked=il,zc.checked=Qn,eu.checked=ol,tu.checked=rl,Xc.checked=Gn,Kc.checked=Xn,Vc.checked=Zn,Hm.style.display=Zn?"block":"none",$m.style.display=el?"block":"none",Or.style.display=Qn?"flex":"none",Cr.style.display=rl?"block":"none",Gm.style.display=ol?"block":"none",qu.style.display=Xu?"block":"none",Nw.style.display=Ku?"block":"none",Uc.checked=Xu,Jc.checked=Ku,Gc.checked=el,jc.checked=Nl,Sh.style.display=Nl?"flex":"none",jc.disabled=!nu,Yc.checked=nu,Xi.style.display=Gn?"block":"none",ih.style.display=nu?"flex":"none",Zc.style.display=il?"flex":"none",jE.style.display=ll?"block":"none",Gc.addEventListener("change",()=>{el=!el,$m.style.display=el?"block":"none",rI(),du("isDensityCanvasVisible",el)}),Kc.addEventListener("change",e=>{var t;t=e.target.checked,Xn=t,RB.readOnly=!Xn,console.log("tie up mod value is",Xn),DB.is_not_empty()?(HB.convert_to_tieupmode(FB,DB,AB,Xn,ra.value),Xn&&(RB.value=HB.cols())):(RB.value=HB.cols(),HB.reset(HB.cols(),HB.rows(),Rl)),Dm(),CE(),rI()}),Vc.addEventListener("change",()=>{Zn=!Zn,Hm.style.display=Zn?"block":"none",rI(),du("isFunctionCanvasVisible",Zn)}),zc.addEventListener("change",()=>{Qn=!Qn,Or.style.display=Qn?"flex":"none",rI(),du("isExtraWarpCanvasVisible",Qn)}),jc.addEventListener("click",()=>{Wy()}),Xc.addEventListener("click",()=>{Dy()}),Uc.addEventListener("change",lu),Jc.addEventListener("change",iu),Yc.addEventListener("change",ru),eu.addEventListener("click",()=>{Hl(!ol),du("isWeftColorVisible",ol),Gm.style.display=ol?"block":"none",rI()}),tu.addEventListener("click",()=>{Wl(!rl),du("isWarpColorVisible",rl),Cr.style.display=rl?"block":"none",rI()}),Qc.addEventListener("click",()=>{il=!il,Zc.style.display=il?"flex":"none",rI(),du("isColorPalletVisible",il)})},ou={CURRENT_LOOM_PROFILE:"currentLoomProfile",VISIBILITY_OBJECT:"visibilityObject",RECENT_FILE:"recentFiles",PRINT_SETTINGS:"printSettings"},su=()=>{let e=Cc.value,t=_l.find(t=>t.loomTypeValue==e);if(t){let e={...t};e.visibleRow.forEach(t=>{let n=document.getElementById(t.toLowerCase()+"-start"),l=document.getElementById(t.toLowerCase()+"-end"),i=document.getElementById(t.toLowerCase()+"-num");e.tableData[t.toLowerCase()+"-start"]=n.value,e.tableData[t.toLowerCase()+"-end"]=l.value,e.tableData[t.toLowerCase()+"-num"]=i.value}),localStorage.setItem(ou.CURRENT_LOOM_PROFILE,JSON.stringify(e))}},du=(e,t)=>{let n=localStorage.getItem("visibilityObject");if(n){let l=JSON.parse(n);l[e]=t,localStorage.setItem("visibilityObject",JSON.stringify(l))}else{let n={[e]:t};localStorage.setItem("visibilityObject",JSON.stringify(n))}},cu=(e,t)=>{let n=localStorage.getItem("printSettings");if(n){let l=JSON.parse(n);l[e]=t,localStorage.setItem("printSettings",JSON.stringify(l))}else{let n={[e]:t};localStorage.setItem("printSettings",JSON.stringify(n))}},uu=()=>{let e=localStorage.getItem(ou.CURRENT_LOOM_PROFILE);if(e){let t=JSON.parse(e);Cc.value=t.loomTypeValue,Lc.value=t.noOfHook;let n=t.visibleRow;if(n.length>0){let e="";n.forEach(t=>{e+=`<tr><td><input type="number" min="0" id="${t.toLowerCase()}-start" /></td>\n            <td><input type="number" min="0" id="${t.toLowerCase()}-end" /></td>\n            <td><input type="number" min="0" id="${t.toLowerCase()}-num" readonly/></td>\n            <td>\n           ${t}\n            </td></tr>`});let l=`<tr>\n        <th>Start</th>\n        <th>End</th>\n        <th>Num</th>\n        <th>Description</th></tr>${e}\n      `;Nc.innerHTML=l,n.forEach(e=>{document.getElementById(e.toLowerCase()+"-start").addEventListener("change",Mc),document.getElementById(e.toLowerCase()+"-end").addEventListener("change",Mc)}),t.tableData&&Object.keys(t.tableData).length>0&&Object.keys(t.tableData).forEach(e=>{document.getElementById(""+e).value=t.tableData[e]})}}else localStorage.setItem(ou.CURRENT_LOOM_PROFILE,JSON.stringify({loomTypeValue:"none",loomTypeName:"None",noOfHook:0,tableData:{},visibleRow:[]}));Dc();let t=localStorage.getItem(ou.VISIBILITY_OBJECT);if(t){let e=JSON.parse(t);e&&("isDraftPlanVisible"in e&&mm(e.isDraftPlanVisible),"isPegplanVisible"in e&&hm(e.isPegplanVisible),"isDentClickCanvasVisible"in e&&(n=e.isDentClickCanvasVisible,Nl=n),"isReedVisibible"in e&&(e=>{nu=e})(e.isReedVisibible),"isFunctionCanvasVisible"in e&&$l(e.isFunctionCanvasVisible),"isExtraWarpCanvasVisible"in e&&ql(e.isExtraWarpCanvasVisible),"isDensityCanvasVisible"in e&&jl(e.isDensityCanvasVisible),"isBeamVisible"in e&&Dl(e.isBeamVisible),"isColorPalletVisible"in e&&(e=>{il=e})(e.isColorPalletVisible),"isRulerCanvasVisible"in e&&(e=>{Cl=e})(e.isRulerCanvasVisible),"isScrollBarVisible"in e&&zl(e.isScrollBarVisible),"isWeftColorVisible"in e&&Hl(e.isWeftColorVisible),"isWarpColorVisible"in e&&Wl(e.isWarpColorVisible),"isDirectDrawingEnabled"in e&&(e=>{al=e})(e.isDirectDrawingEnabled))}var n},mu=e=>{if(!e.includes("rgb"))return e;const[t,n,l]=e.slice(4,-1).split(","),i=`#${Number(t).toString(16).padStart(2,"0")}${Number(n).toString(16).padStart(2,"0")}${Number(l).toString(16).padStart(2,"0")}`;return console.log("hexcolor us",i.toUpperCase()),i.toUpperCase()};function hu(e,t){let n,l,i;return e.startsWith("#")?[n,l,i]=(e=>e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,n,l)=>"#"+t+t+n+n+l+l).substring(1).match(/.{2}/g).map(e=>parseInt(e,16)))(e):[n,l,i]=e.match(/\d+/g).map(Number),e.startsWith("#")?function(e,t,n){return"#"+((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}(n,l,i):`rgb(${n}, ${l}, ${i})`}function pu(e){const t=e.replace("matrix(","").replace(")","").split(",").map(parseFloat);if(6===t.length){const e=t[0],n=t[3];return console.log("scale x and scale y is",e,n),{scaleX:e,scaleY:n}}return{scaleX:1,scaleY:1}}const gu=0,fu=1,yu=2,vu=3,bu=4,wu=5,Eu=document.getElementById("selection-tool"),Iu=document.getElementById("tools-pencil"),Su=document.getElementById("tools-line"),ku="pencil",xu="selection",Tu="line",_u={TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right",TOP_RIGHT:"topright",TOP_LEFT:"topleft",BOTTOM_RIGHT:"bottomright",BOTTOM_LEFT:"bottomleft"},Bu="draw",Lu="erase",Pu="draw",Cu="erase",Nu="default",Ru="crosshair",Au="crosshair";let Fu=ku;const Mu=e=>{console.log("selected tools is",e),Fu=e,e==Tu?(Iu.parentElement.style.backgroundColor="white",Eu.parentElement.style.backgroundColor="white",Su.parentElement.style.backgroundColor="#d2cbcba6"):e==ku?(Su.parentElement.style.backgroundColor="white",Eu.parentElement.style.backgroundColor="white",Iu.parentElement.style.backgroundColor="#d2cbcba6",console.log("pencil parent element is",Iu.parentElement)):e==xu&&(Su.parentElement.style.backgroundColor="white",Iu.parentElement.style.backgroundColor="white",Eu.parentElement.style.backgroundColor="#d2cbcba6")},Ou=e=>{Mu(xu),document.body.style.cursor=Ru},Du=e=>{Mu(Tu),document.body.style.cursor=Au},Wu=e=>{console.log("pencil click called"),Mu(ku),document.body.style.cursor=Nu},Hu=document.getElementById("weft-canvas"),$u=Hu.getContext("2d"),qu=document.getElementById("weftSubParent"),ju=document.getElementById("weft-scale-container"),Vu=document.getElementById("edit-design-from-draft");let zu,Uu,Yu,Ju,Gu,Xu=!0,Ku=!0,Zu=!1,Qu=!1,em=null,tm=[],nm=[],lm=[],im=[],rm=[],am=!1,om=!1,sm=!1,dm=[],cm=null,um=Il;const mm=e=>{Xu=e},hm=e=>{Ku=e},pm=e=>{um=e;let t=document.getElementById(e);t&&(t.checked=!0)},gm=()=>{Xu=!Xu,Xu?(qu.style.display="block",Ku?(YE.style.display="block",Dm()):YE.style.display="none",rI()):(qu.style.display="none",YE.style.display="none",rI())},fm=()=>{Ku=!Ku,Ku?(Nw.style.display="block",YE.style.display=Xu?"block":"none",rI()):(Nw.style.display="none",YE.style.display="none",rI())},ym=e=>{const t=Hu.getBoundingClientRect(),n=FB.cell_size(),l=FB.cols(),i=FB.rows(),r=(e.clientX-t.left)%(l*n),a=e.clientY-t.top,o=parseInt(r/n)+qn.startColumn,s=i-parseInt(a/n)-1;if(!Gu){let e=FB.check_if_index_exist_or_not(o%l,s);Gu=e?Cu:Pu}Gu==Pu?(FB.add_cell_new(s,o%l,AB,DB,HB),Cm()):Gu==Cu&&(FB.remove_cell_new(o%l,AB),Cm())},vm=e=>{if(!Mn)return void(e=>{FB.cols();const t=FB.rows(),n=FB.cell_size(),l=On,i=Dn;if(Array.isArray(e))for(let r=0;r<e.length;r++){$u.clearRect(e[r]*n,0,n,Hu.height),$u.fillStyle="white",$u.fillRect(e[r]*n,0,n,Hu.height);for(let a=0;a<t+1;a++)$u.beginPath(),$u.strokeStyle="grey",$u.moveTo(l+e[r]*n,i+a*n),$u.lineTo(l+e[r]*n+n,i+a*n),$u.lineWidth=(t-a)%Hn==0?1.5:.5,$u.stroke(),$u.closePath();for(let a=0;a<2;a++)$u.beginPath(),$u.strokeStyle="grey",$u.moveTo(l+e[r]*n+a*n,i),$u.lineTo(l+e[r]*n+a*n,i+t*n),$u.lineWidth=(e[r]+a)%Wn==0?1.5:.5,$u.stroke(),$u.closePath();const a=FB.get_cell_from_col(e[r]);0!=a&&($u.fillStyle="black",$u.fillRect(e[r]*n,(t-a)*n,n,n))}vI(e)})(e);const t=FB.cols(),n=FB.rows(),l=FB.cell_size(),i=On,r=Dn,a=document.createElement("canvas");a.width=t*l,a.height=n*l;const o=a.getContext("2d"),s=$u.getImageData(0,Hu.height-a.height,a.width,a.height);if(o.putImageData(s,0,0),Array.isArray(e))for(let t=0;t<e.length;t++){o.clearRect(e[t]*l,0,l,a.height),o.fillStyle="white",o.fillRect(e[t]*l,0,l,a.height);for(let a=0;a<n+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i+e[t]*l,r+a*l),o.lineTo(i+e[t]*l+l,r+a*l),o.lineWidth=(n-a)%Hn==0?1.5:.5,o.stroke(),o.closePath();for(let a=0;a<2;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i+e[t]*l+a*l,r),o.lineTo(i+e[t]*l+a*l,r+n*l),o.lineWidth=(e[t]+a)%Wn==0?1.5:.5,o.stroke(),o.closePath();const s=FB.get_cell_from_col(e[t]);0!=s&&(o.fillStyle="black",o.fillRect(e[t]*l,(n-s)*l,l,l))}Hu.height=a.height,Hu.width=a.width*zn;const d=$u.createPattern(a,"repeat");$u.rect(0,0,Hu.width,Hu.height),$u.fillStyle=d,$u.fill(),qu.style.height=Hu.height+"px",vI(e)},bm=e=>{if(Fu==ku)return void(Gu=null);Qu=!1,Gu=null;let t=FB.rows(),n=FB.cols();rm.forEach(e=>{FB.add_cell_new(t-parseInt(e/n)-1,e%n,AB,DB,HB)}),rm=[],Ml(!1),Wm(),Yu=null};const wm=e=>{if(um!=El)if(Fu==Tu&&Qu){const a=Hu.getBoundingClientRect(),o=FB.cell_size(),s=FB.cols(),d=(e.clientX-a.left)%(s*o),c=e.clientY-a.top,u=parseInt(Yu.x/o),m=parseInt(Yu.y/o),h=u+m*s;let p=parseInt(d/o),g=parseInt(c/o);const f=(t=Yu.x,n=Yu.y,l=d,i=c,(r=(Math.atan2(i-n,l-t)*(180/Math.PI)+360)%360)<0&&(r+=360),r=360-r,[_u.RIGHT,_u.TOP_RIGHT,_u.TOP,_u.TOP_LEFT,_u.LEFT,_u.BOTTOM_LEFT,_u.BOTTOM,_u.BOTTOM_RIGHT][Math.round(r/45)%8]);if(f==_u.RIGHT){g=m;let e=p+g*s;rm=[];for(let t=h;t<=e;t++)rm.push(t)}else if(f==_u.LEFT){g=m;let e=p+g*s;rm=[];for(let t=h;t>=e;t--)rm.push(t)}else if(f==_u.TOP);else if(f==_u.BOTTOM);else if(f==_u.TOP_RIGHT){let e=m,t=u;rm=[];for(;e>=g&&t<=p;e--)rm.push(t+e*s),t++}else if(f==_u.TOP_LEFT){let e=m,t=u;rm=[];for(;e>=g&&t>=p;e--)rm.push(t+e*s),t--}else if(f==_u.BOTTOM_LEFT){let e=m,t=u;rm=[];for(;e<=g&&t>=p;e++)rm.push(t+e*s),t--}else if(f==_u.BOTTOM_RIGHT){let e=m,t=u;rm=[];for(;e<=g&&t<=p;e++)rm.push(t+e*s),t++}Wm()}else{var t,n,l,i,r;Ll&&jn==$n&&ym(e),oI(Xl,e)}},Em=e=>{if(Fu==xu){if(e.ctrlKey&&"KeyE"==e.code){e.preventDefault();let t=Number(Uu.select(".selection").attr("x")),n=Number(Uu.select(".selection").attr("y")),l=[],i=FB.rows();for(let e=0;e<tm.length;e++){let r=(tm[e].y+n)/Rl,a=(tm[e].x+t+qu.scrollLeft)/Rl;r=i-r-1,FB.add_cell_new(r,a,AB,DB,HB),l.push(a)}vm(l),Am()}e.altKey&&Im(!om),e.shiftKey&&(sm=!0),"Escape"==e.code&&Am()}},Im=e=>{om=e,om?Uu.select(".selection").style("cursor","grab"):Uu.select(".selection").style("cursor","move")},Sm=e=>{"Shift"==e.key&&(sm=!1)},km=e=>{if(Fu!=xu);else if(!Zu){Zu=!0;d3.select("#weftSubParent").node();let t=Uu.select("#weft-canvas-brush-svg").style("z-index","1").style("width",Hu.width+"px").style("height",Hu.height+"px").style("pointer-events","all");const n=new MouseEvent("mousedown",e);t.select("rect.overlay").node().dispatchEvent(n)}},xm=e=>{if(um!=El){if(Fu==Tu&&!Qu){Qu=!0;const t=Hu.getBoundingClientRect(),n=FB.cols(),l=FB.cell_size(),i=(e.clientX-t.left)%(n*l),r=e.clientY-t.top;Yu={x:i,y:r}}if(Fu==ku){if(Gb(Ub.NONE),0==e.button&&e.ctrlKey&&!Xn){const t=FB.cell_size(),n=getComputedStyle(Hu),l=Hu.getBoundingClientRect(),i=pu(n.getPropertyValue("transform")).scaleX,r=FB.rows();if(r>=40)return void vb("Maxium 40 shaft allowed");const a=FB.cols(),o=(e.clientX-l.left)%(a*t),s=e.clientY-l.top,d=parseInt(o/i/t),c=r-parseInt(s/i/t)-1;return console.log("reach row and reach col is",c,d),console.log("eveee",e),e.shiftKey?FB.remove_row(c,AB,DB,HB):FB.add_row(c,AB,DB,HB),Ef.value=FB.rows(),ry(),eL(),void rI()}if(0==e.button&&e.altKey&&!Xn){const t=FB.cell_size(),n=getComputedStyle(Hu),l=Hu.getBoundingClientRect(),i=pu(n.getPropertyValue("transform")).scaleX,r=(FB.rows(),FB.cols()),a=(e.clientX-l.left)%(r*t),o=(e.clientY,l.top,qn.startColumn+parseInt(a/i/t));return console.log("reach cols",o),e.shiftKey?(FB.remove_col(o,AB,DB,HB,WB,ZB),console.log("warpColorGridInstance",KB),KB.remove_cell(o),JB.remove_cell(o),console.log("after remiove",KB,JB)):(FB.add_col(o,AB,DB,HB,WB,ZB),KB.add_cell(o),JB.add_cell(o)),$f.value=FB.cols(),ry(),eL(),void rI()}0==e.button&&jn==$n&&(Ml(!0),ym(e))}}},Tm=e=>{const t=GE.getBoundingClientRect(),n=1*AB.width(),l=Rl,i=HB.rows(),r=HB.cols(),a=e.clientX-t.left,o=(e.clientY-t.top)%(i*l),s=i-parseInt(o/l)-1;let d=parseInt(a/n);d>=r&&(d=r-1),HB.add_cell(AB,FB,DB,s,d),CE(),Wm()},_m=e=>{0==e.button&&Xn&&Fu==ku&&(Ml(!0),Tm(e))},Bm=e=>{if(Ll&&Xn&&Fu==ku&&Tm(e),!Xn){const t=1*AB.width(),n=Rl,l=(HB.cols(),HB.rows()),i=GE.getBoundingClientRect(),r=e.clientX-i.left,a=e.clientY-i.top,o=parseInt(a/n),s=parseInt(r/t);let d=o;(o>l-1||s>l-o-1)&&(d=l-s),em={reachRow:d},Dm()}},Lm=()=>{Ml(!1)},Pm=()=>{Xn||(em=null,Dm())},Cm=()=>{const e=FB.cols(),t=qn.startColumn,n=qn.endColumn;let l=e*Rl*(Mn?zn:1);UE.style.width=l+"px";const i=FB.get_visible_cells(t,Mn?n:Math.min(n,e-1),Mn),r=bb(i)?JSON.parse(i):[],a=Mn?n-t+1:Math.min(n-t+1,e),o=FB.rows(),s=FB.cell_size(),d=document.createElement("canvas");d.height=s*o,d.width=s*a;const c=d.getContext("2d");if(c.clearRect(0,0,d.width,d.height),c.fillStyle="white",c.fillRect(0,0,d.width,d.height),c.fillStyle="black",Array.isArray(r)&&r.length>0){if(r.forEach((e,t)=>{0!=e&&c.fillRect(t*s,(o-e)*s,s,s)}),Bl==sl){for(let e=0;e<a+1;e++)c.beginPath(),c.strokeStyle="grey",c.moveTo(e*s,0),c.lineTo(e*s,o*s),c.lineWidth=(e+t)%Wn==0?1.5:.5,c.stroke(),c.closePath();for(let e=0;e<o+1;e++)c.beginPath(),c.strokeStyle="grey",c.moveTo(0,e*s),c.lineTo(a*s,e*s),c.lineWidth=(o-e)%Hn==0?1.5:.5,c.stroke(),c.closePath()}else if(Bl==dl){c.lineWidth=.5;for(let e=0;e<a+1;e++)c.beginPath(),c.strokeStyle="grey",c.moveTo(e*s,0),c.lineTo(e*s,o*s),c.stroke(),c.closePath();for(let e=0;e<o+1;e++)c.beginPath(),c.strokeStyle="grey",c.moveTo(0,e*s),c.lineTo(a*s,e*s),c.stroke(),c.closePath()}else if(Bl==cl){c.lineWidth=1.5;for(let e=0;e<a+1;e++)(e+t)%Wn==0&&(c.beginPath(),c.strokeStyle="grey",c.moveTo(e*s,0),c.lineTo(e*s,o*s),c.stroke(),c.closePath());for(let e=0;e<o+1;e++)(o-e)%Hn==0&&(c.beginPath(),c.strokeStyle="grey",c.moveTo(0,e*s),c.lineTo(0+a*s,e*s),c.stroke(),c.closePath())}else{c.lineWidth=1.5;for(let e=0;e<a+1;e+=a)c.beginPath(),c.strokeStyle="grey",c.moveTo(e*s,0),c.lineTo(e*s,o*s),c.stroke(),c.closePath();for(let e=0;e<o+1;e+=o)(o-e)%Hn==0&&(c.beginPath(),c.strokeStyle="grey",c.moveTo(0,e*s),c.lineTo(a*s,e*s),c.stroke(),c.closePath())}c.closePath(),qu.style.height=d.height+"px",Hu.width=d.width,Hu.height=d.height,$u.clearRect(0,0,Hu.width,Hu.height),$u.drawImage(d,0,0)}Bh(),Dr(),Wr(),dI()},Nm=()=>{sy(Xl)},Rm=e=>{if(e.selection)if("handle"===e.mode){let[[t,n],[l,i]]=e.selection;if(cm||(e=>{(e.sourceEvent.srcElement.classList.value.includes("--ne")||e.sourceEvent.srcElement.classList.value.includes("--se")||e.sourceEvent.srcElement.classList.value.includes("--sw")||e.sourceEvent.srcElement.classList.value.includes("--nw")||e.sourceEvent.srcElement.classList.value.includes("--s")||e.sourceEvent.srcElement.classList.value.includes("--n")||e.sourceEvent.srcElement.classList.value.includes("--w")||e.sourceEvent.srcElement.classList.value.includes("--e"))&&(e.sourceEvent.srcElement.classList.value.includes("--ne")?cm=_u.TOP_RIGHT:e.sourceEvent.srcElement.classList.value.includes("--se")?cm=_u.BOTTOM_RIGHT:e.sourceEvent.srcElement.classList.value.includes("--sw")?cm=_u.BOTTOM_LEFT:e.sourceEvent.srcElement.classList.value.includes("--nw")?cm=_u.TOP_LEFT:e.sourceEvent.srcElement.classList.value.includes("--s")?cm=_u.BOTTOM:e.sourceEvent.srcElement.classList.value.includes("--n")?cm=_u.TOP:e.sourceEvent.srcElement.classList.value.includes("--w")?cm=_u.LEFT:e.sourceEvent.srcElement.classList.value.includes("--e")&&(cm=_u.RIGHT))})(e),nm.length>0)if(sm){const[[e,r],[a,o]]=nm;if([_u.TOP].includes(cm))n-=n%Rl,Uu.select("#weft-canvas-brush-svg").call(zu.move,[[e,n],[a,o]]);else if([_u.BOTTOM].includes(cm))i+=Rl-i%Rl,Uu.select("#weft-canvas-brush-svg").call(zu.move,[[e,r],[a,i]]);else if([_u.RIGHT].includes(cm))l+=Rl-l%Rl,Uu.select("#weft-canvas-brush-svg").call(zu.move,[[e,r],[l,o]]);else if([_u.LEFT].includes(cm))t-=t%Rl,Uu.select("#weft-canvas-brush-svg").call(zu.move,[[t,r],[a,o]]);else if([_u.TOP_RIGHT].includes(cm)){Math.abs(a-l)>=Math.abs(r-n)?(l+=Rl-l%Rl,n=r+(a-l)):(n-=n%Rl,l=a+(r-n)),Uu.select("#weft-canvas-brush-svg").call(zu.move,[[e,n],[l,o]])}else if([_u.TOP_LEFT].includes(cm)){Math.abs(e-t)>=Math.abs(r-n)?(t-=t%Rl,n=r-(e-t)):(n-=n%Rl,t=e-(r-n)),Uu.select("#weft-canvas-brush-svg").call(zu.move,[[t,n],[a,o]])}else if([_u.BOTTOM_LEFT].includes(cm)){Math.abs(e-t)>=Math.abs(o-i)?(t-=t%Rl,i=o+(e-t)):(i+=Rl-i%Rl,t=e+(o-i)),Uu.select("#weft-canvas-brush-svg").call(zu.move,[[t,r],[a,i]])}else if([_u.BOTTOM_RIGHT].includes(cm)){Math.abs(a-l)>=Math.abs(o-i)?(l+=Rl-l%Rl,i=o-(a-l)):(i+=Rl-i%Rl,l=a-(o-i)),Uu.select("#weft-canvas-brush-svg").call(zu.move,[[e,r],[l,i]])}else[_u.BOTTOM_LEFT,_u.BOTTOM_RIGHT,_u.TOP_LEFT,_u.TOP_RIGHT].includes(cm)&&(t-=t%Rl,n-=n%Rl,l+=Rl-l%Rl,i+=Rl-i%Rl)}else t=Math.round(t/Rl)*Rl,n=Math.round(n/Rl)*Rl,l=Math.round(l/Rl)*Rl,i=Math.round(i/Rl)*Rl,Uu.select("#weft-canvas-brush-svg").call(zu.move,[[t,n],[l,i]]);else{t-=t%Rl,n-=n%Rl,l+=Rl-l%Rl,i+=Rl-i%Rl;for(let e=0;e<dm.length;e++)dm[e].classList.add("crosshair-cursor");Uu.select("#weft-canvas-brush-svg").call(zu.move,[[t,n],[l,i]])}}else if("drag"===e.mode){let[[t,n],[l,i]]=e.selection;t-=t%Rl,n-=n%Rl,l+=Rl-l%Rl,i+=Rl-i%Rl;let[[r,a],[o,s]]=nm,d=o-r,c=s-a;if(Uu.select("#weft-canvas-brush-svg").call(zu.move,[[t,n],[t+d,n+c]]),om){am=!0;Math.ceil(nm[0][0]/1),Math.ceil(nm[0][1]/1),Math.ceil(t/1),Math.ceil(n/1);Uu.selectAll(".selected-square").remove(),tm.forEach(e=>{Uu.select("#weft-canvas-brush-svg").append("rect").attr("class","selected-square").attr("x",e.x+t).attr("y",e.y+n).attr("width",Rl).attr("height",Rl).style("fill","yellow")}),Wm()}else am&&Uu.select("#weft-canvas-brush-svg").call(zu.move,lm)}},Am=()=>{Zu=!1,am=!1,Im(!1),Uu.select("#weft-canvas-brush-svg").style("z-index","-1").call(zu.move,[[0,0],[0,0]]),nm=[],im=[],tm=[],Uu.selectAll(".selected-square").remove(),Wm()},Fm=e=>{let[[t,n],[l,i]]=e;const r=new Uint32Array(aL.memory.buffer,FB.cells(),FB.selected_weftgrid_length());console.log("assignBrushDraftSelectedData",r,t,n);let a=[];for(let e=0;e<r.length;e++){if(0==r[e])continue;let o=e*Rl,s=(FB.rows()-r[e])*Rl;t<=o&&o<l&&n<=s&&s<i&&a.push({x:Math.abs(o-t),y:Math.abs(s-n)})}console.log("selected nodes i",a),tm=JSON.parse(JSON.stringify(a))},Mm=()=>{Uu=d3.select(Hu.parentElement),zu=d3.brush().keyModifiers(!1).extent([[0,0],[Hu.width,Hu.height]]).on("start",e=>(e=>{if("handle"==e.mode){const t=Hu.getBoundingClientRect();Ju=[e.sourceEvent.clientX-t.left,e.sourceEvent.clientY-t.top],Ju=[(e.selection[0][0]+e.selection[1][0])/2,(e.selection[0][1]+e.selection[1][1])/2]}})(e)).on("brush",e=>Rm(e)).on("end",e=>(e=>{if(!e.selection)return void Am();let[[t,n],[l,i]]=e.selection;if(cm=null,"handle"===e.mode){Fm([[t,n],[l,i]]),Uu.select("#weft-canvas-brush-svg").call(zu.move,[[t,n],[l,i]]);for(let e=0;e<dm.length;e++)dm[e].classList.remove("crosshair-cursor");nm=[[t,n],[l,i]],lm=[[t,n],[l,i]]}"drag"==e.mode&&(om||(Fm([[t,n],[l,i]]),nm=[[t,n],[l,i]]),lm=[[t,n],[l,i]])})(e)).filter(e=>"contextmenu"!=e.type);const e=Uu.select("#weft-canvas-brush-svg");e.call(zu),Hu.removeEventListener("mousedown",km),Hu.addEventListener("mousedown",km),e.on("contextmenu",e=>{Am()}),dm=qu.getElementsByTagName("rect")},Om=()=>{Hu.addEventListener("mousedown",xm),Hu.addEventListener("mouseup",bm),Hu.addEventListener("mousemove",wm),Hu.addEventListener("mouseleave",gI),GE.addEventListener("mousedown",_m),GE.addEventListener("mousemove",Bm),GE.addEventListener("mouseup",Lm),GE.addEventListener("mouseout",Pm),document.addEventListener("keydown",Em),document.addEventListener("keyup",Sm),(()=>{const e=document.getElementById("wsInsert-warp-trigger"),t=document.getElementById("wsInsert-shafts-trigger"),n=document.getElementById("wsInsert-warp-modal"),l=document.getElementById("wsInsert-shafts-modal"),i=(document.querySelectorAll(".close-button"),document.querySelectorAll(".btn-cancel"));fo(e,n,0,i,"Insert Warp"),fo(t,l,0,i,"Insert Shaft"),fo(Vu,Ka,0,i,"Edit File")})(),Vu.addEventListener("click",Nm)},Dm=()=>{const e=HB.rows(),t=HB.cols(),n=Xn?WE.offsetHeight:VE.offsetHeight;YE.style.height=n+"px",YE.style.width=Aw.width+4+"px",GE.height=""+n,GE.width=""+(Aw.width+4),XE.fillStyle="#f0f0f0",XE.fillRect(0,0,GE.width,GE.height),XE.fillStyle="black";const l=Rl,i=Rl;if(Xn){for(let n=0;n<t+1;n++)XE.beginPath(),XE.strokeStyle="grey",XE.moveTo(0+n*l,0),XE.lineTo(0+n*l,0+e*l),XE.lineWidth=n%Wn==0?1.5:.5,XE.stroke(),XE.closePath();for(let n=0;n<e+1;n++)XE.beginPath(),XE.strokeStyle="grey",XE.moveTo(0,0+n*i),XE.lineTo(0+t*i,0+n*i),XE.lineWidth=(e-n)%Hn==0?1.5:.5,XE.stroke(),XE.closePath();for(let n=0;n<t;n++){new Uint32Array(aL.memory.buffer,HB.cells(n),HB.selected_col_cell_length(n)).forEach(t=>{XE.fillRect(n*l,(e-t)*i,l,i)})}}else{for(let n=0;n<e;n++)XE.beginPath(),XE.strokeStyle=(em&&em.reachRow)==n?"red":"black",XE.moveTo(0,n*i+i/2),XE.lineTo(t*l-n*l-l/2+4-1,n*i+i/2),XE.moveTo(t*l-n*l-l/2+4,n*i+i/2-.5),XE.lineTo(t*l-n*l-l/2+4,n*i+i/2+VE.offsetHeight),XE.lineWidth=(em&&em.reachRow)==n?1.5:.5,XE.stroke(),XE.closePath();for(let e=0;e<t;e++);}Xu&&Ku||(YE.style.display="none")},Wm=()=>{const e=FB.cols(),t=FB.rows(),n=FB.cell_size(),l=On,i=Dn,r=document.createElement("canvas");r.width=e*n,r.height=t*n;const a=r.getContext("2d");if(a.fillStyle="white",a.fillRect(0,0,r.width,r.height),a.fillStyle="black",$u.clearRect(0,0,Hu.width,Hu.height),Bl==sl){for(let r=0;r<e+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l+r*n,i),a.lineTo(l+r*n,i+t*n),a.lineWidth=r%Wn==0?1.5:.5,a.stroke(),a.closePath();for(let r=0;r<t+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l,i+r*n),a.lineTo(l+e*n,i+r*n),a.lineWidth=(t-r)%Hn==0?1.5:.5,a.stroke(),a.closePath()}else if(Bl==dl){a.lineWidth=.5;for(let r=0;r<e+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l+r*n,i),a.lineTo(l+r*n,i+t*n),a.stroke(),a.closePath();for(let r=0;r<t+1;r++)a.beginPath(),a.strokeStyle="grey",a.moveTo(l,i+r*n),a.lineTo(l+e*n,i+r*n),a.stroke(),a.closePath()}else if(Bl==cl){a.lineWidth=1.5;for(let r=0;r<e+1;r++)r%Wn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(l+r*n,i),a.lineTo(l+r*n,i+t*n),a.stroke(),a.closePath());for(let r=0;r<t+1;r++)(t-r)%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(l,i+r*n),a.lineTo(l+e*n,i+r*n),a.stroke(),a.closePath())}else{a.lineWidth=1.5;for(let r=0;r<e+1;r+=e)a.beginPath(),a.strokeStyle="grey",a.moveTo(l+r*n,i),a.lineTo(l+r*n,i+t*n),a.stroke(),a.closePath();for(let r=0;r<t+1;r+=t)(t-r)%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(l,i+r*n),a.lineTo(l+e*n,i+r*n),a.stroke(),a.closePath())}const o=new Uint32Array(aL.memory.buffer,FB.cells(),FB.selected_weftgrid_length());if(a.beginPath(),o.forEach((e,l)=>{0!=e&&a.fillRect(l*n,(t-e)*n,n,n)}),a.fillStyle="red",rm.forEach(e=>{a.fillRect(e%FB.cols()*n,parseInt(e/FB.cols())*n,n,n)}),a.fillStyle="yellow",im.forEach(e=>{a.fillRect(e.x,e.y,n,n)}),a.closePath(),Mn){Hu.height=r.height,Hu.width=r.width*zn;const e=$u.createPattern(r,"repeat");$u.rect(0,0,Hu.width,Hu.height),$u.fillStyle=e,$u.fill()}else Hu.height=r.height,Hu.width=r.width,$u.drawImage(r,0,0);qu.style.height=Hu.height+"px",Dm(),bI(),Mm()},Hm=document.getElementById("function-canvas-container"),$m=document.getElementById("density-canvas-container"),qm=document.getElementById("function-canvas"),jm=qm.getContext("2d"),Vm=document.getElementById("density-canvas"),zm=Vm.getContext("2d"),Um=document.getElementById("weft-color-canvas"),Ym=Um.getContext("2d"),Jm=document.getElementById("weftcolor-context-menu"),Gm=document.getElementById("weft-color-container");let Xm="A",Km="A",Zm="A",Qm={},eh={},th={},nh=1;const lh=document.getElementById("first-column-container"),ih=document.getElementById("main-dent-container"),rh=(document.getElementById("weftSubParent"),e=>{const t=Um.getBoundingClientRect(),n=XB.size,l=qn.startRow,i=Mn?qn.endRow:Math.min(n,qn.endRow),r=Mn?i-l+1:Math.min(i-l+1,n),a=Jn?AB.height():Rl,o=n-1-(r-1-parseInt((e.clientY-t.top)/a)+(l-1))%n;console.log("index ",o),XB.update_cell(o,Xm),fh(),"radio-weave"!=Yn&&dI()}),ah=e=>{um!=El&&(Gb(Ub.WEFT),0==e.button&&jn==$n&&(rh(e),Ml(!0)))},oh=e=>{um!=El&&(Ll&&jn==$n&&(rh(e),Ml(!0)),oI(Zl,e))},sh=e=>{0==e.button&&((e=>{const t=qm.getBoundingClientRect(),n=YB.size,l=qn.startRow,i=Mn?qn.endRow:Math.min(n,qn.endRow),r=Mn?i-l+1:Math.min(i-l+1,n),a=Jn?AB.height():Rl,o=n-1-(r-1-parseInt((e.clientY-t.top)/a)+(l-1))%n;console.log("clicked function index ",o),YB.update_function_cell(o,Km),hh()})(e),Ml(!0))},dh=e=>{Gb(Ub.FUNCTION),0==e.button&&((e=>{const t=Vm.getBoundingClientRect(),n=GB.size,l=qn.startRow,i=Mn?qn.endRow:Math.min(n,qn.endRow),r=Mn?i-l+1:Math.min(i-l+1,n),a=Jn?AB.height():Rl,o=n-1-(r-1-parseInt((e.clientY-t.top)/a)+(l-1))%n;console.log("clicked function index ",o),GB.update_cell(o,Zm),ph()})(e),Ml(!0))},ch=e=>{oI(ti)},uh=e=>{oI(ni)},mh=()=>{const e=GB.size;console.log("rows is",e),console.log("densityGridInstance is",GB.size);const t=Jn?AB.height():Rl,n=On,l=Dn,i=document.createElement("canvas");i.width=10,i.height=e*t;const r=i.getContext("2d");if(r.fillStyle="white",r.fillRect(0,0,i.width,i.height),r.fillStyle="black",zm.clearRect(0,0,qm.width,qm.height),r.beginPath(),GB.cells.forEach(e=>{r.fillStyle=eh[e.color_code],r.fillRect(0,e.index*t,10,t)}),r.closePath(),Bl==sl){for(let i=0;i<2;i++)r.beginPath(),r.strokeStyle="grey",r.moveTo(n+10*i,l),r.lineTo(n+10*i,l+e*t),r.lineWidth=.5,r.stroke(),r.closePath();for(let i=0;i<e+1;i++)r.beginPath(),r.strokeStyle="grey",r.moveTo(n,l+i*t),r.lineTo(n+10,l+i*t),r.lineWidth=(e-i)%Hn==0?1.5:.5,r.stroke(),r.closePath()}else if(Bl==dl){r.lineWidth=.5;for(let i=0;i<2;i++)r.beginPath(),r.strokeStyle="grey",r.moveTo(n+10*i,l),r.lineTo(n+10*i,l+e*t),r.stroke(),r.closePath();for(let i=0;i<e+1;i++)r.beginPath(),r.strokeStyle="grey",r.moveTo(n,l+i*t),r.lineTo(n+10,l+i*t),r.stroke(),r.closePath()}else if(Bl==cl){r.lineWidth=1.5;for(let i=0;i<2;i++)i%Wn==0&&(r.beginPath(),r.strokeStyle="grey",r.moveTo(n+10*i,l),r.lineTo(n+10*i,l+e*t),r.stroke(),r.closePath());for(let i=0;i<e+1;i++)(e-i)%Hn==0&&(r.beginPath(),r.strokeStyle="grey",r.moveTo(n,l+i*t),r.lineTo(n+10,l+i*t),r.stroke(),r.closePath())}else{r.lineWidth=1.5;for(let i=0;i<2;i+=1)i%Wn==0&&(r.beginPath(),r.strokeStyle="grey",r.moveTo(n+10*i,l),r.lineTo(n+10*i,l+e*t),r.stroke(),r.closePath());for(let i=0;i<e+1;i+=e)(e-i)%Hn==0&&(r.beginPath(),r.strokeStyle="grey",r.moveTo(n,l+i*t),r.lineTo(n+10,l+i*t),r.stroke(),r.closePath())}Vm.width=i.width,Vm.height=i.height*nh;const a=zm.createPattern(i,"repeat");zm.rect(0,0,Vm.width,Vm.height),zm.fillStyle=a,zm.fill()},hh=()=>{const e=qn.startRow,t=qn.endRow,n=YB.size,l=Mn?t-e+1:Math.min(t-e+1,n),i=Jn?AB.height():Rl,r=document.createElement("canvas");if(r.width=10,r.height=l*i,0==r.height||0==r.width)return;const a=r.getContext("2d");a.fillStyle="white",a.fillRect(0,0,r.width,r.height),a.fillStyle="black",jm.clearRect(0,0,qm.width,qm.height),a.beginPath();let o=YB.getVisibleCells(e,Mn?t:Math.min(t,n),Mn),s=Mn?t:Math.min(t,n);if(s=s%n==0?n:s%n,o.forEach(e=>{a.fillStyle=Qm[e.color_code],a.fillRect(0,(e.index-(n-s))*i,10,i)}),a.closePath(),Bl==sl){for(let e=0;e<2;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(10*e,0),a.lineTo(10*e,l*i),a.lineWidth=.5,a.stroke(),a.closePath();for(let t=0;t<l+1;t++)a.beginPath(),a.strokeStyle="grey",a.moveTo(0,t*i),a.lineTo(10,t*i),a.lineWidth=(l-t+e-1)%Hn==0?1.5:.5,a.stroke(),a.closePath()}else if(Bl==dl){a.lineWidth=.5;for(let e=0;e<2;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(10*e,0),a.lineTo(10*e,l*i),a.stroke(),a.closePath();for(let e=0;e<l+1;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(0,e*i),a.lineTo(10,e*i),a.stroke(),a.closePath()}else if(Bl==cl){a.lineWidth=1.5;for(let e=0;e<2;e++)e%Wn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(10*e,0),a.lineTo(10*e,l*i),a.stroke(),a.closePath());for(let t=0;t<l+1;t++)(l-t+e-1)%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(0,t*i),a.lineTo(10,t*i),a.stroke(),a.closePath())}else{a.lineWidth=1.5;for(let e=0;e<2;e+=1)e%Wn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(10*e,0),a.lineTo(10*e,l*i),a.stroke(),a.closePath());for(let e=0;e<l+1;e+=l)(l-e)%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(0,e*i),a.lineTo(10,e*i),a.stroke(),a.closePath())}qm.width=r.width,qm.height=r.height,jm.drawImage(r,0,0)},ph=()=>{const e=qn.startRow,t=qn.endRow,n=GB.size,l=Mn?t-e+1:Math.min(t-e+1,n),i=Jn?AB.height():Rl,r=document.createElement("canvas");if(r.width=10,r.height=l*i,0==r.height||0==r.width)return;const a=r.getContext("2d");a.fillStyle="white",a.fillRect(0,0,r.width,r.height),a.fillStyle="black",zm.clearRect(0,0,qm.width,qm.height),a.beginPath();let o=GB.getVisibleCells(e,Mn?t:Math.min(t,n),Mn),s=Mn?t:Math.min(t,n);if(s=s%n==0?n:s%n,o.forEach(e=>{a.fillStyle=eh[e.color_code],a.fillRect(0,(e.index-(n-s))*i,10,i)}),a.closePath(),Bl==sl){for(let e=0;e<2;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(10*e,0),a.lineTo(10*e,l*i),a.lineWidth=.5,a.stroke(),a.closePath();for(let t=0;t<l+1;t++)a.beginPath(),a.strokeStyle="grey",a.moveTo(0,t*i),a.lineTo(10,t*i),a.lineWidth=(l-t+e-1)%Hn==0?1.5:.5,a.stroke(),a.closePath()}else if(Bl==dl){a.lineWidth=.5;for(let e=0;e<2;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(10*e,0),a.lineTo(10*e,l*i),a.stroke(),a.closePath();for(let e=0;e<l+1;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(0,e*i),a.lineTo(10,e*i),a.stroke(),a.closePath()}else if(Bl==cl){a.lineWidth=1.5;for(let e=0;e<2;e++)e%Wn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(10*e,0),a.lineTo(10*e,l*i),a.stroke(),a.closePath());for(let t=0;t<l+1;t++)(l-t+e-1)%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(0,t*i),a.lineTo(10,t*i),a.stroke(),a.closePath())}else{a.lineWidth=1.5;for(let e=0;e<2;e+=1)e%Wn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(10*e,0),a.lineTo(10*e,l*i),a.stroke(),a.closePath());for(let e=0;e<l+1;e+=l)(l-e)%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(0,e*i),a.lineTo(10,e*i),a.stroke(),a.closePath())}Vm.width=r.width,Vm.height=r.height,zm.drawImage(r,0,0)},gh=()=>{const e=YB.size,t=Jn?AB.height():Rl,n=On,l=Dn,i=document.createElement("canvas");i.width=10,i.height=e*t;const r=i.getContext("2d");if(r.fillStyle="white",r.fillRect(0,0,i.width,i.height),r.fillStyle="black",jm.clearRect(0,0,qm.width,qm.height),r.beginPath(),console.log("functiongrid",YB.cells),YB.cells.forEach(e=>{r.fillStyle="red",r.fillRect(0,e.index*t,10,t)}),r.closePath(),Bl==sl){for(let i=0;i<2;i++)r.beginPath(),r.strokeStyle="grey",r.moveTo(n+10*i,l),r.lineTo(n+10*i,l+e*t),r.lineWidth=.5,r.stroke(),r.closePath();for(let i=0;i<e+1;i++)r.beginPath(),r.strokeStyle="grey",r.moveTo(n,l+i*t),r.lineTo(n+10,l+i*t),r.lineWidth=(e-i)%Hn==0?1.5:.5,r.stroke(),r.closePath()}else if(Bl==dl){r.lineWidth=.5;for(let i=0;i<2;i++)r.beginPath(),r.strokeStyle="grey",r.moveTo(n+10*i,l),r.lineTo(n+10*i,l+e*t),r.stroke(),r.closePath();for(let i=0;i<e+1;i++)r.beginPath(),r.strokeStyle="grey",r.moveTo(n,l+i*t),r.lineTo(n+10,l+i*t),r.stroke(),r.closePath()}else if(Bl==cl){r.lineWidth=1.5;for(let i=0;i<2;i++)i%Wn==0&&(r.beginPath(),r.strokeStyle="grey",r.moveTo(n+10*i,l),r.lineTo(n+10*i,l+e*t),r.stroke(),r.closePath());for(let i=0;i<e+1;i++)(e-i)%Hn==0&&(r.beginPath(),r.strokeStyle="grey",r.moveTo(n,l+i*t),r.lineTo(n+10,l+i*t),r.stroke(),r.closePath())}else{r.lineWidth=1.5;for(let i=0;i<2;i+=1)i%Wn==0&&(r.beginPath(),r.strokeStyle="grey",r.moveTo(n+10*i,l),r.lineTo(n+10*i,l+e*t),r.stroke(),r.closePath());for(let i=0;i<e+1;i+=e)(e-i)%Hn==0&&(r.beginPath(),r.strokeStyle="grey",r.moveTo(n,l+i*t),r.lineTo(n+10,l+i*t),r.stroke(),r.closePath())}qm.width=i.width,qm.height=i.height*nh;const a=jm.createPattern(i,"repeat");jm.rect(0,0,qm.width,qm.height),jm.fillStyle=a,jm.fill()},fh=()=>{const e=qn.startRow,t=qn.endRow,n=XB.size,l=Mn?t-e+1:Math.min(t-e+1,n),i=Jn?AB.height():Rl,r=document.createElement("canvas");if(r.width=30,r.height=l*i,0==r.height||0==r.width)return;const a=r.getContext("2d");if(a.fillStyle="white",a.fillRect(0,0,r.width,r.height),a.fillStyle="black",Ym.clearRect(0,0,Um.width,Um.height),a.beginPath(),XB.getVisibleCells(e,Mn?t:Math.min(t,n),Mn).forEach((e,t)=>{a.fillStyle=Qm[e],a.fillRect(0,t*i,30,i)}),a.closePath(),Bl==sl){for(let e=0;e<2;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(30*e,0),a.lineTo(30*e,l*i),a.lineWidth=.5,a.stroke(),a.closePath();for(let t=0;t<l+1;t++)a.beginPath(),a.strokeStyle="grey",a.moveTo(0,t*i),a.lineTo(30,t*i),a.lineWidth=(l-t+e-1)%Hn==0?1.5:.5,a.stroke(),a.closePath()}else if(Bl==dl){a.lineWidth=.5;for(let e=0;e<2;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(30*e,0),a.lineTo(30*e,l*i),a.stroke(),a.closePath();for(let e=0;e<l+1;e++)a.beginPath(),a.strokeStyle="grey",a.moveTo(0,e*i),a.lineTo(30,e*i),a.stroke(),a.closePath()}else if(Bl==cl){a.lineWidth=1.5;for(let e=0;e<2;e++)e%Wn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(30*e,0),a.lineTo(30*e,l*i),a.stroke(),a.closePath());for(let t=0;t<l+1;t++)(l-t+e-1)%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(0,t*i),a.lineTo(30,t*i),a.stroke(),a.closePath())}else{a.lineWidth=1.5;for(let e=0;e<2;e+=1)e%Wn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(30*e,0),a.lineTo(30*e,l*i),a.stroke(),a.closePath());for(let e=0;e<l+1;e+=l)(l-e)%Hn==0&&(a.beginPath(),a.strokeStyle="grey",a.moveTo(0,e*i),a.lineTo(30,e*i),a.stroke(),a.closePath())}Um.width=r.width,Um.height=r.height,Ym.drawImage(r,0,0)},yh=()=>{fh()},vh=document.getElementById("dent-canvas"),bh=document.getElementById("dent-click-canvas"),wh=vh.getContext("2d"),Eh=bh.getContext("2d"),Ih=document.getElementById("dent-container"),Sh=document.getElementById("dent-click-canvas-container"),kh=e=>{Gb(Ub.NONE),(e=>{const t=vh.getBoundingClientRect(),n=WB.cell_size(),l=WB.cols(),i=WB.rows(),r=(e.clientX-t.left)%(l*n),a=e.clientY-t.top,o=parseInt(r/n)+qn.startColumn,s=i-parseInt(a/n)-1;WB.add_cell_new(s,o%l,AB,DB),Bh()})(e)},xh=e=>{Gb(Ub.NONE),e.preventDefault();const t=vh.getBoundingClientRect(),n=WB.cell_size(),l=n,i=WB.cols(),r=(e.clientX-t.left)%(i*n),a=(e.clientY,t.top,parseInt(r/n)+qn.startColumn);0==e.button?WB.add_click_cell_new(a%i,!0,AB,DB):2==e.button&&WB.add_click_cell_new(a%i,!1,AB,DB),Bh()},Th=()=>{oI(ei)},_h=()=>{oI(li)},Bh=()=>{const e=WB.cols(),t=qn.startColumn,n=qn.endColumn,l=Mn?n-t+1:Math.min(n-t+1,e),i=WB.rows(),r=WB.cell_size(),a=document.createElement("canvas");a.width=l*r,a.height=i*r;const o=a.getContext("2d");o.fillStyle="white",o.fillRect(0,0,a.width,a.height),o.fillStyle="black";const s=WB.get_visible_cells(t,Mn?n:Math.min(n,e-1),Mn),d=bb(s)?JSON.parse(s):[];for(let e=0;e<l+1;e++)o.beginPath(),o.strokeStyle="grey",o.moveTo(e*r,0),o.lineTo(e*r,i*r),o.lineWidth=(e+t)%Wn==0?1.5:.5,o.stroke(),o.closePath();for(let e=0;e<i+1;e++)o.beginPath(),o.strokeStyle="grey",o.moveTo(0,e*r),o.lineTo(l*r,e*r),o.stroke(),o.closePath();d.forEach((e,t)=>{o.fillRect(t*r,(i-e)*r,r,r)}),wh.clearRect(0,0,vh.width,vh.height),Ih.style.height=a.height+"px",vh.height=a.height,vh.width=a.width,wh.drawImage(a,0,0),Lh(),ar()},Lh=()=>{const e=WB.cols(),t=qn.startColumn,n=qn.endColumn,l=Mn?n-t+1:Math.min(n-t+1,e),i=WB.get_visible_click_cells(t,Mn?n:Math.min(n,e-1),Mn),r=bb(i)?JSON.parse(i):[],a=WB.rows(),o=WB.cell_size(),s=document.createElement("canvas");s.width=l*o,s.height=o;const d=s.getContext("2d");d.fillStyle="white",d.fillRect(0,0,s.width,s.height),d.fillStyle="black";for(let e=0;e<l+1;e++)d.beginPath(),d.strokeStyle="white",d.moveTo(e*o,0),d.lineTo(e*o,a*o),d.stroke(),d.closePath();for(let e=0;e<a+1;e++)d.beginPath(),d.strokeStyle="white",d.moveTo(0,e*o),d.lineTo(l*o,e*o),d.stroke(),d.closePath();d.font="10px serif",r.forEach((e,t)=>{e>0&&d.fillText(r[t],(t+1)*o-4,8)}),Sh.style.height=s.height+"px",bh.width=s.width,bh.height=s.height,Eh.clearRect(0,0,vh.width,vh.height),Eh.drawImage(s,0,0)},Ph=document.getElementById("draft-edit-num"),Ch=document.getElementById("edit-draft-error-message"),Nh=document.getElementById("total-end-dent"),Rh=(document.getElementById("leftSalvageDraft"),document.getElementById("rightSalvageDraft"),()=>{let e=um==Il?FB.convert_new_index_to_numeric(WB):FB.get_fix_numeric_text();Ph.value=e,Ah({target:{value:e}}),Gb(Ub.NONE),oI(Xl)}),Ah=e=>{let t=String(e.target.value),n={".":" ","{":"[","}":"]","(":"[",")":"]"},l=Ph.selectionStart;t=t.split("").map(e=>n[e]||e).join(""),Ph.value=t,Ph.setSelectionRange(l,l),Ph.focus();let i=mb(t);const r=Pv(String(i).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e))),a=String(i).split("\n").filter(e=>e.length>0).length;Nh.value=`${r}/${a}`},Fh=(e=!1)=>{if(String(Ph.value).length>0){if(Av(Ph.value,"[")!=Av(Ph.value,"]"))return Ch.style.display="block",Ch.innerText="Check Brackets Properly",setTimeout(()=>{Ch.style.display="none"},6e3),!1;Ch.style.display="none";let t=mb(Ph.value);Pv(String(t).split("\n").filter(e=>e.length>0).map(e=>e.trim().split(" ")));let n=[],l=[],i=!0,r=0;String(t).split("\n").filter(e=>e.length>0).forEach(e=>{if(e){e.trim().split(" ").forEach(e=>{n.push(e.trim()),l.push(i?1:2)}),r++,i=!i}}),console.log("denting cells ",l);let a=Math.max(...n);if(a>40)return Ch.style.display="block",Ch.innerText="Shaft must be lesser than 40",setTimeout(()=>{Ch.style.display="none"},6e3),!1;if(Ch.style.display="none",e&&a>24&&!confirm(`You are input ${a} Shaft, Are you Sure to use More then 24 Shaft?`))return!1;FB.new_edit_draft_numeric(n,AB,WB,ZB,DB,HB,l,r,Ph.value),KB.update_size(FB.cols()),JB.update_size(FB.cols()),$f.value=FB.cols(),WB.reset_skip_dent_cells(),Ol(""),ry(!0),iI({target:{scrollLeft:0}}),rI(),Dm()}return!0},Mh=()=>{Fh(!0)&&(uo.style.display="none")},Oh=document.getElementById("design-with-part-modal"),Dh=document.getElementById("design-with-part-modal-trigger");let Wh,Hh;const $h=["Part","Warp-Pattern","Dent","Ends","Repeat","Size"];let qh,jh=[...$h],Vh=[],zh=[],Uh=[],Yh=-1,Jh={},Gh={};const Xh=()=>{nv(),Oh.style.display="block",Oh.style.animation="slide-down 0.3s ease",mp()},Kh=e=>{Vh=e},Zh=()=>{Oh.style.display="none",Ol("")},Qh=(e,t)=>{let n=Dv(t),l=parseInt(e/n),i=e%n,r="",a=mb(t).trim();for(let e=0;e<l;e++)r+=a+"\n";if(r=r.trim(),i>0){let e=a.split(/<br>|\s+/),t="";if(1==e.length){let n=cb(e[0]);for(let e=0;e<i;e++)t+=n+"\n";r+="\n"+t}else{for(let n=0;n<i;n++)t+=e[n]+" ";r+="\n"+t}}return r=nL(r.split(/<br>|\s+/).join("\n")).trim(),r},ep=()=>{let e=Number(gf)+Number(yf)+Number(ff);return(()=>{let e=0;for(let t=0;t<Uh.length;t++){let n=Uh[t-1],l=document.getElementById("design-with-part-table-repeat-"+Uh[t]).value;n=null==Uh[t-1]?0:Uh[t-1]+1;let i=0;for(let e=n;e<=Uh[t];e++){let t=document.getElementById("design-with-part-table-dent-"+e).value;i+=Number(t)}let r=i*Number(l);e+=Number(parseFloat(r/(Number(NB.value)/Number(jf.value))).toFixed(2))}const t=document.getElementById("design-with-part-table-size-left-salvage"),n=document.getElementById("design-with-part-table-size-right-salvage");return e+=Number(t.value),e+=Number(n.value),e})()>e+2*e/100?(qh.style.display="block",qh.innerText="Design Width Not Matched With File Design Width",setTimeout(()=>{qh.style.display="none"},6e3),!1):((()=>{qh.style.display="none",Vh=[];let e="",t="";for(let n=0;n<Uh.length;n++){let l=Uh[n-1],i=document.getElementById("design-with-part-table-repeat-"+Uh[n]).value,r=document.getElementById("design-with-part-table-size-"+Uh[n]).value;l=null==Uh[n-1]?0:Uh[n-1]+1;let a=0,o=[],s="",d="";for(let e=l;e<=Uh[n];e++){let t=document.getElementById("design-with-part-table-dent-"+e).value,l=document.getElementById("design-with-part-table-ends-"+e).value,i=document.getElementById("design-with-part-table-pattern-"+e).value,r=document.getElementById("design-with-part-table-part-"+e).value,c=hr.find(e=>e.partName==r),u=document.getElementById("design-with-part-table-pattern-"+e).value,m=mb(c.partDraftPlan),h=m.split("\n").filter(e=>e),p=Ov(m),g=parseInt(Number(l)/p),f=Number(l)%p,y="",v=0;for(let e=0;e<g;e++)y+=m+"\n";if(f>0)for(let e=0;e<h.length&&(y+=h[n]+"\n",v+=Ov(h[n]),!(v>=f));e++);s+=iL(y),d+=Qh(Number(l),u)+"\n";let b={};zh.forEach(t=>{let n=document.getElementById(`design-with-part-table-warp-${t}-${e}`).value;n&&(b[t]=Number(n))}),o.push({partName:c.partName,repeatedPart:c.partDraftPlan,pattern:i,dent:Number(t),ends:Number(l),usedYarns:b}),a+=Number(t)}e+="["+s+"]X"+String(i)+"\n",t+="["+d+"]X"+String(i)+"\n",Vh.push({repeatedPart:"outerDraft",...0==Vh.length&&{tableColumns:jh.filter(e=>"Warp-Pattern"!=e)},outerRepeat:Number(i),size:r,withInnerRepeat:o,pattern:"204A"})}console.log("Design With Part Data is",Vh),Ph.value=e.trim(),Fh(),Zr("warp"),Yr.value=t.trim(),la()})(),!0)},tp=()=>{ep()&&Zh(),console.log("handle Ok Called")},np=()=>{let e=0,t=Number(gf)+Number(yf)+Number(ff);console.log("repeat given row is",Uh);for(let t=0;t<Uh.length;t++){let n=Uh[t-1],l=document.getElementById("design-with-part-table-repeat-"+Uh[t]).value;n=Uh[t-1]?Uh[t-1]+1:0;let i=0;for(let e=n;e<=Uh[t];e++){let t=document.getElementById("design-with-part-table-dent-"+e).value;i+=Number(t)}let r=i*Number(l);e+=Number(parseFloat(r/(Number(NB.value)/Number(jf.value))).toFixed(2))}const n=document.getElementById("design-with-part-table-size-left-salvage"),l=document.getElementById("design-with-part-table-size-right-salvage");return e+=Number(n.value),e+=Number(l.value),e<t},lp=e=>{let t=e.target.id;(e=>{zh.forEach(t=>{document.getElementById(`design-with-part-table-warp-${t}-${e}`).value=""}),document.getElementById("design-with-part-table-repeat-"+e).value="",document.getElementById("design-with-part-table-dent-"+e).value="",document.getElementById("design-with-part-table-size-"+e).value="";let t=document.getElementById("design-with-part-table-ends-"+e),n=document.getElementById("design-with-part-table-part-"+e),l=hr.find(e=>e.partName==n.value);document.getElementById("design-with-part-table-pattern-"+e).innerHTML=l.partWarpSeq.map(e=>`<option value="${e}">${e}</option>`),t.value="",console.log("current row is",e)})(parseInt(t.split("-").at(-1)))},ip=e=>{let t=e.target.id,n=parseInt(t.split("-").at(-1));ap(n),Uh.length>0&&op()},rp=e=>{let t=e.target.id,n=parseInt(t.split("-").at(-1)),l=document.getElementById("design-with-part-table-part-"+n).value,i=hr.find(e=>e.partName==l),r=document.getElementById("design-with-part-table-dent-"+n),a=(document.getElementById("design-with-part-table-part-"+(n+1)),[]);for(let e=0;e<zh.length;e++)a.push(document.getElementById(`design-with-part-table-warp-${zh[e]}-${n}`));if(t.includes("repeat")){console.log("repeat change",e.target.value),e.target.value?Uh.includes(n)||(Uh.push(n),Uh.sort((e,t)=>e-t)):(Uh=Uh.filter(e=>e!=n),Uh.sort((e,t)=>e-t));let t=np();console.log("isSpaceAvailable ",t)}else if(t.includes("ends")){console.log("ends chagne",e),r.value=i.partDents*Number(e.target.value)/i.partEnds;np()}ap(n),console.log("repeat given row is",Uh),Uh.length>0&&op()},ap=e=>{let t=document.getElementById("design-with-part-table-ends-"+e),n=document.getElementById("design-with-part-table-pattern-"+e),l="",i=0;String(mb(n.value)).split("\n").filter(e=>e.length>0).forEach(e=>{e.split(" ").forEach(e=>{let t=isNaN(parseInt(e))?1:parseInt(e);for(let n=0;n<t;n++)l+=e.slice(-1)+"\n",i+=1})});let r={};if(l=l.split("\n").filter(e=>e),zh.forEach(e=>{r[e]=0}),l.forEach(e=>{if(Rv(e)){let t=cb(e).trim(),n=isNaN(parseInt(e))?1:parseInt(e);r[t]?r[t]+=n:r[t]=n}}),Object.keys(r).forEach(e=>{r[e]=r[e]*parseInt(Number(t.value)/i)}),Number(t.value)%i!=0){let e=Number(t.value)%i;for(let t=0;t<l.length&&t!=e;t++)r[l[t]]+=1}Object.keys(r).forEach(t=>{0==r[t]?document.getElementById(`design-with-part-table-warp-${t}-${e}`).value="":document.getElementById(`design-with-part-table-warp-${t}-${e}`).value=r[t]})},op=()=>{let e=document.getElementsByClassName("design-with-part-table-row").length-4-1,t=0,n=0,l=0,i={};zh.forEach(e=>{const t=document.getElementById(`design-with-part-table-warp-${e}-left-salvage`).value,n=document.getElementById(`design-with-part-table-warp-${e}-right-salvage`).value;i[e]=0,t&&(i[e]+=Number(t)),n&&(i[e]+=Number(n))});const r=document.getElementById("design-with-part-table-dent-left-salvage").value,a=document.getElementById("design-with-part-table-ends-left-salvage").value,o=document.getElementById("design-with-part-table-size-left-salvage").value,s=document.getElementById("design-with-part-table-dent-right-salvage").value,d=document.getElementById("design-with-part-table-ends-right-salvage").value,c=document.getElementById("design-with-part-table-size-right-salvage").value;for(let t=0;t<e;t++)document.getElementById("design-with-part-table-size-"+t).value="";for(let e=0;e<Uh.length;e++){let r=Uh[e-1],a=document.getElementById("design-with-part-table-repeat-"+Uh[e]).value,o=document.getElementById("design-with-part-table-size-"+Uh[e]);console.log("current Sizde element",o),r=null!=Uh[e-1]?Uh[e-1]+1:0;let s=0,d=0,c={};zh.forEach(e=>{c[e]=0});for(let t=r;t<=Uh[e];t++){if(!document.getElementById("design-with-part-table-row-"+t))continue;let e=document.getElementById("design-with-part-table-dent-"+t).value,n=document.getElementById("design-with-part-table-ends-"+t).value;s+=Number(e),d+=Number(n),zh.forEach(e=>{let n=document.getElementById(`design-with-part-table-warp-${e}-${t}`).value;n&&(c[e]+=Number(n))})}let u=s*Number(a),m=d*Number(a),h={};Object.keys(c).forEach(e=>{h[e]=c[e]*a}),o.value=parseFloat(u/(Number(NB.value)/Number(jf.value))).toFixed(2).toString(),t+=Number(o.value),l+=m,n+=u,Object.keys(h).forEach(e=>{i[e]+=h[e]})}t+=Number(o),n+=Number(r),l+=Number(a),t+=Number(c),n+=Number(s),l+=Number(d);document.getElementById("design-with-part-table-size-total").value=t;const u=document.getElementById("design-with-part-table-dent-total"),m=document.getElementById("design-with-part-table-ends-total");if(u.value=n,m.value=l,Object.keys(i).forEach(e=>{document.getElementById(`design-with-part-table-warp-${e}-total`).value=String(i[e])}),Uh.length>0){let e=Array.from({length:Uh.at(-1)},(e,t)=>t+1),t=[];e.forEach(n=>{e.includes(n)||t.push(n)}),t.forEach(e=>{document.getElementById("design-with-part-table-repeat-"+e).value=""})}},sp=e=>{let t=e.target.id;Yh=parseInt(t.split("-").at(-1))},dp=e=>{let t=e.target.id;Yh=parseInt(t.split("-").at(-1)),document.getElementById("design-with-part-table-radio-"+Yh)&&(document.getElementById("design-with-part-table-radio-"+Yh).checked=!0)},cp=()=>{const e=document.createElement("tr");e.className="design-with-part-table-row";let t=document.getElementsByClassName("design-with-part-table-row");e.id="design-with-part-table-row-"+(t.length-4);for(let n=0;n<jh.length;n++){const l=document.createElement("td");"Part"==jh[n]?(l.innerHTML=`<select id="design-with-part-table-part-${t.length-4}">\n      ${hr.map(e=>`<option value="${e.partName}">${e.partName}</option>`)}\n    </select>`,e.appendChild(l)):"Dent"==jh[n]?(l.innerHTML=`<input type="text" readOnly id="design-with-part-table-dent-${t.length-4}"/>`,e.appendChild(l)):"Ends"==jh[n]?(l.innerHTML=`<input type="text" id="design-with-part-table-ends-${t.length-4}"/>`,e.appendChild(l)):"Repeat"==jh[n]?(l.innerHTML=`<input type="text" id="design-with-part-table-repeat-${t.length-4}"/>`,e.appendChild(l)):"Size"==jh[n]?(l.innerHTML=`<input type="text" readOnly id="design-with-part-table-size-${t.length-4}"/>`,e.appendChild(l)):"Warp-Pattern"==jh[n]?(hr[0]?l.innerHTML=`<select id="design-with-part-table-pattern-${t.length-4}">\n        ${hr[0].partWarpSeq.map(e=>`<option value="${e}">${e}</option>`)}\n      </select>`:l.innerHTML=`<select id="design-with-part-table-pattern-${t.length-4}">\n      </select>`,e.appendChild(l)):(l.innerHTML=`<input readOnly id="design-with-part-table-warp-${jh[n]}-${t.length-4}" type="text"/>`,l.className="design-with-part-table-warp",e.appendChild(l))}const n=document.createElement("td");n.style.border="none",n.style.width="10px";const l=document.createElement("div");l.style.paddingTop="5px",l.style.textAlign="center",l.innerHTML=`<input type="radio" id="design-with-part-table-radio-${t.length-4}" name="selected-part">`,l.addEventListener("change",sp),n.appendChild(l),e.appendChild(n),Wh.appendChild(e),(()=>{let e=document.getElementsByClassName("design-with-part-table-row").length-4-1;for(let t=0;t<jh.length;t++)if("Part"==jh[t]){document.getElementById("design-with-part-table-part-"+e).addEventListener("change",lp)}else if("Dent"==jh[t]);else if("Ends"==jh[t]){let t=document.getElementById("design-with-part-table-ends-"+e);console.log("endsInputElement is",t),t.removeEventListener("change",rp),t.addEventListener("change",rp)}else"Repeat"==jh[t]?(document.getElementById("design-with-part-table-repeat-"+e).removeEventListener("change",rp),document.getElementById("design-with-part-table-repeat-"+e).addEventListener("change",rp)):"Size"==jh[t]||"Warp-Pattern"==jh[t]&&(document.getElementById("design-with-part-table-pattern-"+e).removeEventListener("change",ip),document.getElementById("design-with-part-table-pattern-"+e).addEventListener("change",ip));let t=Oh.querySelectorAll("input"),n=Oh.querySelectorAll("select");for(let e=0;e<t.length;e++){let n=t.item(e);n.removeEventListener("click",dp),n.addEventListener("click",dp)}for(let e=0;e<n.length;e++){let t=n.item(e);t.removeEventListener("click",dp),t.addEventListener("click",dp)}})()},up=e=>{console.log("remove row called",e);let t=document.getElementById("design-with-part-table-row-"+e);t&&(t.parentNode.removeChild(t),Uh=Uh.filter(t=>t!=e),Uh.sort((e,t)=>e-t))},mp=()=>{Ol("design-with-part-modal"),console.log("design with part ios",Vh),Oh.querySelector("#design-with-part-width").innerHTML="Width = "+String(gf+yf+ff),zh=[],Uh=[];for(let e=0;e<hr.length;e++){let t=hr[e].partWarpSeq;Array.isArray(t)&&t.forEach(e=>{String(e).replace("[","").replace("]","").split(" ").forEach(e=>{e.replace(/[^a-zA-Z]+/g,"")&&e.replace(/[^a-zA-Z]+/g,"")[0]&&zh.push(e.replace(/[^a-zA-Z]+/g,"")[0])})})}let e=gv.warpSeq;String(e).replace("[","").replace("]","").split(" ").forEach(e=>{e.replace(/[^a-zA-Z]+/g,"")&&e.replace(/[^a-zA-Z]+/g,"")[0]&&zh.push(e.replace(/[^a-zA-Z]+/g,"")[0])});let t=fv.warpSeq;String(t).replace("[","").replace("]","").split(" ").forEach(e=>{e.replace(/[^a-zA-Z]+/g,"")&&e.replace(/[^a-zA-Z]+/g,"")[0]&&zh.push(e.replace(/[^a-zA-Z]+/g,"")[0])}),zh=[...new Set([...zh])],console.log("drafts Part Data is",hr,Pr,Lr),console.log("uniqueYarnUsedInPart is",zh),hp(zh),(()=>{let e=0;Vh.length>0&&(Vh.forEach(t=>{Array.isArray(t.withInnerRepeat)&&t.withInnerRepeat.forEach((n,l)=>{let i=document.getElementById("design-with-part-table-row-"+e);i||(cp(),i=document.getElementById("design-with-part-table-row-"+e)),document.getElementById("design-with-part-table-part-"+e).value=n.partName;let r=hr.find(e=>e.partName==n.partName);if(t.withInnerRepeat.length-1==l){const n=document.getElementById("design-with-part-table-repeat-"+e);document.getElementById("design-with-part-table-size-"+e).value=t.size,n.value=t.outerRepeat,Uh.push(Number(e))}Object.keys(n).forEach(t=>{if("dent"==t){document.getElementById("design-with-part-table-dent-"+e).value=n[t]}else if("ends"==t){document.getElementById("design-with-part-table-ends-"+e).value=n[t]}else if("pattern"==t){const l=document.getElementById("design-with-part-table-pattern-"+e);l.innerHTML=""+r.partWarpSeq.map(e=>`<option value="${e}">${e}</option>`).join(""),l.value=n[t]}else"usedYarns"==t&&Object.keys(n[t]).forEach(l=>{document.getElementById(`design-with-part-table-warp-${l}-${e}`).value=n[t][l]})}),console.log("Row Element is",i),e++})}),op())})()},hp=e=>{Wh.innerHTML="",jh=[...$h];jh=[...jh.slice(0,4),...e,...jh.slice(4)];let t=document.createElement("tr");t.className="design-with-part-table-row",jh.forEach(e=>{let n=document.createElement("td");n.innerHTML=Ra(e,"warp"),t.appendChild(n)}),Wh.appendChild(t),(()=>{const e=document.createElement("tr");e.className="design-with-part-table-row",e.id="design-with-part-table-row-left-salvage";let t=yb(mb(gv.draftPlan)),n=fb(mb(gv.draftPlan)),l=parseFloat(n/(Number(NB.value)/Number(jf.value))).toFixed(2).toString(),i=eb(gv.warpSeq);console.log("table columns are",jh),console.log("left salvage row",gv),console.log("yarn yarnWiseCount ",i),Jh={partName:"Left Salavage",repeatedPart:"",dent:n,size:l,ends:t,usedYarns:i};for(let n=0;n<jh.length;n++){const r=document.createElement("td");"Part"==jh[n]?(r.innerHTML="Left Selvedge",e.appendChild(r)):"Dent"==jh[n]?(r.innerHTML=`<input type="text" readOnly id="design-with-part-table-dent-left-salvage" value=${fb(mb(gv.draftPlan))}>`,e.appendChild(r)):"Ends"==jh[n]?(r.innerHTML=`<input type="text" readOnly id="design-with-part-table-ends-left-salvage" value=${t} >`,e.appendChild(r)):"Repeat"==jh[n]?(r.innerHTML='<input type="text" readOnly id="design-with-part-table-repeat-left-salvage" value=1 >',e.appendChild(r)):"Size"==jh[n]?(r.innerHTML=`<input type="text" readOnly id="design-with-part-table-size-left-salvage" value=${l} >`,e.appendChild(r)):"Warp-Pattern"==jh[n]?(r.innerHTML=`<input type="text" readOnly id="design-with-part-table-pattern-left-salvage" value=${gv.warpSeq} >`,e.appendChild(r)):(r.innerHTML=`<input readOnly id="design-with-part-table-warp-${jh[n]}-left-salvage" type="text" value=${i[jh[n]]?i[jh[n]]:""}>`,r.className="design-with-part-table-warp",e.appendChild(r))}Wh.appendChild(e)})(),(()=>{Hh.innerHTML="";const e=document.createElement("tr");e.className="design-with-part-table-row",e.id="design-with-part-table-row-right-salvage";let t=yb(mb(fv.draftPlan)),n=fb(mb(fv.draftPlan)),l=parseFloat(n/(Number(NB.value)/Number(jf.value))).toFixed(2).toString(),i=eb(fv.warpSeq);console.log("table columns are",jh),console.log("yarn yarnWiseCount ",i),Gh={partName:"Right Salavage",repeatedPart:"",dent:n,size:l,ends:t,usedYarns:i};for(let n=0;n<jh.length;n++){const r=document.createElement("td");"Part"==jh[n]?(r.innerHTML="Right Selvedge",e.appendChild(r)):"Dent"==jh[n]?(r.innerHTML=`<input type="text" readOnly id="design-with-part-table-dent-right-salvage" value=${fb(mb(fv.draftPlan))}>`,e.appendChild(r)):"Ends"==jh[n]?(r.innerHTML=`<input type="text" readOnly id="design-with-part-table-ends-right-salvage" value=${t} >`,e.appendChild(r)):"Repeat"==jh[n]?(r.innerHTML='<input type="text" readOnly id="design-with-part-table-repeat-right-salvage" value=1 >',e.appendChild(r)):"Size"==jh[n]?(r.innerHTML=`<input type="text" readOnly id="design-with-part-table-size-right-salvage" value=${l} >`,e.appendChild(r)):"Warp-Pattern"==jh[n]?(r.innerHTML=`<input type="text" readOnly id="design-with-part-table-pattern-right-salvage" value=${fv.warpSeq} >`,e.appendChild(r)):(r.innerHTML=`<input readOnly id="design-with-part-table-warp-${jh[n]}-right-salvage" type="text" value=${i[jh[n]]?i[jh[n]]:""}>`,r.className="design-with-part-table-warp",e.appendChild(r))}Hh.appendChild(e)})(),(()=>{const e=document.createElement("tr");e.className="design-with-part-table-row",e.id="design-with-part-table-total-row";for(let t=0;t<jh.length;t++){const n=document.createElement("td");"Part"==jh[t]?(n.innerHTML="Total",e.appendChild(n)):"Dent"==jh[t]?(n.innerHTML='<input type="text" readOnly id="design-with-part-table-dent-total" >',e.appendChild(n)):"Ends"==jh[t]?(n.innerHTML='<input type="text" readOnly id="design-with-part-table-ends-total"  >',e.appendChild(n)):"Repeat"==jh[t]?(n.innerHTML='<input type="text" readOnly id="design-with-part-table-repeat-total">',e.appendChild(n)):"Size"==jh[t]?(n.innerHTML='<input type="text" readOnly id="design-with-part-table-size-total" value=0 >',e.appendChild(n)):(n.innerHTML=`<input readOnly id="design-with-part-table-warp-${jh[t]}-total" type="text" value=0>`,n.className="design-with-part-table-warp",e.appendChild(n))}Hh.appendChild(e)})(),0==Vh.length&&cp(),console.log("table columns are=====",jh)},pp=e=>{cp()},gp=e=>{0!=Yh&&(up(Yh),fp(),op())},fp=()=>{let e=Yh;for(;document.getElementById("design-with-part-table-row-"+(e+1));)e+=1;for(let t=Yh;t<=e;t++){let e=document.getElementById("design-with-part-table-row-"+t),n=Uh.findIndex(e=>e==t);if(-1!=n&&(Uh[n]=t-1),e){e.id="design-with-part-table-row-"+(t-1);document.getElementById("design-with-part-table-part-"+t).id="design-with-part-table-part-"+(t-1);document.getElementById("design-with-part-table-dent-"+t).id="design-with-part-table-dent-"+(t-1);document.getElementById("design-with-part-table-pattern-"+t).id="design-with-part-table-pattern-"+(t-1);document.getElementById("design-with-part-table-ends-"+t).id="design-with-part-table-ends-"+(t-1);document.getElementById("design-with-part-table-repeat-"+t).id="design-with-part-table-repeat-"+(t-1);document.getElementById("design-with-part-table-size-"+t).id="design-with-part-table-size-"+(t-1),zh.forEach(e=>{document.getElementById(`design-with-part-table-warp-${e}-${t}`).id=`design-with-part-table-warp-${e}-${t-1}`})}}},yp=document.getElementById("simulation-model"),vp=document.getElementById("simulation-model-trigger"),bp=document.getElementById("simulation-header-trigger"),wp="selected",Ep="single_repeat",Ip="repeat",Sp="color",kp="interlacement";let xp,Tp,_p,Bp,Lp,Pp,Cp=Ip,Np=Sp,Rp=0;const Ap=(e,t,n,l)=>{const i=yp.querySelector(".simulation-canvas-container");let r=i.clientHeight-l,a=i.clientWidth;const o=Math.floor(r/t)+10,s=Math.floor(a/e)+10;return r<a?o:s},Fp=()=>{const e=document.getElementById("simulation-model-canvas"),t=yp.querySelector(".simulation-canvas-container"),n=e.getContext("2d"),l=AB.cols(),i=AB.rows();if(l>5e3)return void Hp();let r=Cp==Ep?(()=>{const e=yp.querySelector(".simulation-canvas-container"),t=new Uint32Array(aL.memory.buffer,WB.click_cells(),WB.click_dentgrid_length());let n=0;for(let e=0;e<t.length;e++)t[e]>0&&(n+=t[e]);const l=AB.cols()+n,i=AB.rows();let r=e.clientHeight,a=e.clientWidth;const o=Math.ceil(r/i)+1,s=Math.ceil(a/l)+1;return Math.min(o,s)})():2,a=r*AB.height()/Rl,o=r,s=o*Rl/AB.height();a=o,r=Math.ceil(s);const d=document.createElement("canvas"),c=d.getContext("2d");let u=(()=>{let e=FB.convert_new_index_to_numeric(WB),t=mb(e);return Pv(String(t).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e)))/String(t).split("\n").filter(e=>e.length>0).length})();d.width=Math.ceil(l*r),d.height=Math.ceil(i*a),c.clearRect(0,0,d.width,d.height),c.fillStyle="white",c.fillRect(0,0,d.width,d.height),c.fillStyle="black";let m={},h={};for(let e=0;e<l;e++){let t=new Uint32Array(aL.memory.buffer,AB.get_col_new_cell(e),AB.get_col_new_cell_length(e)),n=Array.from({length:i},(e,t)=>t+1);if(Np==Sp||Np==kp&&Cp==Ip)t.forEach(t=>{let l=KB.cells.find(t=>t.index==e);l&&(c.fillStyle=Lr[l.color_code],c.fillRect(e*r,(i-t)*a,r,a)),n=n.filter(e=>e!=t)}),n.forEach(t=>{let n=XB.cells.find(e=>e.index==i-t);n&&(c.fillStyle=Qm[n.color_code],c.fillRect(e*r,(i-t)*a,r,a))});else if(Np==kp){let l=Cp==Ep?1:.2,o=Cp==Ep?1:.2;t.forEach(t=>{let s=KB.cells.find(t=>t.index==e),d=XB.cells.find(e=>e.index==i-t);s&&(c.fillStyle=Lr[s.color_code],c.fillRect(e*r+l+o,(i-t)*a,r-2*(l+o),a)),d&&(c.fillStyle=Qm[d.color_code],c.fillRect(e*r,(i-t)*a+l+o,l,a-2*(l+o)),c.fillRect(e*r+r-l,(i-t)*a+l+o,l,a-2*(l+o)),c.fillStyle="black",c.fillRect(e*r+l,(i-t)*a,o,a),c.fillRect(e*r+r-(l+o),(i-t)*a,o,a),c.fillRect(e*r,(i-t)*a+l,l,o),c.fillRect(e*r+r-l,(i-t)*a+l,l,o),c.fillRect(e*r,(i-t)*a+a-(l+o),l,o),c.fillRect(e*r+r-l,(i-t)*a+a-(l+o),l,o)),n=n.filter(e=>e!=t)}),n.forEach(t=>{let n=XB.cells.find(e=>e.index==i-t),s=KB.cells.find(t=>t.index==e%KB.size);n&&(c.fillStyle=Qm[n.color_code],c.fillRect(e*r,(i-t)*a+(l+o),r,a-2*(l+o))),s&&(c.fillStyle=Lr[s.color_code],c.fillRect(e*r+l+o,(i-t)*a,r-2*(l+o),l+o),c.fillRect(e*r+l+o,(i-t)*a+a-l,r-2*(l+o),l+o),c.fillStyle="black",c.fillRect(e*r,(i-t)*a+l,r,o),c.fillRect(e*r,(i-t)*a+a-(l+o),r,o),c.fillRect(e*r+l,(i-t)*a,o,l),c.fillRect(e*r+r-(l+o),(i-t)*a,o,l),c.fillRect(e*r+l,(i-t)*a+a-(l+o),o,l+o),c.fillRect(e*r+r-(l+o),(i-t)*a+a-(l+o),o,l+o))})}}e.width=t.clientWidth,e.height=t.clientHeight;let p=[],g=[],f=[],y=[];f.sort((e,t)=>e.index-t.index),f.forEach((e,t)=>{if(m[e.index]){let t=(p.length+1)*a,n=m[e.index].allIndexes.filter(e=>-1==y.findIndex(t=>t.index==e%l));if(e.index+1==XB.size){let t=(0==p.length?0:p.length*a)-a/2;p.push({newPosition:{x:0,y:t},color:m[e.index].weftColor,indexData:n,weftIndex:e.index})}else p.push({newPosition:{x:0,y:e.index*a+a/2-t},color:m[e.index].weftColor,indexData:n,weftIndex:e.index})}if(0==e.index){const t=c.getImageData(0,0,d.width,a/2);c.clearRect(0,e.index*a+(p.length-1)*a,d.width,a),c.putImageData(t,0,e.index*a+p.length*a)}else{const t=c.getImageData(0,0,d.width,e.index*a);c.clearRect(0,0,d.width,(e.index+1)*a),c.putImageData(t,0,a)}}),p.forEach(e=>{e.newPosition.y=e.newPosition.y+a*p.length,e.weftIndex+1==XB.size&&p.length>1&&(e.newPosition.y=e.newPosition.y-(p.length-1)*a)}),p.forEach((e,t)=>{c.fillStyle=e.color,e.indexData.forEach(t=>{c.fillRect(t%l*r,e.newPosition.y,r,a)}),e.weftIndex+1!=XB.size&&0!=e.weftIndex||(e.indexData.forEach(e=>{c.fillRect(parseInt(e%l)*r,d.height-a/2,r,a)}),c.clearRect(0,0,d.width,p.length*a)),t==p.length-1&&c.clearRect(0,0,d.width,p.length*a)}),console.log("Extra warp cells is",y);let v=!1;y.sort((e,t)=>e.index-t.index),y.forEach((e,t)=>{if(h[e.index]){let t=g.length*r;t=0;let n=h[e.index].allIndexes.filter(e=>-1==f.findIndex(t=>t.index==parseInt(e/l)));if(0==e.index){let t=(KB.size-1)*r-(0==g.length?0:g.length*r)-r/2;g.push({newPosition:{x:t,y:0},color:h[e.index].warpColor,indexData:n,warpIndex:e.index})}else g.push({newPosition:{x:e.index*r-r/2-t,y:0},color:h[e.index].warpColor,indexData:n,warpIndex:e.index})}let n=1==g.length?0:(g.length-1)*r;const i=c.getImageData((e.index+1)*r-n,0,FE.width,FE.height);if(e.index+1==KB.size){const t=c.getImageData(0,0,r/2,d.height);c.clearRect(e.index*r-n,0,d.width,d.height),c.putImageData(t,e.index*r-n,0),v=!0}else c.clearRect(e.index*r-n,0,d.width,d.height),c.putImageData(i,e.index*r-n,0)}),g.forEach((e,t)=>{e.newPosition.x=e.newPosition.x-r*t,0==e.warpIndex&&(e.newPosition.x=e.newPosition.x-(g.length-1)*r)}),console.log("croppedExtraWarpCanvasInfo in simulation model is",g),console.log("croppedFunctionCanvasInfo in simulation model is",p);let b=p.length>0?Math.max(...p.map(e=>e.weftIndex)):0;parseInt(u),g.forEach(e=>{c.fillStyle=e.color,e.indexData.forEach(t=>{c.fillRect(e.newPosition.x,parseInt(t/l)*a+(parseInt(t/l)<=b?p.length*a:0),r,a)}),0==e.warpIndex&&(e.indexData.forEach(e=>{c.fillRect(-r/2,parseInt(e/l)*a+p.length*a,r,a)}),c.clearRect(d.width-g.length*r,0,g.length*r,d.height))});const w=new Uint32Array(aL.memory.buffer,WB.click_cells(),WB.click_dentgrid_length()),E={};for(let e=0;e<w.length;e++)if(w[e]>0){let t=0;for(let n=Object.keys(E).length>0?Object.keys(E)[Object.keys(E).length-1]:0;n<e&&0==w[n];n++)t++;E[e+1]=w[e]+t}console.log("clickedsad",E,w);let I=0;Object.keys(E).forEach((e,t)=>{console.log("inside cliockasdasd",e,E[e]);const n=document.createElement("canvas"),l=n.getContext("2d");n.height=d.height,n.width=d.width-e*r-I*r,l.drawImage(d,e*r+I*r,0,d.width-e*r-I*r,d.height,0,0,n.width,n.height);const i=document.createElement("canvas"),o=i.getContext("2d");i.height=d.height,i.width=I*r+e*r,o.drawImage(d,0,0,I*r+e*r,d.height,0,0,i.width,i.height);const s=document.createElement("canvas"),u=s.getContext("2d");s.width=E[e]*r,s.height=d.height,XB.cells.forEach(t=>{u.fillStyle=Qm[t.color_code],u.fillRect(0,t.index*a,E[e]*r,a)}),d.width=d.width+E[e]*r,c.clearRect(0,0,d.width,d,a),c.drawImage(i,0,0,i.width,i.height),c.drawImage(s,i.width,0,s.width,s.height),n.width>0&&c.drawImage(n,i.width+s.width,0,n.width,n.height),I+=E[e]});const S=document.createElement("canvas"),k=S.getContext("2d");if(S.width=d.width-g.length*r,S.height=d.height-p.length*a,console.log("removeWhiteAreaCanvas height is",S.height,S.width),k.drawImage(d,v&&parseInt(u)<=2?r/2:0,p.length*a,S.width,S.height,0,0,S.width,S.height),c.clearRect(0,0,d.width,d.height),d.height=S.height,d.width=S.width,c.drawImage(S,0,0),d.width>t.clientWidth&&d.height>t.clientHeight||Cp==Ep)n.drawImage(d,0,d.height-e.height,e.width,e.height,0,0,e.width,e.height);else{const t=n.createPattern(d,"repeat");n.rect(0,0,e.width,e.height),n.fillStyle=t,n.fill(),n.drawImage(d,0,0)}},Mp=()=>{console.log("open model clicked"),Ol("simulation-model"),nv(),0==Rp&&$p(),yp.style.display="block",yp.style.animation="slide-down 0.3s ease",Cp!=wp&&(xp.value=Ip,Dp({target:{value:Ip}}))},Op=()=>{Ol(""),yp.style.display="none"},Dp=e=>{let t=e.target.value;Cp=t;let n=document.querySelectorAll(".print-selection-show-hide-part");Cp==wp?(Lp.style.display="flex",n.forEach(e=>{e.classList.remove("none")}),Hp()):(Lp.style.display="none",n.forEach(e=>{e.classList.add("none")}),Fp())},Wp=e=>{console.log("e.radsa",e.target.value),Np=e.target.value,Cp==wp?Hp():Fp()},Hp=(e=!1)=>{let t=document.querySelector("#design-selection-input-part-1");console.log("first element is",t);const n=t.querySelector("#start-x"),l=t.querySelector("#end-x"),i=t.querySelector("#start-y"),r=t.querySelector("#end-y");if(0==l.value&&(l.value=40),0==r.value&&(r.value=40),0!=n.value||0!=i.value||0!=l.value||0!=r.value){console.log("inside if condition");const t=document.getElementById("simulation-model-canvas"),a=(yp.querySelector(".simulation-canvas-container"),t.getContext("2d"));a.clearRect(0,0,t.width,t.height);const o=AB.cols(),s=AB.rows();let d,c;d=e?1080:Math.min(Math.abs(Number(n.value)-Number(l.value)),o),c=Math.min(Math.abs(Number(i.value)-Number(r.value)),s);let u=((e,t)=>{let n={};const l=new Uint32Array(aL.memory.buffer,WB.cells(),WB.selected_dentgrid_length());let i=1,r={};for(let e=0;e<l.length;e++){let t=1,a=e;for(;l[e]==l[e+1];)t++,e++;for(let e=0;e<t;e++)r[e+a]=t,n[e+a]=Math.ceil(20/t);t>i&&(i=t)}return n})();const m=10;let h=Object.values(u).reduce((e,t)=>e+t,0);h=0;let p,g=m*c,f=Ap(d,c,0,g)>10?Ap(d,c,0,g):10;if(e){f=parseInt(1080/d)}if(e)p=f*AB.height()/Rl;else{let e=f,t=e*Rl/AB.height();p=Math.ceil(e),f=Math.ceil(t)}console.log("simulation-model-trigger maingridasdas",AB.height(),p,Rl),t.width=Math.ceil(d*f)+h,t.height=Math.ceil(c*p),a.clearRect(0,0,t.width,t.height),a.fillStyle="white",a.fillRect(0,0,t.width,t.height),a.fillStyle="black";let y={},v={};for(let e=0;e<d;e++){let t=new Uint32Array(aL.memory.buffer,AB.get_col_new_cell(e%o),AB.get_col_new_cell_length(e%o)),n=Array.from({length:c},(e,t)=>t+1);if(Np==Sp&&(t.forEach(t=>{let l=KB.cells.find(t=>t.index==e%o);l&&(a.fillStyle=Lr[l.color_code],a.fillRect(e*f,(c-t)*p,f,p)),n=n.filter(e=>e!=t)}),n.forEach(t=>{let n=XB.cells.find(e=>e.index==c-t);n&&(a.fillStyle=Qm[n.color_code],a.fillRect(e*f,(c-t)*p,f,p))})),Np==kp){let l=10,i=Uv(u[e],u);l=1,i=1;let r=0;t.forEach(t=>{let o=KB.cells.find(t=>t.index==e),s=XB.cells.find(e=>e.index==c-t);o&&(a.fillStyle=Lr[o.color_code],a.fillRect(e*f+i+r,(c-t)*p,f-2*(i+r),p)),s&&(a.fillStyle=Qm[s.color_code],a.fillRect(e*f,(c-t)*p+l+r,i,p-2*(l+r)),a.fillRect(e*f+f-i,(c-t)*p+l+r,i,p-2*(l+r)),a.fillStyle="black",a.fillRect(e*f+i,(c-t)*p,r,p),a.fillRect(e*f+f-(i+r),(c-t)*p,r,p),a.fillRect(e*f,(c-t)*p+l,i,r),a.fillRect(e*f+f-i,(c-t)*p+l,i,r),a.fillRect(e*f,(c-t)*p+p-(l+r),i,r),a.fillRect(e*f+f-i,(c-t)*p+p-(l+r),i,r)),n=n.filter(e=>e!=t)}),n.forEach(t=>{let n=XB.cells.find(e=>e.index==c-t),o=KB.cells.find(t=>t.index==e%KB.size);n&&(a.fillStyle=Qm[n.color_code],a.fillRect(e*f,(c-t)*p+(l+r),f,p-2*(l+r))),o&&(a.fillStyle=Lr[o.color_code],a.fillRect(e*f+i+r,(c-t)*p,f-2*(i+r),l+r),a.fillRect(e*f+i+r,(c-t)*p+p-l,f-2*(i+r),l+r),a.fillStyle="black",a.fillRect(e*f,(c-t)*p+l,f,r),a.fillRect(e*f,(c-t)*p+p-(l+r),f,r),a.fillRect(e*f+i,(c-t)*p,r,l),a.fillRect(e*f+f-(i+r),(c-t)*p,r,l),a.fillRect(e*f+i,(c-t)*p+p-(l+r),r,l+r),a.fillRect(e*f+f-(i+r),(c-t)*p+p-(l+r),r,l+r))})}}if(!1){let e=[],n=[],l=YB.cells,i=JB.cells;console.log("function Cell mapping data is",y),console.log("Extra warp cell mapping",v),console.log("function ceells are",l),l.sort((e,t)=>e.index-t.index),l.forEach((n,l)=>{if(y[n.index]){let t=(e.length+1)*p,l=y[n.index].allIndexes.filter(e=>-1==i.findIndex(t=>t.index==e%d));if(n.index+1==XB.size){let t=(0==e.length?0:e.length*p)-p/2;e.push({newPosition:{x:0,y:t},color:y[n.index].weftColor,indexData:l,weftIndex:n.index})}else e.push({newPosition:{x:0,y:n.index*p+p/2-t},color:y[n.index].weftColor,indexData:l,weftIndex:n.index})}if(0==n.index){console.log("height/2 is",p/2);const l=a.getImageData(0,0,t.width,p/2);a.clearRect(0,n.index*p+(e.length-1)*p,t.width,p),a.putImageData(l,0,n.index*p+e.length*p)}else{const e=a.getImageData(0,0,t.width,n.index*p);a.clearRect(0,0,t.width,(n.index+1)*p),a.putImageData(e,0,p)}}),e.forEach(t=>{t.newPosition.y=t.newPosition.y+p*e.length,t.weftIndex+1==XB.size&&e.length>1&&(t.newPosition.y=t.newPosition.y-(e.length-1)*p)}),e.forEach((n,l)=>{a.fillStyle=n.color,n.indexData.forEach(e=>{a.fillRect(e%d*f,n.newPosition.y,f,p)}),n.weftIndex+1!=XB.size&&0!=n.weftIndex||(n.indexData.forEach(e=>{a.fillRect(parseInt(e%d)*f,t.height-p/2,f,p)}),a.clearRect(0,0,t.width,e.length*p)),l==e.length-1&&a.clearRect(0,0,t.width,e.length*p)}),i.sort((e,t)=>e.index-t.index),i.forEach((e,i)=>{if(v[e.index]){let t=n.length*f;t=0;let i=v[e.index].allIndexes.filter(e=>-1==l.findIndex(t=>t.index==parseInt(e/d)));if(console.log("extraWarpCells filteredIndex os",i),0==e.index){let t=(KB.size-1)*f-(0==n.length?0:n.length*f)-f/2;n.push({newPosition:{x:t,y:0},color:v[e.index].warpColor,indexData:i,warpIndex:e.index})}else n.push({newPosition:{x:e.index*f-f/2-t,y:0},color:v[e.index].warpColor,indexData:i,warpIndex:e.index})}let r=1==n.length?0:(n.length-1)*f;const o=a.getImageData((e.index+1)*f-r,0,t.width,t.height);if(e.index+1==KB.size){const n=a.getImageData(0,0,f/2,t.height);a.clearRect(e.index*f-r,0,t.width,t.height),a.putImageData(n,e.index*f-r,0)}else a.clearRect(e.index*f-r,0,t.width,t.height),a.putImageData(o,e.index*f-r,0)}),n.forEach((e,t)=>{e.newPosition.x=e.newPosition.x-f*t,0==e.warpIndex&&(e.newPosition.x=e.newPosition.x-(n.length-1)*f)});let r=e.length>0?Math.max(...e.map(e=>e.weftIndex)):0;console.log("maxweftIndex ius",r),console.log("croppedExtraWarpCanvasInfo is",n),console.log("croppedFunctionCanvasInfo is",e),n.forEach(l=>{a.fillStyle=l.color,l.indexData.forEach(t=>{a.fillRect(l.newPosition.x,parseInt(t/d)*p+(parseInt(t/d)<=r?e.length*p:0),f,p)}),0==l.warpIndex&&(l.indexData.forEach(t=>{a.fillRect(-f/2,parseInt(t/d)*p+e.length*p,f,p)}),a.clearRect(t.width-n.length*f,0,n.length*f,t.height))})}}},$p=()=>{let e=document.getElementById("design-selection-input-part-parent");const t=`<div id="design-selection-input-part-${Rp+1}" class="design-selection-input-part-class">\n  <div style="display:flex;flex-direction:row;justify-content:space-between;margin-top:10px;">\n    <div>Starting</div>\n    <div><input type="number" value="0" id="start-x" style="width:50px;margin-right:15px;"/><input type="number" value="0" id="start-y" style="width:50px;"/></div>\n  </div>\n\n  <div style="display:flex;flex-diretion:row;justify-content:space-between;margin-top:10px;">\n  <div>End</div>\n  <div><input type="number" value="0" id="end-x" style="width:50px;margin-right:15px;"/><input type="number" value="0" style="width:50px;" id="end-y"/></div>\n</div>\n\n</div><hr style="margin-top:10px;"/>`;e.innerHTML+=t,Rp++,console.log("clicked")},qp=()=>{if(Cp==wp){Hp();let e=document.getElementById("simulation-model-canvas");$(e).printThis({canvas:!0})}else{let e=document.getElementById("simulation-model-canvas");$(e).printThis({canvas:!0})}},jp=()=>{Cp==wp&&Hp()},Vp="https://api.maxweave.com/v1",zp=()=>{let e=localStorage.getItem("company"),t=bb(e)&&JSON.parse(e).allFeatures?JSON.parse(e).allFeatures:[];if(Array.isArray(t)){let e=[];t.forEach(t=>{let n=t.featureMapping?t.featureMapping:[],l=t.shortcutKeys?t.shortcutKeys:[];if(n.forEach(n=>{const l=n.domId,i=String(n.displayType).trim(),r=document.getElementById(String(l));-1==e.findIndex(e=>e==l)&&(r?t.isActiveForCurrentUser?(r.style.display=i,e.push(l)):r.style.display="none":console.log("not find",l))}),t.isActiveForCurrentUser&&n[0]&&n[0].domId){const e=n[0].domId,t=document.getElementById(String(e));l.forEach(e=>{const n=e.firstKey,l=e.secondKey;n&&l&&document.addEventListener("keydown",e=>{((e,t)=>"ctrl"==t?e.ctrlKey:"shift"==t?e.shiftKey:"alt"==t&&e.altKey)(e,n)&&e.key.toLowerCase()==l.toLowerCase()&&(e.preventDefault(),t.click())})})}})}Dm(),rI(),TB.style.display="none"},Up=document.getElementById("dropdown-item-print-preview"),Yp=document.getElementById("print-preview-model"),Jp=document.getElementById("print-preview-header-trigger");let Gp={isHeaderVisible:!0,isFRSRVisible:!0,isDetailsVisible:!0,isDraftVisible:!0,isSimulationVisible:!1,isPegplanVisible:!0,isWarpingSectionVisible:!1,isWarpWeftPatternVisible:!1,isNotesVisible:!1,isWarpWeftInfoVisible:!1,isDentVisible:!0,isEndsVisible:!0,isSalvageVisible:!0,isPatternVisible:!0,isPartVisible:!1,isTotalVisible:!0,isYarnNameVisible:!1,isFullReedSpaceVisible:!1,isTwoPickLetisEnabled:!0,pegplanViewType:fl.GRAPHICALYESWITHNUMERICYES,pegplanSorting:xl,isInvertDesign:!1,isUncompreesed:!1,isWeftSelector:!1,isCreaming:!1,isOuterRepeatVisible:!0,isInnerRepeatVisible:!0,isVerticalPattern:!1,isDencity:!1,removeShaftElement:[],unCompressDents:[]};const Xp=()=>{document.getElementById("print-design-draft-container").innerHTML=jg(),Kp()},Kp=()=>{document.querySelectorAll(".dentColumn").forEach(e=>{e.style.display=Gp.isDentVisible?"table-cell":"none"}),document.querySelectorAll(".endsColumn").forEach(e=>{e.style.display=Gp.isEndsVisible?"table-cell":"none"}),document.querySelectorAll(".salvageColumn").forEach(e=>{e.style.display=Gp.isSalvageVisible?"table-row":"none"}),document.querySelectorAll(".patternColumn").forEach(e=>{e.style.display=Gp.isPatternVisible?"table-cell":"none"}),document.querySelectorAll(".secondRepeatColumn").forEach(e=>{e.style.display=Gp.isOuterRepeatVisible?"table-cell":"none"}),document.querySelectorAll(".firstRepeatColumn").forEach(e=>{e.style.display=Gp.isInnerRepeatVisible?"table-cell":"none"}),document.querySelectorAll(".designTypeColumn").forEach(e=>{e.style.display=Gp.isPartVisible?"table-cell":"none"}),document.querySelectorAll(".totalRow").forEach(e=>{e.style.display=Gp.isTotalVisible?"table-row":"none"}),document.querySelectorAll(".frsrColumn").forEach(e=>{e.style.display=Gp.isFRSRVisible&&Gp.isFullReedSpaceVisible?"table-cell":"none"}),Xg()},Zp=e=>{console.log("check box value changed",e.target.checked);let t=e.target.id,n=e.target.checked;if("sidebar-checkbox-header"==t){Gp.isHeaderVisible=n;let e=document.getElementById("print-company-details");cu("isHeaderVisible",n),e.style.display=n?"flex":"none",Gp.isSimulationVisible&&ag()}else if("sidebar-checkbox-details"==t){Gp.isDetailsVisible=n;let e=document.getElementById("print-design-details");cu("isDetailsVisible",n),e.style.display=n?"flex":"none",Gp.isSimulationVisible&&ag()}else if("sidebar-checkbox-draft"==t){Gp.isDraftVisible=n,cu("isDraftVisible",n);let e=document.getElementById("print-design-draft"),t=document.getElementById("draft-title");e.style.display=n?"block":"none",t.style.display=n?"block":"none"}else if("sidebar-checkbox-simulation"==t){Gp.isSimulationVisible=n,cu("isSimulationVisible",n),document.getElementById("print-design-simulation").style.display=n?"block":"none",rg(),n&&ag()}else if("sidebar-checkbox-pegplan"==t){Gp.isPegplanVisible=n;let e=document.getElementById("print-design-pegplan-container");cu("isPegplanVisible",n),e.style.display=n?"flex":"none"}else if("sidebar-checkbox-warping-section"==t)cu("isWarpingSectionVisible",n),Gp.isWarpingSectionVisible=n;else if("sidebar-checkbox-warp-weft-pattern"==t){Gp.isWarpWeftPatternVisible=n;let e=document.getElementById("warp-weft-pattern-container");cu("isWarpWeftPatternVisible",n),e.style.display=n?"block":"none"}else if("sidebar-checkbox-warp-weft-info"==t){Gp.isWarpWeftInfoVisible=n;let e=document.getElementById("print-warp-weft-info");cu("isWarpWeftInfoVisible",n),e.style.display=n?"grid":"none",Gp.isSimulationVisible&&ag()}else if("sidebar-checkbox-notes"==t){Gp.isNotesVisible=n;let e=document.querySelector(".design-notes-container");cu("isNotesVisible",n),e.style.display=Gp.isNotesVisible?"block":"none"}else if("sidebar-checkbox-dent"==t)Gp.isDentVisible=n,cu("isDentVisible",n),Kp();else if("sidebar-checkbox-ends"==t)Gp.isEndsVisible=n,cu("isEndsVisible",n),Kp();else if("sidebar-checkbox-salvage"==t){Gp.isSalvageVisible=n,cu("isSalvageVisible",n),Xp(),document.querySelectorAll(".salvageColumn").forEach(e=>{e.style.display=n?"table-row":"none"})}else if("sidebar-checkbox-pattern"==t)Gp.isPatternVisible=n,cu("isPatternVisible",n),Kp();else if("sidebar-checkbox-outerrepeat"==t){Gp.isOuterRepeatVisible=n,cu("isOuterRepeatVisible",n),document.querySelectorAll(".secondRepeatColumn").forEach(e=>{e.style.display=n?"table-cell":"none"})}else"sidebar-checkbox-innerrepeat"==t?(Gp.isInnerRepeatVisible=n,cu("isInnerRepeatVisible",n),Kp()):"sidebar-checkbox-yarnname"==t?(Gp.isYarnNameVisible=n,cu("isYarnNameVisible",n),Xp()):"sidebar-checkbox-vertical-pattern"==t?(Gp.isVerticalPattern=n,cu("isVerticalPattern",n),Xp()):"sidebar-checkbox-twopickletis"==t?(Gp.isTwoPickLetisEnabled=n,cu("isTwoPickLetisEnabled",n),Qp()):"sidebar-checkbox-total"==t?(Gp.isTotalVisible=n,cu("isTotalVisible",n),Xp()):"sidebar-checkbox-frsr"==t?(Gp.isFullReedSpaceVisible=n,cu("isFullReedSpaceVisible",n),Xp()):"sidebar-checkbox-frsrvisibility"==t?(Gp.isFRSRVisible=n,cu("isFRSRVisible",n),Kp()):"sidebar-checkbox-weftselector"==t?(Gp.isWeftSelector=n,cu("isWeftSelector",n),Qp()):"sidebar-checkbox-creaming"==t?(Gp.isCreaming=n,cu("isCreaming",n),Qp()):"sidebar-checkbox-dencity"==t?(Gp.isDencity=n,cu("isDencity",n),Qp()):"sidebar-checkbox-invertdesign"==t?(Gp.isInvertDesign=n,cu("isInvertDesign",n),Qp()):"sidebar-checkbox-uncompressed"==t&&(Gp.isUncompreesed=n,cu("isUncompreesed",n),Qp())},Qp=()=>{let e=document.getElementById("print-design-pegplan-container"),t=ib();e.innerHTML=zg(t),Gp.pegplanViewType==fl.WATERJETLETIS?Yg(t):Gp.pegplanViewType!=fl.GRAPHICALNOWITHNUMERICNO&&Ug(t)},eg=e=>{console.log("handlePegplanTypeChange");document.getElementById("print-design-pegplan-container");let t=e.target.value;cu("pegplanViewType",t),Gp.pegplanViewType=t,tg(t),Qp()},tg=e=>{let t=document.getElementById("sidebar-checkbox-twopickletis"),n=document.getElementById("sidebar-checkbox-uncompressed"),l=document.getElementById("sidebar-checkbox-weftselector"),i=document.getElementById("sidebar-checkbox-creaming");e==fl.GRAPHICALNOWITHNUMERICNO?(Gp.isTwoPickLetisEnabled=!0,t.checked=!0,t.disabled=!0,n.disabled=!1):e==fl.WATERJETLETIS?(Gp.isTwoPickLetisEnabled=!0,Gp.isUncompreesed=!0,Gp.isCreaming=!1,Gp.isWeftSelector=!1,t.disabled=!0,n.checked=!0,n.disabled=!0,l.disabled=!0,i.disabled=!0):(t.disabled=!1,n.disabled=!1,l.disabled=!1,i.disabled=!1)},ng=e=>{let t=e.target.value;Gp.pegplanSorting=t,cu("pegplanSorting",t),Qp()},lg=e=>{if(e.srcElement){console.log(e.srcElement.style),-1==Gp.removeShaftElement.findIndex(t=>t==Number(e.srcElement.innerText))?(Gp.removeShaftElement.push(Number(e.srcElement.innerText)),e.srcElement.style.backgroundColor="red"):(Gp.removeShaftElement=Gp.removeShaftElement.filter(t=>t!=Number(e.srcElement.innerText)),e.srcElement.style.backgroundColor="gainsboro"),cu("removeShaftElement",JSON.stringify(Gp.removeShaftElement)),Qp()}},ig=e=>{if(e.srcElement){-1==Gp.unCompressDents.findIndex(t=>t==Number(e.srcElement.innerText))?(Gp.unCompressDents.push(Number(e.srcElement.innerText)),e.srcElement.style.backgroundColor="red"):(Gp.unCompressDents=Gp.unCompressDents.filter(t=>t!=Number(e.srcElement.innerText)),e.srcElement.style.backgroundColor="gainsboro"),Xp()}},rg=()=>{document.getElementById("design-details-table-container").innerHTML=Og.map(e=>`<div class="print-details-table-container"><div>${e.label}</div><div style="border:none;width:auto;">:</div><div ${"totalEnds"==e.key?"id=designHeader-totalEnds":""}>${e.value}</div></div>`).join("")},ag=()=>{if(!Gp.isSimulationVisible)return;let e=document.querySelector("#design-selection-input-part-1");console.log("first element is",e);e.querySelector("#start-x");const t=e.querySelector("#end-x"),n=(e.querySelector("#start-y"),e.querySelector("#end-y"));t.value=200,n.value=200,Hp(!0),t.value=40,n.value=40;const l=document.getElementById("simulation-model-canvas");if(0==l.height||0==l.width)return;const i=l.getContext("2d"),r=document.getElementById("print-design-simulation-canvas"),a=r.getContext("2d");let o=document.getElementById("print-design-simulation");o.style.height=(()=>{let e=document.getElementById("print-company-details"),t=document.getElementById("print-design-details"),n=document.getElementById("print-warp-weft-info"),l=1520-e.clientHeight-n.clientHeight-t.clientHeight;return parseInt(l-140)})()+"px",r.height=o.offsetHeight,r.width=o.offsetWidth;const s=i.getImageData(0,0,l.width,l.height);let d=Math.ceil(r.height/s.height);for(let e=0;e<d;e++)a.putImageData(s,0,e*s.height);console.log("printSimulationCanvas is",r)};const og=()=>{Kg(fl.GRAPHICALNOWITHNUMERICNO,!1),zp();document.querySelectorAll(".printpreview-sidebar-checkbox").forEach(e=>{e.removeEventListener("change",Zp),e.addEventListener("change",Zp)}),document.getElementById("print-company-details").style.display=Gp.isHeaderVisible?"flex":"none",document.getElementById("print-design-details").style.display=Gp.isDetailsVisible?"flex":"none",document.getElementById("print-design-draft").style.display=Gp.isDraftVisible?"block":"none",document.getElementById("print-design-simulation").style.display=Gp.isSimulationVisible?"block":"none",document.getElementById("print-pegplan-section").style.display=Gp.isPegplanVisible?"block":"none",document.getElementById("warp-weft-pattern-container").style.display=Gp.isWarpWeftPatternVisible?"block":"none",document.getElementById("print-warp-weft-info").style.display=Gp.isWarpWeftInfoVisible?"grid":"none",document.querySelector(".design-notes-container").style.display=Gp.isNotesVisible?"block":"none",Kp(),rg(),ag();const e=document.getElementById("printpreview-pegplan-view");e.removeEventListener("change",eg),e.addEventListener("change",eg);const t=document.getElementById("printpreview-pegplan-sorting");t.removeEventListener("change",ng),t.addEventListener("change",ng);document.querySelectorAll(".printpreview-remove-shaft-number").forEach(e=>{-1!=Gp.removeShaftElement.findIndex(t=>t==Number(e.innerHTML))&&(e.style.backgroundColor="red"),e.removeEventListener("click",lg),e.addEventListener("click",lg)});document.querySelectorAll(".printpreview-uncompress-dent").forEach(e=>{e.removeEventListener("click",ig),e.addEventListener("click",ig)}),e.value=Gp.pegplanViewType,eg({target:{value:Gp.pegplanViewType}}),document.getElementById("print-button").addEventListener("click",async()=>{let e=document.getElementById("print-item"),t=".";for(let e=0;e<160;e++)t+="";$(e).printThis({canvas:!0,beforePrint:()=>{document.title=Ld.innerText+" Production Sheet";let t=document.createElement("div");t.innerText="maxweave",t.style.paddingBottom="3px",t.classList.add("print-footer-maxweave"),e.appendChild(t)},pageTitle:t+Ld.innerText,afterPrint:()=>{document.title="Maxweave";let e=document.getElementsByClassName("print-footer-maxweave");console.log("print footer items ",e);for(let t=0;t<e.length;t++)e.item(t).parentElement.removeChild(e.item(t))}})})},sg=()=>{document.querySelectorAll(".close-button");fo(Up,Yp,0,!1,"Print Preview"),fo(Jp,Yp,0,!1,"Print Preview");let e=(()=>{let e=localStorage.getItem("printSettings");return e?JSON.parse(e):{}})();Object.keys(e).forEach(t=>{bb(e[t])?Gp[t]=JSON.parse(e[t]):Gp[t]=e[t]})},dg=()=>{let e=FB.convert_new_index_to_numeric(WB),t=mb(e),n=FB.rows(),l=String(t).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e).length);return l=[...new Set([...l])].sort(),`\n  <div class="print-preview-sidebar">\n    <div class="print-preview-sidebar-container">\n      <div class="print-preview-sidebar-container-header">Part</div>\n      <div class="print-preview-sidebar-container-content">\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-header" ${Gp.isHeaderVisible?"checked":""}/>\n          <label for="sidebar-checkbox-header">Company Info</label>\n        </div>\n\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" ${Gp.isDetailsVisible?"checked":""} id="sidebar-checkbox-details" />\n          <label for="sidebar-checkbox-details">Details</label>\n        </div>\n\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-draft" ${Gp.isDraftVisible?"checked":""}/>\n          <label for="sidebar-checkbox-draft">Draft</label>\n        </div>\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-simulation" ${Gp.isSimulationVisible?"checked":""}/>\n          <label for="sidebar-checkbox-simulation">Simulation</label>\n        </div>\n\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-pegplan" ${Gp.isPegplanVisible?"checked":""}/>\n          <label for="sidebar-checkbox-pegplan">Pegplan</label>\n        </div>\n\n        <div style="display:none;">\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-warping-section" ${Gp.isWarpingSectionVisible?"checked":""}/>\n          <label for="sidebar-checkbox-warping-section">Warping Section</label>\n        </div>\n\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-warp-weft-pattern" ${Gp.isWarpWeftPatternVisible?"checked":""}/>\n          <label for="sidebar-checkbox-warp-pattern">Warp/Weft Pattern</label>\n        </div>\n\n  \n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-warp-weft-info" ${Gp.isWarpWeftInfoVisible?"checked":""}/>\n          <label for="sidebar-checkbox-warp-weft-info">Warp/Weft Info</label>\n        </div>\n\n        <div>\n        <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-notes" ${Gp.isNotesVisible?"checked":""}/>\n        <label for="sidebar-checkbox-notes">Notes</label>\n      </div>\n      </div>\n    </div>\n    <div class="print-preview-sidebar-container">\n      <div class="print-preview-sidebar-container-header">Draft Properties</div>\n      <div class="print-preview-sidebar-container-content">\n      <div>\n      <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-innerrepeat" ${Gp.isInnerRepeatVisible?"checked":""}/>\n      <label for="sidebar-checkbox-innerrepeat">Inner Repeat</label>\n    </div>\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-outerrepeat" ${Gp.isOuterRepeatVisible?"checked":""}/>\n          <label for="sidebar-checkbox-outerrepeat">Outer Repeat</label>\n        </div>\n\n        \n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-dent" ${Gp.isDentVisible?"checked":""}/>\n          <label for="sidebar-checkbox-dent">Dent</label>\n        </div>\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-ends" ${Gp.isEndsVisible?"checked":""}/>\n          <label for="sidebar-checkbox-ends">Ends</label>\n        </div>\n\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-salvage" ${Gp.isSalvageVisible?"checked":""}/>\n          <label for="sidebar-checkbox-salvage">Selvedge</label>\n        </div>\n       \n       \n      <div>\n      <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-pattern" ${Gp.isPatternVisible?"checked":""}/>\n      <label for="sidebar-checkbox-pattern">Pattern</label>\n    </div>\n        <div style="padding-left:6px;">\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-yarnname" ${Gp.isYarnNameVisible?"checked":""}/>\n          <label for="sidebar-checkbox-yarnname">Yarn Name</label>\n        </div>\n        <div style="padding-left:6px;">\n        <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-vertical-pattern" ${Gp.isVerticalPattern?"checked":""}/>\n        <label for="sidebar-checkbox-vertical-pattern">Vertical Pattern</label>\n       </div>\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-total" ${Gp.isTotalVisible?"checked":""}/>\n          <label for="sidebar-checkbox-total">Total</label>\n        </div>\n        <div>\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-frsr" ${Gp.isFullReedSpaceVisible?"checked":""}/>\n          <label for="sidebar-checkbox-frsr">Full Reed Space Repeat</label>\n        </div>\n        <div style="padding-left:6px;">\n          <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-frsrvisibility" ${Gp.isFRSRVisible?"checked":""}/>\n          <label for="sidebar-checkbox-frsrvisibility">FRSR</label>\n        </div>\n      </div>\n      \n    </div>\n    <div class="print-preview-sidebar-container">\n    <div class="print-preview-sidebar-container-header">\n      Remove Shaft In Pegplan\n    </div>\n    <div class="print-preview-sidebar-container-content">${(e=>{let t="";for(let n=0;n<e;n++)t+=`<div class="printpreview-remove-shaft-number">${n+1}</div>`;return'<div class="printpreview-removeshaft-container">'+t+"</div>"})(n)}</div>\n  </div>\n    <div class="print-preview-sidebar-container">\n      <div class="print-preview-sidebar-container-header">Pegplan View</div>\n\n      <div class="print-preview-sidebar-container-content">\n        <select\n          type="text"\n          name="printpreview-pegplan-view"\n          id="printpreview-pegplan-view"\n          onchange=""\n        >\n          <option value="${fl.GRAPHICALYESWITHNUMERICNO}">Graphic</option>\n          <option value="${fl.GRAPHICALNOWITHNUMERICNO}">Numeric</option>\n          <option value=${fl.GRAPHICALNOWITHNUMERICYES}>Num Table</option>\n          <option value=${fl.GRAPHICALYESWITHNUMERICYES}>Graphic + Num</option>\n          <option value=${fl.WATERJETLETIS}>Waterjet</option>\n        </select>\n\n        <select\n          type="text"\n          name="printpreview-pegplan-sorting"\n          id="printpreview-pegplan-sorting"\n          \n       \n        >\n          <option ${Gp.pegplanSorting==xl?"selected":""} value=${xl}>Ascending </option>\n          <option ${Gp.pegplanSorting==Tl?"selected":""} value=${Tl}>Descending</option>\n       \n        </select>\n      </div>\n    </div>\n    <div class="print-preview-sidebar-container" >\n      <div class="print-preview-sidebar-container-header">\n        Uncompress Dent\n      </div>\n      <div class="print-preview-sidebar-container-content">${(e=>{if(Array.isArray(e)){let t="";for(let n=0;n<e.length;n++)t+=`<div class="printpreview-uncompress-dent">${e[n]}</div>`;return'<div class="printpreview-uncompress-dent-container">'+t+"</div>"}})(l)}</div>\n    </div>\n    <div class="print-preview-sidebar-container" id="sidebar-checkbox-weftselector-ele" style="display: none;">\n    <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-weftselector" ${Gp.isWeftSelector?"checked":""}/>\n    <label for="sidebar-checkbox-weftselector">Weft Selector</label>\n  </div>\n  <div class="print-preview-sidebar-container" id="sidebar-checkbox-creaming-ele" style="display: none;">\n  <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-creaming" ${Gp.isCreaming?"checked":""}/>\n  <label for="sidebar-checkbox-creaming">Creaming</label>\n</div>\n<div class="print-preview-sidebar-container" id="sidebar-checkbox-dencity-ele"  style="display: none;">\n<input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-dencity" ${Gp.isDencity?"checked":""}/>\n<label for="sidebar-checkbox-dencity">Dencity</label>\n</div>\n<div class="print-preview-sidebar-container">\n<input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-twopickletis" ${Gp.isTwoPickLetisEnabled?"checked":""} />\n<label for="sidebar-checkbox-twopickletis">2 Pick Lettis</label>\n</div>\n\n    <div class="print-preview-sidebar-container">\n      <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-invertdesign" ${Gp.isInvertDesign?"checked":""}/>\n      <label for="sidebar-checkbox-invertdesign">Invert Design</label>\n    </div>\n    <div class="print-preview-sidebar-container">\n      <input type="checkbox" class="printpreview-sidebar-checkbox" id="sidebar-checkbox-uncompressed" ${Gp.isUncompreesed?"checked":""}/>\n      <label for="sidebar-checkbox-uncompressed">Uncompressed</label>\n    </div>\n    <div id="print-button">Print</div>\n  </div>\n\n`},cg=()=>'<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">\n    Draft In Part\n  </div>\n  <div class="modal-desc">\n    <div class="add-remove-part-button-container">\n      <button class="btn-submit" type="button" id="draft-in-part-modal-addpart">Add Part</button>\n      <button class="btn-submit" type="button" id="draft-in-part-modal-removepart">Remove Part</button>\n  </div>\n  <div id="all-draft-in-part-parent"></div>\n  <div class="btn-group">\n    <button class="btn-submit" type="button" id="draft-in-part-modal-apply">Apply</button>\n    <button class="btn-submit" type="button" id="draft-in-part-modal-ok">ok</button>\n  </div>\n</div>\n</div>',ug=()=>'<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">\n    Design Draft & Warp Pattern With Part\n  </div>\n<div class="modal-desc">\n  <div id="design-with-part-width"></div>\n  <div class="add-remove-part-button-container">\n  <button class="btn-submit" type="button" id="design-with-part-modal-addpart">Add Part</button>\n  <button class="btn-submit" type="button" id="design-with-part-modal-removepart">Remove Part</button>\n</div>\n  <div class="design-with-part-table-container">\n\n    <table ><tbody id="design-with-part-table"></tbody><tfoot id="design-with-part-table-footer"></tfoot></table>\n  </div>\n\n  <div class="error-message" id="design-with-part-error-message"></div>\n  <div class="btn-group">\n    <button class="btn-submit" type="button" id="design-with-part-modal-apply">Apply</button>\n    <button class="btn-submit" type="button" id="design-with-part-modal-ok">ok</button>\n\n  </div>\n</div>\n</div>',mg=()=>'<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">\n   Open Color Palette\n  </div>\n<div class="modal-desc">\n\n<div class="flex color-paletter-searchbar">\n\n\n<label for="search-open-color-palette">Search</label>\n  <input id="search-open-color-palette" />\n\n</div>\n<div class="flex">\n  <div id="color-palette-data-container"></div>\n  <div id="color-palette-preview-container">\n    <div></div>\n    <div id="color-palette-preview-content" class="flex"></div>\n  </div>\n</div>\n\n \n  <div class="flex file-name-container">\n  <div class="flex">\n  <span>File Name</span>\n  <input readonly id="open-color-palette-file-name" type="text"/>\n  </div>\n   <div>\n   \n   <button class="btn-submit" type="button" id="open-color-palette-modal-ok">Open</button>\n   </div>\n\n  </div>\n</div>\n</div>',hg=()=>'<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">\n    Edit Dencity\n  </div>\n  <div class="modal-desc">\n\n  <div class="dencity-modal-content-parent">\n      <div>\n        <div class="dencity-modal-row-element">\n            <div>No</div>\n            <div>PPI</div>\n        </div>\n        <div class="dencity-modal-row-element">\n            <div>D1</div>\n            <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d1"/></div>\n        </div>\n        <div class="dencity-modal-row-element">\n            <div>D2</div>\n            <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d2"/></div>\n        \n        </div>\n        <div class="dencity-modal-row-element">\n            <div>D3</div>\n            <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d3"/></div>\n        </div>\n        <div class="dencity-modal-row-element">\n            <div>D4</div>\n            <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d4"/></div>\n         </div>\n         <div class="dencity-modal-row-element">\n            <div>D5</div>\n            <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d5"/></div>\n          </div>\n\n          <div class="dencity-modal-row-element">\n              <div>D6</div>\n              <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d6"/></div>\n          </div>\n        \n     \n      </div>\n      <div>\n      <div class="dencity-modal-row-element">\n      <div>No</div>\n      <div>PPI</div>\n  </div>\n  <div class="dencity-modal-row-element">\n      <div>D7</div>\n      <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d7"/></div>\n  </div>\n  <div class="dencity-modal-row-element">\n      <div>D8</div>\n      <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d8"/></div>\n  \n  </div>\n  <div class="dencity-modal-row-element">\n      <div>D9</div>\n      <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d9"/></div>\n  </div>\n  <div class="dencity-modal-row-element">\n      <div>D10</div>\n      <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d10"/></div>\n   </div>\n   <div class="dencity-modal-row-element">\n      <div>D11</div>\n      <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d11"/></div>\n    </div>\n\n    <div class="dencity-modal-row-element">\n        <div>D12</div>\n        <div class="dencity-modal-input-parent"><input class="dencity-modal-input" id="dencity-modal-input-d12"/></div>\n    </div>\n    </div>\n  </div>\n\n  <div class="btn-group">\n  <button class="btn-submit" type="button" id="dencity-modal-apply">Apply</button>\n  <button class="btn-submit" type="button" id="dencity-modal-ok">Ok</button>\n  <button class="btn-submit" type="button" id="dencity-modal-cancel">Cancel</button>\n</div>\n  </div>\n</div>',pg=()=>'<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">\n    Simulation\n  </div>\n  <div class="modal-desc">\n   <div class="simulations-options-container">\n   <select type="text" id="simulation-options-menu">\n    <option value="selected">Selected</option>\n    <option value="single_repeat">Single Repeat</option>\n    <option value="repeat">Repeat</option>  \n  </select>\n\n  <select class="none" type="text" id="simulation-view-type">\n    <option value="color">Color</option>\n    <option value="interlacement">Interlacement</option>\n  </select>\n  <div id="design-selection-parent">\n    <div id="design-selection-input-part-parent" class="print-selection-show-hide-part">\n    </div>\n    <div id="add-start-end-part-button" style="display:flex;justify-content:center;">+</div>\n\n    <div style="display:flex;justify-content:space-between;margin-top:10px;">\n      <div id="simulation-set-button" class="print-selection-show-hide-part" style="border:1px solid black;width:75px;text-align:center;padding:4px;cursor:pointer;">Set</div>\n      <div id="simulation-print-button" style="border:1px solid black;width:75px;text-align:center;padding:4px;cursor:pointer">Print</div>\n    </div>\n   </div>\n  </div>\n   <div class="simulation-canvas-container"><canvas id="simulation-model-canvas"></canvas></div> \n  </div>\n</div>',gg=()=>'<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">Weft Selector</div>\n  <div id="modal-desc">\n    \n  </div>\n  <div class="btn-group">\n    <button class="btn-submit" type="button" id="weft-selector-modal-apply">Apply</button>\n    <button class="btn-submit" type="button" id="weft-selector-modal-ok">Ok</button>\n    <button class="btn-submit" type="button" id="weft-selector-modal-cancel">Cancel</button>\n  </div>\n</div>';let fg="";const yg=document.getElementById("design-notes-model"),vg=document.getElementById("header-design-notes-trigger");let bg,wg,Eg;const Ig=e=>{fg=e},Sg=()=>{Ig(bg.value)},kg=()=>{Sg(),Tg()},xg=()=>{nv(),bg.value=fg,yg.style.display="block",yg.style.animation="slide-down 0.3s ease"},Tg=()=>{yg.style.display="none"},_g=document.getElementById("File-menu");document.getElementById("fabric-quality");let Bg=!0,Lg={tar:0,dent:0},Pg="";let Cg=[{color:"red",yarndetail:"4272 ABC Yarn"},{color:"red",yarndetail:"4272 ABC Yarn"},{color:"red",yarndetail:"4272 ABC Yarn"}],Ng=[{color:"red",yarndetail:"1 ABC Yarn"},{color:"red",yarndetail:"1 ABC Yarn"},{color:"red",yarndetail:"1 ABC Yarn"}],Rg=[],Ag=[],Fg=[],Mg=[],Og=[{label:"Design Name",value:"ABC",key:"designName"},{label:"Fabric Quality",value:"ABC",key:"fabricQuality"},{label:"Shaft",value:"ABC",key:"shaft"},{label:"Total Dent",value:"ABC",key:"totalDent"},{label:"EPI",value:"ABC",key:"epi"},{label:"Avg.EPI",value:"ABC",key:"avgEpi"},{label:"Warp",value:"ABC",key:"warp"},{label:"Reed/2 in",value:"ABC",key:"reedPerTwoinch"},{label:"Reed Space",value:"ABC",key:"reedSpace"},{label:"Total Ends",value:"ABC",key:"totalEnds"},{label:"Total Picks",value:"ABC",key:"totalPicks"},{label:"PPI",value:"ABC",key:"ppi"},{label:"Avg PPI",value:"ABC",key:"avgPpi"},{label:"Weft",value:"ABC",key:"weft"},{label:"Party Name",value:"ABC",key:"partyName"},{label:"Designer Name",value:"ABC",key:"designerName"},{label:"Order No",value:"ABC",key:"orderNumber"},{label:"GSM",value:"ABC",key:"gsm"},{label:"GLM",value:"ABC",key:"glm"}];const Dg=(e,t,n)=>{if(!Gp.isSalvageVisible)return"";let l="";const i=document.createElement("tr");console.log("left salavage data is",t);for(let l=0;l<e.length;l++){const r=document.createElement("td");"Part"==e[l]?r.innerHTML=t.partName:"Dent"==e[l]?(r.innerHTML=t.dent,r.classList.add("dentColumn"),n.dent+=Number(t.dent)):"Ends"==e[l]?(r.classList.add("endsColumn"),r.innerHTML=t.ends,n.ends+=Number(t.ends)):"Repeat"==e[l]?r.innerHTML="":"Size"==e[l]?(r.innerHTML=t.size,n.size+=Number(t.size)):(r.innerHTML=t.usedYarns[e[l]]?t.usedYarns[e[l]]:"",n.usedYarns[e[l]]?n.usedYarns[e[l]]+=t.usedYarns[e[l]]?Number(t.usedYarns[e[l]]):0:n.usedYarns[e[l]]=t.usedYarns[e[l]]?Number(t.usedYarns[e[l]]):0),i.appendChild(r)}return l+=`<tr>${i.innerHTML}</tr>`,l},Wg=(e,t,n)=>{if(console.log("rigjht salavage data is",t),!Gp.isSalvageVisible)return"";let l="";const i=document.createElement("tr");for(let l=0;l<e.length;l++){const r=document.createElement("td");"Part"==e[l]?r.innerHTML=t.partName:"Dent"==e[l]?(r.classList.add("dentColumn"),r.innerHTML=t.dent,n.dent+=Number(t.dent)):"Ends"==e[l]?(r.innerHTML=t.ends,r.classList.add("endsColumn"),n.ends+=Number(t.ends)):"Repeat"==e[l]?r.innerHTML="":"Size"==e[l]?r.innerHTML=t.size:(r.innerHTML=t.usedYarns[e[l]]?t.usedYarns[e[l]]:"",n.usedYarns[e[l]]?n.usedYarns[e[l]]+=t.usedYarns[e[l]]?Number(t.usedYarns[e[l]]):0:n.usedYarns[e[l]]=t.usedYarns[e[l]]?Number(t.usedYarns[e[l]]):0,r.innerHTML=t.usedYarns[e[l]]?t.usedYarns[e[l]]:""),i.appendChild(r)}return l+=`<tr>${i.innerHTML}</tr>`,l},Hg=(e,t)=>{if(!Gp.isTotalVisible)return"";let n="";const l=document.createElement("tr");for(let n=0;n<e.length;n++){const i=document.createElement("td");"Part"==e[n]?i.innerHTML=t.partName:"Dent"==e[n]?(i.classList.add("dentColumn"),i.innerHTML=t.dent):"Ends"==e[n]?(i.classList.add("endsColumn"),i.innerHTML=t.ends):"Repeat"==e[n]?i.innerHTML="":"Size"==e[n]?i.innerHTML=Number(t.size).toFixed(2):i.innerHTML=t.usedYarns[e[n]]?t.usedYarns[e[n]]:"",l.appendChild(i)}return n+=`<tr>${l.innerHTML}</tr>`,n},$g=(e,t,n)=>{let l="",i=Array.isArray(e.withInnerRepeat)?e.withInnerRepeat:[];n.size+=Number(e.size?e.size:"0");for(let r=0;r<i.length;r++){const a=document.createElement("tr");for(let l=0;l<t.length;l++){const o=document.createElement("td");if("Part"==t[l])o.innerHTML=i[r].partName;else if("Dent"==t[l])o.innerHTML=i[r].dent,o.classList.add("dentColumn"),n.dent+=i[r].dent*Number(e.outerRepeat);else if("Ends"==t[l])o.innerHTML=i[r].ends,o.classList.add("endsColumn"),n.ends+=i[r].ends*Number(e.outerRepeat);else if("Repeat"==t[l]){if(0!=r)continue;o.innerHTML=e.outerRepeat,o.rowSpan=i.length}else if("Size"==t[l]){if(0!=r)continue;o.innerHTML=e.size,o.rowSpan=i.length}else o.innerHTML=i[r].usedYarns[t[l]]?i[r].usedYarns[t[l]]:"",n.usedYarns[t[l]]?n.usedYarns[t[l]]+=i[r].usedYarns[t[l]]?Number(i[r].usedYarns[t[l]])*Number(e.outerRepeat):0:n.usedYarns[t[l]]=i[r].usedYarns[t[l]]?Number(i[r].usedYarns[t[l]])*Number(e.outerRepeat):0;a.appendChild(o)}l+=`<tr>${a.innerHTML}</tr>`}return console.log("output string ios",l),l},qg=()=>{let e=FB.convert_new_index_to_numeric(WB),t=mb(e),n=yb(t);const l=String(t).split("\n").filter(e=>e.length>0).length,i=parseInt(Number(NB.value)/Number(jf.value)*Number(Lf.value));let r=String(Math.floor(i/Number(l))),a=i%Number(l),o=FB.new_get_extra_draft_data(WB,a),s=n*r+yb(mb(o));return Number(fi.value)&&(s+=Number(fi.value)),Number(Oi.value)&&(s+=Number(Oi.value)),s};function jg(){if(Bg)return(()=>{let e=Array.isArray(Vh)&&Vh.length>0?Vh[0].tableColumns:[],t=JSON.stringify(gv)!=JSON.stringify(fv),n=[{partName:t?"Left Selvedge":"Selvedge",partDraftPlan:gv.draftPlan,partWarpSeq:gv.warpSeq,partEnds:Ov(mb(gv.draftPlan)),partDents:fb(mb(gv.draftPlan))},...t?[{partName:"Right Selvedge",partDraftPlan:fv.draftPlan,partWarpSeq:fv.warpSeq,partEnds:Ov(mb(fv.draftPlan)),partDents:fb(mb(fv.draftPlan))}]:[]],l={partName:"Total",repeatedPart:"",dent:0,size:0,ends:0,usedYarns:{}};zh.forEach(e=>{l.usedYarns[e]=0}),console.log("draftPartsData are",hr),console.log("design with part data",Vh);let i=[...hr].map(e=>{let t=[];for(let n=0;n<e.partWarpSeq.length;n++)t.push(Gv(e.partDraftPlan,e.partWarpSeq[n]));let n=t[0];return console.log("dentWiseDraftData output is",n),`<div class="each-part-container">\n          <div class="each-part-title">${e.partName}</div>\n          <div class="each-part-table-container">\n            <table class="each-part-table">\n              <tr>\n                <th>Draft</th>\n                <th class="dentColumn">Dent</th>\n                <th>Repeat</th>\n                ${t.map((e,t)=>`<th>Pattern - ${t+1}</th>`).join("")}\n               \n              </tr>\n              ${n.map((e,n)=>`<tr>\n                <td>${e.withInnerRepeat[0].repeatedPart.replace(/\n/g,"<br>")}</td>\n                <td class="dentColumn">${e.dent}</td>\n                <td>${e.outerRepeat}</td>\n                ${t.map((e,t)=>{let l=nL(nL(e[n].pattern));return`<td>${Gp.isYarnNameVisible?hb(l):l}</td>`}).join("")}\n              </tr>`).join("")}\n            </table>\n          </div>\n        </div>`}).join("");return`<div class="draft-with-part-container">\n      <div class="draft-with-part-first-column">\n        ${Gp.isSalvageVisible?[...n].map(e=>`<div class="each-part-container">\n          <div class="each-part-title">${e.partName}</div>\n          <div class="each-part-table-container">\n            <table class="each-part-table">\n              <tr>\n                <th>Draft</th>\n                <th class="dentColumn">Dent</th>\n                <th>Yarn Pattern</th>\n              </tr>\n              <tr>\n                <td>${e.partDraftPlan.replace(/\n/g,"<br>")}</td>\n                <td class="dentColumn">${e.partDents}</td>\n                <td>${Gp.isYarnNameVisible?hb(Array.isArray(e.partWarpSeq)?e.partWarpSeq.join("/\n").replace(/\n/g,"<br>"):e.partWarpSeq.replace(/\n/g,"<br>")):Array.isArray(e.partWarpSeq)?e.partWarpSeq.join("/\n").replace(/\n/g,"<br>"):e.partWarpSeq.replace(/\n/g,"<br>")}</td>\n              </tr>\n            </table>\n          </div>\n        </div>`).join(""):""}\n\n\n          ${i}\n      </div>\n      <div class="draft-with-part-second-column">\n      <table>\n      <tr>\n          ${Array.isArray(e)?e.map(e=>"Dent"==e?`<th class="dentColumn">${e}</th>`:"Ends"==e?`<th class="endsColumn">${e}</th>`:`<th>${Gp.isYarnNameVisible?Ra(e,"warp"):e}</th>`).join(""):""}  \n      </tr>\n      ${Dg(e,Jh,l)}\n          ${Vh.map(t=>$g(t,e,l)).join("")}\n            ${Wg(e,Gh,l)}\n          ${Hg(e,l)}\n        \n    </table>\n  \n      </div>\n  </div>`})();let e={},t={};Fg=db(),console.log("table draft data is",Fg);const n=document.createElement("table");let l=er();n.innerHTML+=`<tr><th class="draftColumn"><pre>Shaft</pre></th><th class="endsColumn"><pre>Ends</pre></th><th class="dentColumn"><pre>Dent</pre></th><th class="patternColumn"><pre>Pattern</pre></th><th class="firstRepeatColumn"><pre>Repeat</pre></th>${l?'<th class="topBeamColumn"><pre>Top Beam</pre></th>':""}<th class="designTypeColumn"><pre>Type</pre></th><th class="secondRepeatColumn"><pre>Repeat</pre></th><th class="frsrColumn"><pre>FRSR</pre></th></tr>`;let i=!1,r=!1,a=!1,o=!1,s=!1,d=!1,c=!1,u=0,m=(FB.cols(),FB.convert_new_index_to_numeric(WB)),h=mb(m);const p=String(h).split("\n").filter(e=>e.length>0).length,g=parseInt(Number(NB.value)/Number(jf.value)*Number(Lf.value));let f=String(Math.floor(g/Number(p)));qg(f,h),e.bodyRepeat=f,e.rightsalvage=Fg.find(e=>"Right Selvedge"==e.Part),e.leftsalvage=Fg.find(e=>"Left Selvedge"==e.Part),t=JSON.parse(JSON.stringify(e));let y=0!=g%Number(p)&&f>0;{let e=g%Number(p),n=FB.new_get_extra_draft_data(WB,e),l=yb(mb(n));console.log("extra draft string is",n);let i=String(ab(!0)).split("\n").slice(0,Ov(n)).join("\n"),r={draft:{outerRepeat:1,pattern:nL(i),withInnerRepeat:[{repeatedPart:n,dent:fb(mb(n)),pattern:nL(i),ends:l,innerRepeat:1}]},dent:fb(mb(n)),tar:l,pattern:"Pattern",Part:"Extra"},a=[];if(String(n).includes("X")){let e=Vv(n);Array.isArray(e)&&e.forEach(e=>{a.push({...r,draft:e})})}else a=[r];t.extrapart=r}if(y&&Gp.isFullReedSpaceVisible){let t=Fg.filter(e=>"Right Selvedge"!=e.Part),n=Fg.find(e=>"Right Selvedge"==e.Part),l=g%Number(p),i=FB.new_get_extra_draft_data(WB,l),r=yb(mb(i));console.log("extra draft string is",i);let a=String(ab(!0)).split("\n").slice(0,Ov(i)).join("\n"),o={draft:{outerRepeat:1,pattern:nL(a),withInnerRepeat:[{repeatedPart:i,dent:fb(mb(i)),pattern:nL(a),ends:r,innerRepeat:1}]},dent:fb(mb(i)),tar:r,pattern:"Pattern",Part:"Extra"},s=[];if(String(i).includes("X")){let e=Vv(i);Array.isArray(e)&&e.forEach(e=>{s.push({...o,draft:e})})}else s=[o];e.extrapart=o,t=[...t,...s],t=t.map(e=>("Body"==e.Part&&(e.tar=String(Number(e.tar)-r)),e)),n&&t.push(n),Fg=t}console.log("tableDraftData after isExtraNeeded is",Fg);let v=Cv(Fg,"Body"),b=Cv(Fg,"Extra");Fg.forEach(e=>{let t=e.draft.outerRepeat,l=e.draft.withInnerRepeat;Array.isArray(l)&&l.forEach(m=>{const h=document.createElement("tr"),p=document.createElement("td");p.style.paddingTop="2px",p.style.paddingBottom="2px";const g=document.createElement("pre");g.innerHTML=sb(m.repeatedPart).replace(/\n/g,"<br>"),p.appendChild(g),h.appendChild(p);const y=document.createElement("td"),w=document.createElement("pre");w.innerHTML=m.ends,y.appendChild(w),y.classList.add("endsColumn"),h.appendChild(y);const E=document.createElement("td"),I=document.createElement("pre");I.innerHTML=m.dent,E.appendChild(I),E.classList.add("dentColumn"),h.appendChild(E);const S=document.createElement("td"),k=document.createElement("pre");k.innerHTML=Gp.isYarnNameVisible?hb(zv(m.pattern,!0)):zv(m.pattern,!0),S.appendChild(k),S.classList.add("patternColumn"),h.appendChild(S);const x=document.createElement("td"),T=document.createElement("pre");if(T.innerHTML=m.innerRepeat,x.appendChild(T),x.classList.add("firstRepeatColumn"),h.appendChild(x),Object.keys(e).forEach(t=>{if("draft"!=t){if("Part"==t&&!r&&"Body"==e.Part){const e=document.createElement("td");return e.classList.add("designTypeColumn"),e.innerText="Body",e.setAttribute("rowspan",v),r=!0,void h.appendChild(e)}if("Part"==t&&r&&"Body"==e.Part)return;if("pattern"==t)return;if("tar"==t)return;if("dent"==t)return;if("topbeam"==t)return;if("Part"==t&&!c&&"Extra"==e.Part){const e=document.createElement("td");return e.classList.add("designTypeColumn"),e.innerText="Extra",e.setAttribute("rowspan",b),c=!0,void h.appendChild(e)}if("Part"==t&&c&&"Extra"==e.Part)return;if("dent"==t&&!a&&"Extra"==e.Part){const n=document.createElement("td");return n.innerHTML=e[t],n.classList.add("dentColumn"),n.setAttribute("rowspan",b),a=!0,void h.appendChild(n)}if("dent"==t&&a&&"Extra"==e.Part)return;if("tar"==t&&!s&&"Extra"==e.Part){const n=document.createElement("td");return n.classList.add("endsColumn"),n.innerHTML=e[t],n.setAttribute("rowspan",b),s=!0,void h.appendChild(n)}if("tar"==t&&s&&"Extra"==e.Part)return;if("pattern"==t&&!o&&"Extra"==e.Part){const t=document.createElement("td");return t.classList.add("patternColumn"),t.innerHTML=Gp.isYarnNameVisible?hb(e.draft.pattern):e.draft.pattern,t.setAttribute("rowspan",b),o=!0,void h.appendChild(t)}if("pattern"==t&&o&&"Extra"==e.Part)return;const n=document.createElement("td");"Part"==t&&n.classList.add("designTypeColumn"),String(e[t]).length>0&&(String(e[t]).includes("<br>")?(n.innerHTML=e[t],n.style.paddingLeft="5px"):(n.textContent=e[t],n.style.paddingLeft="5px"),h.appendChild(n))}}),n.appendChild(h),0==u){const e=document.createElement("td");u=l.length;const n=document.createElement("pre");n.innerHTML=t,e.appendChild(n),e.classList.add("secondRepeatColumn"),e.setAttribute("rowspan",u),h.appendChild(e)}if(u>0&&u--,["Left Selvedge","Right Selvedge"].includes(e.Part)){h.classList.add("salvageColumn");const e=document.createElement("td"),t=document.createElement("pre");t.innerHTML=1,e.appendChild(t),e.classList.add("frsrColumn"),h.appendChild(e)}if("Extra"==e.Part&&!d){const e=document.createElement("td"),t=document.createElement("pre");t.innerHTML=1,e.appendChild(t),e.classList.add("frsrColumn"),e.setAttribute("rowspan",b),d=!0,h.appendChild(e)}if(!i&&"Body"==e.Part){const e=document.createElement("td"),t=document.createElement("pre");t.innerHTML=f,e.appendChild(t),e.setAttribute("rowspan",v),e.classList.add("frsrColumn"),i=!0,h.appendChild(e)}})}),console.log("table Draft data is",Fg);let w=[...new Set(Fg.map(e=>e.Part))];w=w.sort();let E=0,I=0;w.forEach(e=>{let t=Fg.filter(t=>t.Part==e);if("Body"==e)t.forEach(e=>{e.draft.withInnerRepeat.forEach(t=>{I+=t.ends*e.draft.outerRepeat,E+=t.dent*e.draft.outerRepeat})}),Number(f)>0&&Gp.isFullReedSpaceVisible&&(I*=Number(f),E*=Number(f));else if(["Left Selvedge","Right Selvedge"].includes(e)){if(!Gp.isSalvageVisible)return;t.forEach(e=>{e.draft.withInnerRepeat.forEach(e=>{I+=e.ends,E+=e.dent})})}else t.forEach(e=>{e.draft.withInnerRepeat.forEach(t=>{I+=t.ends*e.draft.outerRepeat,E+=t.dent*e.draft.outerRepeat*t.innerRepeat})})});const S=document.createElement("tr");S.classList.add("totalRow");const k=document.createElement("td");k.id="draft-total-text-element",k.innerHTML="<pre>Total</pre>",S.appendChild(k);const x=document.createElement("td");x.classList.add("endsColumn"),x.innerHTML=`<pre>${I}\nEnds</pre>`,Lg.tar=I,S.appendChild(x);const T=document.createElement("td");T.classList.add("dentColumn"),Lg.dent=E,T.innerHTML=`<pre>${E}\nDent</pre>`,S.appendChild(T);const _=document.createElement("td");_.classList.add("patternColumn");const B=document.createElement("pre"),L=Qr(e,!1);Pg=Qr(t,!0),B.innerHTML=Gp.isYarnNameVisible?hb(Aa(L)):Aa(L),_.appendChild(B),S.appendChild(_);const P=document.createElement("td");let C=0;return Gp.isInnerRepeatVisible&&(C+=1),Gp.isOuterRepeatVisible&&(C+=1),Gp.isFRSRVisible&&(C+=1),P.id="repeatFooterElement",S.appendChild(P),C>0?(P.setAttribute("colspan",C),P.style.display="table-cell"):P.style.display="none",n.appendChild(S),(e=>{let t=[];t.push(Number(If.value)),t.push(Number(kf.value));let n=String(e).trim().split("\n");for(let e=0;e<n.length;e++)t.push(n[e].trim().split(" ").length);t=[...new Set(t)].filter(e=>e).sort();JSON.parse(localStorage.getItem("user")),JSON.parse(localStorage.getItem("company")),n.length;let l=((DB.rows()-YB.cells.length)/Number(Ff.value)).toFixed(2),i=((n.length/Number(jf.value)).toFixed(2),((qg()-Number(fi.value)-Number(Oi.value))/Number(Lf.value)).toFixed(2)),r=YB.cells.length?(DB.rows()/l).toFixed(2):Number(Ff.value).toFixed(2),a=Number(Lf.value)+Number(bf.value)+Number(vf.value),o=String(a.toFixed(2))+(Number(bf.value)+Number(vf.value)?` = ${Number(Lf.value).toFixed(2)} + ${(Number(bf.value)+Number(vf.value)).toFixed(2)}`:"");Og=[{label:"Design Name",value:Ld.innerText,key:"designName"},{label:"Shaft",value:FB.rows(),key:"shaft"},{label:"Reed Space",value:o,key:"reedSpace"},{label:`Reed/${jf.value} in`,value:`${NB.value}${t.map(e=>"/"+e).join("")}`,key:"reedPerTwoinch"},{label:"Avg EPI",value:i,key:"avgEpi"},{label:"Total Dent",value:Bf.value,key:"totalDent"},{label:"Pick",value:Ff.value,key:"totalPicks"},{label:"Avg.PPI",value:r,key:"avgPpi"},{label:"Total Ends",value:qg(),key:"totalEnds"}]})(h),`<table class="draft-numeric-table">${n.innerHTML}</table>`}const Vg=e=>{let t=JSON.parse(JSON.stringify(e)),n=Gp.removeShaftElement;return t.forEach((e,t)=>{let l=e.pegplan.split("\n"),i="";l.forEach((e,t)=>{let l=String(e).split(",");l.forEach((e,r)=>{let a=n.filter(t=>Number(t)<Number(e));var o;-1==n.findIndex(t=>Number(t)==Number(e))&&(i+=(o=e,(ml.start<=Number(o)&&ml.end>=Number(o)||hl.start<=Number(o)&&hl.end>=Number(o)?e:String(Number(e)-a.length))+""+(r!=l.length-1?",":"")+(0==t&&r==l.length-1?"\n":"")))})}),e.pegplan=i}),t};function zg(e){if(Gp.pegplanViewType==fl.GRAPHICALNOWITHNUMERICNO){let t="",n=0,l=0,i=document.createElement("table"),r=Vg(e);Gp.pegplanSorting==Tl&&(r.reverse(),r.forEach(e=>{let t=e.pegplan.split("\n");e.pegplan=t.reverse().join("\n")}));Math.max(...r.map(e=>Number(e.no)));return r.forEach((e,a)=>{let o=String(e.pegplan).replace(/\n/g,"<br>");const s=document.createElement("tr");s.setAttribute("valign","center"),s.classList.add("pegplan-print-row"),s.style.height="15px";const d=document.createElement("td");d.classList.add("pegplan-no"),d.textContent=e.no,d.setAttribute("width","65"),s.appendChild(d);const c=document.createElement("td");c.innerHTML=o.trim(),c.style.paddingLeft="1px",c.classList.add("pegplan-cell"),c.setAttribute("width","400"),s.appendChild(c),i.appendChild(s),n+=1,40==n?(l+=1,t+=`<table class="pegplan-table" style="page-break-after: ${l%2==0&&l>0?"always":"auto"};">${i.innerHTML}</table>`,n=0,i=document.createElement("table")):r.length-1==a&&(t+=`<table class="pegplan-table">${i.innerHTML}</table>`)}),t}return""}const Ug=e=>{let t=[fl.GRAPHICALNOWITHNUMERICYES,fl.GRAPHICALYESWITHNUMERICYES].includes(Gp.pegplanViewType),n=[fl.GRAPHICALYESWITHNUMERICNO,fl.GRAPHICALYESWITHNUMERICYES].includes(Gp.pegplanViewType),l=n?"white":"black",i=tb();console.log("fidder color object is",i);const r=Math.max(DB.cols(),Math.max(...Object.values(i)),hl.end);let a=Vg(e);console.log("value of col is",r),console.log("temp pegplan data is",a);const o=Gp.isTwoPickLetisEnabled?2*a.length:a.length,s=On,d=Dn,c=document.createElement("canvas");c.width=4*Math.ceil(18*r),c.height=4*Math.ceil(18*o);const u=c.getContext("2d");u.scale(4,4);for(let e=0;e<r+1;e++)u.beginPath(),u.strokeStyle="black",u.moveTo(s+18*e,d),u.lineTo(s+18*e,d+18*o),u.stroke(),u.closePath();for(let e=0;e<o+1;e++)u.beginPath(),u.strokeStyle="black",u.moveTo(s,d+18*e),u.lineTo(s+18*r,d+18*e),u.stroke(),u.closePath();console.log("windoe device pixel ration is",window.devicePixelRatio),Gp.pegplanSorting==Tl&&(a.reverse(),a.forEach(e=>{let t=e.pegplan.split("\n");e.pegplan=t.reverse().join("\n")}));Gp.isCreaming&&Array.isArray(YB.cells)&&YB.cells;let m=hl.start;a.forEach((e,i)=>{if(Gp.isTwoPickLetisEnabled){let r=String(e.pegplan).includes("\n")?"\n":"<br>";Number(e.no);String(e.pegplan).split(r).forEach((e,r)=>{let a=2*i+r,o=m>0&&String(e).includes(m);e.split(",").forEach(e=>{let i=18*(e-1),r=18*a;n&&(u.fillStyle=o?"#ff5e00":"black",u.fillRect(i+2,r+d+2,14,14)),t&&(u.textAlign="center",u.fillStyle=l,u.font="bold 12px sans-serif",u.fillText(e,i+9,r+13+d))})})}else{let r=i,a=(Number(e.no),m>0&&String(e.pegplan).includes(m));String(e.pegplan).split(",").forEach(e=>{let i=18*(e-1),o=18*r;n&&(u.fillStyle=a?"#ff5e00":"black",u.fillRect(i+2,o+2,14,14)),t&&(u.textAlign="center",u.fillStyle=l,u.font="bold 12px sans-serif",u.fillText(e,i+9,o+13))})}}),u.translate(.5,.5);const h=document.createElement("canvas"),p=h.getContext("2d"),g=a.length,f=Gp.isTwoPickLetisEnabled?36:18;h.width=288,h.height=g*f*4,p.scale(4,4);for(let e=0;e<2;e++)p.beginPath(),p.strokeStyle="black",p.moveTo(s+72*e,d),p.lineTo(s+72*e,d+o*f),p.stroke(),p.closePath();Gp.isTwoPickLetisEnabled&&(p.font="bold 18px sans-serif");Math.max(...a.map(e=>Number(e.no)));for(let e=0;e<g+1;e++)p.beginPath(),p.strokeStyle="black",p.moveTo(s,d+e*f),e>0&&(p.textAlign="center",p.fillText(a[e-1].no,s+36,d+e*f-f/3)),p.lineTo(s+72*r,d+e*f),p.stroke(),p.closePath();const y=document.createElement("canvas");y.width=h.width+c.width,y.height=c.height;const v=y.getContext("2d");v.drawImage(h,0,0),v.drawImage(c,h.width,0),v.translate(.5,.5),y.style.transform=`scale(${parseFloat(1/4).toString()})`;const b=Math.ceil(y.height/5760);let w=document.querySelector(".design-pegplan");w.style.overflow="hidden";for(let e=0;e<b;e++){const t=document.createElement("div"),n=document.createElement("table");n.style.marginLeft="48px",n.style.width="auto";const l=document.createElement("tr");for(let e=0;e<r;e++){const t=document.createElement("th");t.style.width="12px",t.style.fontSize="12px",t.style.border="1px solid black",t.style.fontFamily="Rubik",t.style.padding=0,t.style.textAlign="center",t.innerHTML=e+1,l.appendChild(t)}n.appendChild(l);const i=document.createElement("canvas"),a=i.getContext("2d"),o=72,c=72;i.height=o,i.width=c*r;const u=2;for(let e=0;e<r+1;e++)a.beginPath(),a.strokeStyle="black",a.moveTo(s+e*c,d),a.lineTo(s+e*c,d+u*o),a.textAlign="center",a.font="bold 48px Rubik",a.fillText(e+1,s+e*c+c/2,o/4*3),a.stroke(),a.closePath();for(let e=0;e<u+1;e++)a.beginPath(),a.strokeStyle="black",a.moveTo(s,d+e*o),a.lineTo(s+r*c,d+e*o),a.stroke(),a.closePath();const m=a.getImageData(0,0,i.width,i.height),h=v.getImageData(0,1440*e*4,y.width,5760),p=document.createElement("canvas");p.width=h.width,p.height=h.height+72;const g=p.getContext("2d");p.style.transformOrigin="top left",g.putImageData(m,288,0),g.putImageData(h,0,72),p.style.transform=`scale(${parseFloat(1/4).toString()})`,t.appendChild(p),t.style.height=p.height/4+16+"px",t.style.width=p.width/4+16+"px",w.appendChild(t)}w.style.display="grid",w.style.gridTemplateColumns=r>20?"1fr":"1fr 1fr",w.style.width="auto"},Yg=e=>{let t=tb();console.log("fidder color object is",t);const n=2*DB.cols();let l=Vg(e);console.log("value of col is",n),console.log("temp pegplan data is",l);const i=l.length,r=On,a=Dn,o=document.createElement("canvas");o.width=4*Math.ceil(19*n),o.height=4*Math.ceil(19*i);const s=o.getContext("2d");s.scale(4,4);for(let e=0;e<n+1;e++)s.beginPath(),s.strokeStyle="black",s.moveTo(r+19*e,a),s.lineTo(r+19*e,a+19*i),s.stroke(),s.closePath();for(let e=0;e<i+1;e++)s.beginPath(),s.strokeStyle="black",s.moveTo(r,a+19*e),s.lineTo(r+19*n,a+19*e),s.stroke(),s.closePath();console.log("windoe device pixel ration is",window.devicePixelRatio),Gp.pegplanSorting==Tl&&(l.reverse(),l.forEach(e=>{let t=e.pegplan.split("\n");e.pegplan=t.reverse().join("\n")}));let d=[];l.forEach((e,t)=>{let l=String(e.pegplan),i=Nv(l,n/2);String(i).split(" ").forEach((e,n)=>{if("0"==e)return;let l=t,i=n+1,r=19*(i-1),o=19*l;s.fillStyle=-1!=d.findIndex(e=>e.index==l)?"red":"black",s.fillRect(r+2,o+a+2,15,15)})}),s.translate(.5,.5);const c=document.createElement("canvas"),u=c.getContext("2d"),m=l.length;c.width=304,c.height=19*m*4,u.scale(4,4);for(let e=0;e<2;e++)u.beginPath(),u.strokeStyle="black",u.moveTo(r+76*e,a),u.lineTo(r+76*e,a+19*i),u.stroke(),u.closePath();for(let e=0;e<m+1;e++){if(u.beginPath(),u.strokeStyle="black",u.moveTo(r,a+19*e),e>0){u.textAlign="center";const t=String(l[e-1].no);u.fillText(t,r+38,a+19*e-19/3)}u.lineTo(r+76*n,a+19*e),u.stroke(),u.closePath()}const h=document.createElement("canvas");h.width=c.width+o.width,h.height=o.height;const p=h.getContext("2d");p.drawImage(c,0,0),p.drawImage(o,c.width,0),p.translate(.5,.5),h.style.transform=`scale(${parseFloat(1/4).toString()})`;const g=Math.ceil(h.height/6080);let f=document.querySelector(".design-pegplan");f.style.overflow="hidden";for(let e=0;e<g;e++){const t=document.createElement("div"),l=document.createElement("table");l.style.marginLeft="48px",l.style.width="auto";const i=document.createElement("tr");for(let e=0;e<n;e++){const t=document.createElement("th");t.style.width="12px",t.style.fontSize="14px",t.style.border="1px solid black",t.style.fontFamily="Rubik",t.style.padding=0,t.style.textAlign="center",t.innerHTML=e+1,i.appendChild(t)}l.appendChild(i);const o=document.createElement("canvas"),s=o.getContext("2d"),d=76,c=76;o.height=d,o.width=c*n;const u=2;for(let e=0;e<n;e++)s.beginPath(),s.strokeStyle="black",s.fillStyle=e%2==0?"black":"red",s.moveTo(r+e*c,a),s.lineTo(r+e*c,a+u*d),s.textAlign="center",s.font="bold 56px Rubik",s.fillText(Math.ceil((e+1)/2),r+e*c+c/2,d/4*3),s.stroke(),s.closePath();for(let e=0;e<u+1;e++)s.beginPath(),s.strokeStyle="black",s.moveTo(r,a+e*d),s.lineTo(r+n*c,a+e*d),s.stroke(),s.closePath();const m=s.getImageData(0,0,o.width,o.height),g=p.getImageData(0,1520*e*4,h.width,6080),y=document.createElement("canvas");y.width=g.width,y.height=g.height+76;const v=y.getContext("2d");y.style.transformOrigin="top left",v.putImageData(m,304,0),v.putImageData(g,0,76),y.style.transform=`scale(${parseFloat(1/4).toString()})`,t.appendChild(y),t.style.height=y.height/4+16+"px",t.style.width=y.width/4+16+"px",f.appendChild(t)}f.style.display="grid",f.style.gridTemplateColumns=n>20?"1fr":"1fr 1fr",f.style.width="auto"};function Jg(e,t){if(console.log("warp weft data and type is",e),"warp"==t){let t=Number(fi.value)/Number(If.value),n=Number(Oi.value)/Number(kf.value);console.log("leftWarpSeqSalvageElement",uv.value),t>0&&uv.value&&(e=uv.value+"\n"+e),n>0&&mv.value&&(e=e+"\n"+mv.value)}let n=Hv(e);console.log("seqStringWithRepeat",n);const l=document.createElement("table"),i=document.createElement("tr"),r=document.createElement("th");r.innerHTML="<pre>Ends Yarn</pre>",r.style.textAlign="center",r.style.whiteSpace="pre",i.appendChild(r);const a=document.createElement("th");a.innerHTML="<pre>Repeat</pre>",a.style.textAlign="center",i.appendChild(a);const o=document.createElement("th");o.innerHTML="<pre>Repeat</pre>",o.style.textAlign="center",i.appendChild(o),l.appendChild(i),n.forEach((e,n)=>{let i=e.outerRepeat;e.innerParts.forEach((n,r)=>{let a=String(n.currentPart).trim(),o=n.innerRepeat,s=String(a).split(" ");s.forEach((n,a)=>{const d=document.createElement("tr");d.setAttribute("valign","top");const c=document.createElement("td");c.classList.add("pegplan-no");let u=Aa(n).replaceAll("\n","<br>"),m=isNaN(parseInt(u))?"1"+("weft"==t?gb(u):pb(u)):"weft"==t?gb(u):pb(u),h=document.createElement("pre");if(h.innerHTML=m,c.appendChild(h),c.style.textAlign="left",d.appendChild(c),0==a){const e=document.createElement("td");e.style.paddingLeft="8px",e.innerHTML=`<pre>x ${o}</pre>`,e.rowSpan=s.length,e.style.textAlign="left",e.style.verticalAlign="middle",d.appendChild(e)}if(0==a&&0==r){let t=0;for(let n=0;n<e.innerParts.length;n++){t+=String(e.innerParts[n].currentPart).trim().split(" ").length}const n=document.createElement("td");n.style.paddingLeft="8px",n.rowSpan=t,n.innerHTML=`<pre>x ${i}</pre>`,n.style.textAlign="left",n.style.verticalAlign="middle",d.appendChild(n)}l.appendChild(d)})})});const s=document.createElement("tr"),d=document.createElement("td"),c=document.createElement("pre");return c.innerText="warp"==t?qg()+" Ends":2*Mg.length+" Picks",d.appendChild(c),d.colSpan=3,s.appendChild(d),l.appendChild(s),`<div style="border:1px solid black;padding:8px;margin-top:10px;"><table class="warp-weft-table">${l.innerHTML}</table></div>`}function Gg(e,t){const n=document.createElement("table");return n.innerHTML+=`<tr><td class="warp-info-table-warp-heading" style="width:70px;">${"warp"==t?"Warp":"Weft"}</td><td style="width:80px;">Denier</td><td>Yarn</td><td style="width:70px;">Total</td></tr>`,e.forEach((e,l)=>{const i=document.createElement("tr");i.setAttribute("valign","top");const r=document.createElement("td");r.style.paddingLeft="2px",r.innerHTML=e.yarnname,e.isFooterRow||(r.style.backgroundColor=hu("weft"==t?Qm[e.yarnname]:Lr[e.yarnname]),r.style.color=(e=>{let t,n,l;return e.match(/^rgb/)?(t=(e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],n=e[2],l=e[3]):(t=(e=+("0x"+e.slice(1).replace(e.length<5&&/./g,"$&$&")))>>16,n=e>>8&255,l=255&e),Math.sqrt(t*t*.299+n*n*.587+l*l*.114)>127.5?"black":"white"})(r.style.backgroundColor)),e.isFooterRow&&(r.style.backgroundColor="white",r.style.border="none"),i.appendChild(r);const a=document.createElement("td");a.style.paddingLeft="2px",a.innerHTML=e.type?e.type:"",i.appendChild(a),i.style.borderTop="1px solid black",e.isFooterRow&&(a.style.backgroundColor="white",a.style.border="none");const o=document.createElement("td");o.style.paddingLeft="2px",o.innerHTML="warp"==t?Pr[e.yarnname]?Pr[e.yarnname].yarnName:e.yarnname:th[e.yarnname]?th[e.yarnname].yarnName:e.yarnname,e.isFooterRow&&(o.style.backgroundColor="white",o.style.border="none"),i.appendChild(o);const s=document.createElement("td");s.style.paddingLeft="2px",s.innerHTML=e.count?e.count:0,i.appendChild(s),n.appendChild(i)}),`<table class="warp-weft-info-table">${n.innerHTML}</table>`}const Xg=()=>{Gp.isInnerRepeatVisible||Gp.isPatternVisible||Gp.isDentVisible||Gp.isEndsVisible,document.getElementById("draft-total-text-element").setAttribute("colspan",1),Gp.isFRSRVisible||Gp.isOuterRepeatVisible||Gp.isInnerRepeatVisible?document.getElementById("repeatFooterElement").style.display="table-cell":document.getElementById("repeatFooterElement").style.display="none"},Kg=(e,t=!1)=>{Bg=Vh.length>0,Df.value=DB.rows(),Wf.value=FB.cols(),Ef.value=FB.rows(),Mg=ib();let n=jg();Fg.length<=2&&Mg.length,Cg=[],Ng=[],Ag=[],Rg=[];let l=ob(),i=ab(),r=Fa(l),a=Fa(i);Object.keys(a).forEach(e=>{let t=Lr[e];Ng.push({color:t,yarndetail:e})}),Object.keys(r).forEach(e=>{Cg.push({color:Qm[e],yarndetail:e})}),Ng.forEach(e=>{if(e.yarndetail.replace(/[^a-zA-Z]+/g,"")&&e.yarndetail.replace(/[^a-zA-Z]+/g,"")[0]){if(-1==Rg.findIndex(t=>t.yarnname==e.yarndetail.replace(/[^a-zA-Z]+/g,"")[0])){let t=e.yarndetail.replace(/[^a-zA-Z]+/g,"")[0],n=Pr[t],l=parseInt(Pg.split(/[\s\n]+/).find(e=>e.includes(t)));l=isNaN(l)?0:l,Rg.push({yarnname:e.yarndetail.replace(/[^a-zA-Z]+/g,"")[0],type:n?n.yarnType:"",count:l})}Rg=Rg.sort((e,t)=>e.yarnname<t.yarnname?-1:e.yarnname>t.yarnname?1:0)}}),Cg.forEach(e=>{if(e.yarndetail.replace(/[^a-zA-Z]+/g,"")&&e.yarndetail.replace(/[^a-zA-Z]+/g,"")[0]){if(-1==Ag.findIndex(t=>t.yarnname==String(e.yarndetail.replace(/[^a-zA-Z]+/g,"")[0]).trim())){let t=e.yarndetail.replace(/[^a-zA-Z]+/g,"")[0],n=th[t];Ag.push({yarnname:t,type:n?n.yarnType:"",count:r[t]?r[t]:0})}Ag=Ag.sort((e,t)=>e.yarnname<t.yarnname?-1:e.yarnname>t.yarnname?1:0)}});let o=Ag.reduce((e,t)=>e+t.count,0);Ag.push({yarnname:"",type:"",count:o,isFooterRow:!0});let s=Rg.reduce((e,t)=>e+t.count,0);Rg.push({yarnname:"",type:"",count:s,isFooterRow:!0});let d=JSON.parse(localStorage.getItem("company")),c=`<div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">\n  </div>\n    <div id="print-preview-container">\n      <div id="print-item" style="padding:5px;" class="direct-print-container">\n        <div id="print-company-details" class="company-details" style="display:${Gp.isHeaderVisible?"flex":"none"}">\n          <div class="company-logo" style="display:none;">\n            <img\n              src="assets/Assert/maxweavelogo.png"\n              alt="company-logo"\n              height="72"\n            />\n          </div>\n          <div class="company-desc">\n            <div class="company-name">\n              <h3>${d.companyName}</h3>\n            </div>\n            <div class="company-address">\n              <p>${d.address},${d.city}</p>\n            </div>\n            <div class="company-telephone-email">\n              <p>Mo.: ${d.mobileNo} </p>\n              <p>email: ${d.email}</p>\n            </div>\n          </div>\n        </div>\n\n\n        <div id="print-design-details" style="display:${Gp.isDetailsVisible?"flex":"none"}">\n      \n          <div id="design-details-table-container">\n          \n          </div>\n        \n        </div>\n        <div id="print-warp-weft-info" class="design-warping-section" style="display:${Gp.isWarpWeftInfoVisible?"grid":"none"}">\n              <div class="warp-info-table-container">\n                ${Gg(Rg,"warp")}\n              </div>\n              <div class="weft-info-table-container">\n                ${Gg(Ag,"weft")}\n              </div>           \n        </div>\n        <div id="print-design-simulation" class="design-simulation"><canvas id="print-design-simulation-canvas"></canvas></div>\n        <p style="page-break-after: always;">&nbsp;</p>\n        <div style="margin-top:10px;">\n          <div class="print-second-column" style="margin-left:0px;grid-template-columns:auto">\n        \n          <div id="print-design-draft" class="design-draft" style="display:${Gp.isDraftVisible?"block":"none"}">\n            <div id="print-design-draft-container" style="padding:4px;">${n}</div>\n          </div>\n          <div>\n         \n          <div class="design-notes-container">\n            <div>Notes:</div>\n            <div>${fg}</div>\n          </div>\n          \n          </div>\n          </div>\n      \n        </div>\n        <p style="page-break-after: always;">&nbsp;</p>\n        <div id="warp-weft-detail-container">\n        <div id="warp-weft-pattern-container" style="padding:10px;">\n        \n          <div class="warp-weft-table-container">\n            <div class="warp-table-container">\n              <div><pre>Warp Pattern</pre></div>\n              ${Jg(i,"warp")}\n              </div>\n            <div class="weft-table-container">\n              <div><pre>Weft Pattern</pre></div>\n                ${Jg(l,"weft")}\n              </div>\n        </div>\n        </div>\n        <p style="page-break-after: always;">&nbsp;</p>\n\n        <div id="print-design-pegplan-container" class="design-pegplan" style="display:${Gp.isPegplanVisible?"grid":"none"}">\n            ${zg(Mg)}\n          \n        </div>  \n        \n        <div id="print-pegplan-section" class="pegplan-section" style="display:${Gp.isPegplanVisible?"block":"none"}">\n        </div>        \n      </div>\n      </div>\n        ${dg()}`;Yp.querySelector(".modal-content").innerHTML=c;let u=Yp.querySelector(".modal-title");const m=Yp.querySelector(".close-button");if(console.log("Close button is",m),m.addEventListener("click",()=>{Ol(""),Yp.style.display="none"}),u.innerText="Print Prview",Xg(),e!=fl.GRAPHICALNOWITHNUMERICNO&&Ug(Mg),t){let e=document.getElementById("print-item"),t="";for(let e=0;e<160;e++)t+="";$(e).printThis({canvas:!0,beforePrint:()=>{document.title=Ld.innerText+" Production Sheet"},pageTitle:t+Ld.innerText,afterPrint:Zg})}_g.classList.remove("absoulte"),_g.classList.add("none")},Zg=()=>{let e=document.getElementById("print-item");document.body.removeChild(e),document.title="Maxweave"},Qg=document.getElementById("new-file-modal"),ef=document.querySelector("#new-file-form"),tf=document.querySelector("#new-file-submit"),nf=document.getElementById("new-file-apply"),lf=document.getElementById("new-file-modal-error"),rf=document.getElementById("user-define-endsperdent");let af=12,of=0,sf=0,df=20,cf=20,uf="inch",mf=20,hf=20,pf=!1,gf=.5,ff=.5,yf=45.5;document.getElementById("fabric-type"),document.getElementById("fabric-quality");const vf=document.getElementById("width-Lsalvage"),bf=document.getElementById("width-Rsalvage"),wf=document.getElementById("width-total"),Ef=document.getElementById("shaft"),If=document.getElementById("dentWarp-Lsalvage"),Sf=document.getElementById("dentWarp-body"),kf=document.getElementById("dentWarp-Rsalvage"),xf=document.getElementById("dent-Lsalvage"),Tf=document.getElementById("dent-body"),_f=document.getElementById("dent-Rsalvage"),Bf=document.getElementById("dent-total"),Lf=document.getElementById("width-body"),Pf=document.getElementById("Total-Lsalvage"),Cf=document.getElementById("Total-body"),Nf=document.getElementById("Total-Rsalvage"),Rf=document.getElementById("Total-warp-total"),Af=document.getElementById("warp-dencity"),Ff=document.getElementById("weft-dencity"),Mf=document.getElementById("grid-height"),Of=document.getElementById("grid-width"),Df=document.getElementById("design-height"),Wf=document.getElementById("design-width"),Hf=document.getElementById("weft-height"),$f=document.getElementById("warp-width"),qf=document.getElementById("unit"),jf=document.getElementById("inch");let Vf=Ul;const zf=e=>{af=e},Uf=e=>{of=e},Yf=e=>{uf=e},Jf=e=>{sf=e},Gf=e=>{cf=e},Xf=e=>{df=e},Kf=e=>{mf=e},Zf=e=>{hf=e},Qf=e=>{Number(hv.value)||(hv.value=2,dv.value=Pf.value,cv.value=Nf.value,Iv(),xv(),console.log("left and right salvage data is",gv,fv),hv.value=""),gf=Number(e)},ey=e=>{Number(hv.value)||(hv.value=2,dv.value=Pf.value,cv.value=Nf.value,Iv(),xv(),console.log("left and right salvage data is",gv,fv),hv.value=""),ff=Number(e)},ty=e=>{yf=Number(e)},ny=()=>{console.log("current file type is",Vf),Vf==Yl?(ay(),ry(!0)):Vf==Ul&&(iy(),ry(!0)),pf||(Ol(""),Qg.style.display="none")},ly=(e,t)=>25e3<e||15e3<t?(vb("Design Height Width are not compatible"),!1):(document.getElementById("statusbar-info-warp").textContent="Warp : "+t,document.getElementById("statusbar-info-weft").textContent="Weft : "+e,!0),iy=()=>{const e=new FormData(ef),t=Object.fromEntries(e.entries());if(!ly(Math.floor(t["design-height"]),Math.floor(t["design-width"])))return pf=!0,lf.style.display="block",lf.innerText="Design height and width are not compatible",void setTimeout(()=>{lf.style.display="none",pf=!1},2e3);console.log("value ",t),Uf(Math.floor(t["Total-Lsalvage"])),Jf(Math.floor(t["Total-Rsalvage"])),zf(Math.floor(t.shaft)),Gf(Math.floor(t["design-height"])),Xf(Math.floor(t["design-width"])),Zf(Math.floor(t["weft-height"])),Kf(Math.floor(t["warp-width"])),Fl(Math.floor(t["grid-height"])),Al(Math.floor(t["grid-width"])),Yf(t.unit),Qf(t["width-Lsalvage"]),ey(t["width-Rsalvage"]),ty(t["width-body"]),Ld.innerText="Untitled",oL(new ui(mf,!1,!1,!0,!1)),sL(new ui(hf,!0,!1,!1,!1)),GB.update_size(parseInt(hf)),JB.update_size(parseInt(mf)),YB.update_size(parseInt(hf)),Lv(),QB&&(QB(),iI({target:{scrollLeft:0}}),hE({target:{scrollTop:0}}),UE.style.width=df*Rl+"px",KE.style.height=cf*Rl+"px");let n=Number(RB.value);WB.change_dent_dimension(df,2,Rl),Xn&&HB.change_treadles_value(n,DB,FB,AB,HB),eL&&eL(),rI()},ry=(e=!1)=>{if(document.getElementById("statusbar-info-shaft").textContent="Shaft : "+Ef.value,document.getElementById("statusbar-info-warp").textContent="Warp : "+$f.value,document.getElementById("statusbar-info-weft").textContent="Weft : "+Hf.value,e){let e=FB.convert_new_index_to_numeric(WB),t=mb(e),n=DB.rows()-YB.cells.length,l=String(t).trim().split("\n"),i=qg()-Number(Pf.value)-Number(Nf.value),r=(n/Number(Ff.value)).toFixed(2),a=(l.length/(Number(NB.value)/Number(jf.value))).toFixed(2),o=(i/Number(Lf.value)).toFixed(2),s=YB.cells.length?(DB.rows()/r).toFixed(2):Number(Ff.value).toFixed(2);document.getElementById("statusbar-info-avg-epi").textContent="Avg EPI : "+o,document.getElementById("statusbar-info-avg-ppi").textContent="Avg PPI : "+s,document.getElementById("statusbar-info-epi").textContent="EPI : "+Af.value,document.getElementById("statusbar-info-ppi").textContent="PPI : "+Ff.value,document.getElementById("statusbar-info-width").textContent=`Width : ${a}"`,document.getElementById("statusbar-info-height").textContent=`Height : ${r}"`}},ay=()=>{const e=new FormData(ef),t=Object.fromEntries(e.entries());if(!ly(Math.floor(t["design-height"]),Math.floor(t["design-width"])))return pf=!0,lf.style.display="block",lf.innerText="Design height and width are not compatible",void setTimeout(()=>{lf.style.display="none",pf=!1},2e3);if(Uf(Math.floor(t["Total-Lsalvage"])),Jf(Math.floor(t["Total-Rsalvage"])),zf(Math.floor(t.shaft)),Gf(Math.floor(t["design-height"])),Xf(Math.floor(t["design-width"])),Zf(Math.floor(t["weft-height"])),Kf(Math.floor(t["warp-width"])),Fl(Math.floor(t["grid-height"])),Al(Math.floor(t["grid-width"])),Yf(t.unit),Qf(t["width-Lsalvage"]),ey(t["width-Rsalvage"]),ty(t["width-body"]),KB.update_size(parseInt($f.value)),JB.update_size(parseInt($f.value)),XB.update_size(parseInt(Hf.value)),YB.update_size(XB.size),GB.update_size(XB.size),Lv(),FB.change_draft_dimension(AB,DB,WB,ZB,HB,Math.floor(t.shaft),Math.floor(t["design-width"]),Math.floor(t["design-height"])),Xn){let e=Number(RB.value);HB.change_treadles_value(e,DB,FB,AB,HB)}eL&&eL(),rI(),ry(!0)},oy=()=>{const e=document.getElementsByClassName("new-file-form-field");for(let t=0;t<e.length;t++)e[t].addEventListener("change",e=>{const t=new FormData(ef),n=Object.fromEntries(t.entries());vf.value=parseFloat(vf.value).toFixed(2),bf.value=parseFloat(bf.value).toFixed(2),Lf.value=parseFloat(Lf.value).toFixed(2),wf.value=Number(n["width-Lsalvage"])+Number(n["width-Rsalvage"])+Number(n["width-body"]),Number(Ef.value)>40&&(Ef.value=40),If.value=Math.floor(If.value),Sf.value=Math.floor(Sf.value),kf.value=Math.floor(kf.value),xf.value=parseInt(Number(n.reed)/Number(n.inch)*Number(n["width-Lsalvage"])),Tf.value=parseInt(Number(n.reed)/Number(n.inch)*Number(n["width-body"])),_f.value=parseInt(Number(n.reed)/Number(n.inch)*Number(n["width-Rsalvage"])),Bf.value=Number(xf.value)+Number(Tf.value)+Number(_f.value),Pf.value=xf.value*Number(n["dentWarp-Lsalvage"]),Cf.value=Tf.value*Number(n["dentWarp-body"]),Nf.value=_f.value*Number(n["dentWarp-Rsalvage"]),Rf.value=Number(Pf.value)+Number(Cf.value)+Number(Nf.value),Af.value=parseFloat(Number(Cf.value)/Number(n["width-body"])).toFixed(2),Ff.value=parseFloat(n["weft-dencity"]).toFixed(2)});Qf(vf.value),ey(bf.value),tf.addEventListener("click",e=>{e.preventDefault(),or.style.visibility="visible",ny()}),nf.addEventListener("click",e=>{e.preventDefault(),Vf==Ul?iy():ay()}),ry(!0)},sy=e=>{Df.value=DB.rows(),Wf.value=FB.cols(),Ef.value=FB.rows(),Hf.value=XB.size,$f.value=KB.size,2==Sf.value?rf.innerHTML="&nbsp;":rf.innerHTML="User Define",e==Kl||e==Xl||e==Gl?(Vf=Yl,Qg.querySelector(".modal-title").innerHTML="<p>Edit File</p>"):(Mf.value=4,Of.value=4,Ef.value=12,vf.value=.5,bf.value=.5,Lf.value=45.5,jf.value=2,qf.value="inch",wf.value=parseFloat(46.5).toFixed(2),NB.value=96,xf.value=parseInt(96/Number(jf.value)*Number(.5)),Tf.value=parseInt(96/Number(jf.value)*Number(45.5)),_f.value=parseInt(96/Number(jf.value)*Number(.5)),Bf.value=Number(xf.value)+Number(Tf.value)+Number(_f.value),If.value=4,Sf.value=2,kf.value=4,RB.readOnly=!Xn,Pf.value=xf.value*Number(If.value),Cf.value=Tf.value*Number(Sf.value),Nf.value=_f.value*Number(kf.value),Uf(Number(Pf.value)),Jf(Number(Nf.value)),Rf.value=Number(Pf.value)+Number(Cf.value)+Number(Nf.value),Ff.value=52..toFixed(2),Af.value=parseFloat(Number(Cf.value)/Number(Lf.value)).toFixed(2),Df.value=cf,Wf.value=df,Hf.value=hf,$f.value=mf,Vf=Ul,Qg.querySelector(".modal-title").innerHTML="<p>New File</p>")},dy=document.getElementById("open-maindesign-modal"),cy=document.getElementById("open-maindesign-modal-trigger");let uy,my,hy,py,gy,fy,yy,vy;const by=e=>{for(let e=0;e<Dd.length;e++){let t=document.getElementById(Dd[e].id),n=t.querySelector(".open-pegplan-data-content-file-name"),l=t.querySelector("input");n.style.display="block",l.style.display="none",t.classList.remove("maindesign-file-active")}e.currentTarget.classList.add("maindesign-file-active");let t=Dd.find(t=>t.id==e.currentTarget.id);yy=t,wy(yy)},wy=e=>{console.log("selected main design data is",e),yy=e,fy.innerHTML="",vy.value=e.name},Ey=e=>{let t=[],n=[],l=[];t=[...new Set([...e.map(e=>e.shaft)])],n=[...new Set([...e.map(e=>e.picks)])],l=[...new Set([...e.map(e=>e.ends)])],my.innerHTML='<option value="">All</option>',py.innerHTML='<option value="">All</option>',hy.innerHTML='<option value="">All</option>';for(let e=0;e<t.length;e++){let n=document.createElement("option");n.value=t[e],n.innerHTML=t[e],py.appendChild(n)}for(let e=0;e<n.length;e++){let t=document.createElement("option");t.value=n[e],t.innerHTML=n[e],my.appendChild(t)}for(let e=0;e<l.length;e++){let t=document.createElement("option");t.value=l[e],t.innerHTML=l[e],hy.appendChild(t)}},Iy=async()=>{try{let e=await Ts();Wd(e.data.DATA),Ey(Dd),gy.innerHTML="<div>Loading...</div>";let t=document.createElement("div");for(let e=0;e<Dd.length;e++)t.innerHTML+=`<div class="open-pegplan-data-container-content" id="${Dd[e].id}">\n      <div class="open-pegplan-data-content-image">\n        <img src="maxweavefev.png" width="100">\n      </div>\n        <div class="open-pegplan-data-content-file-name">${Dd[e].name}</div>\n        <input style="display:none;"/>\n      </div>`;gy.innerHTML=t.innerHTML;const n=document.getElementById("renameDeleteMenu");for(let e=0;e<Dd.length;e++){const t=document.getElementById(Dd[e].id);Cw(t,n),t.addEventListener("contextmenu",by),t.addEventListener("click",by)}const l=document.getElementById("rename-trigger-element"),i=document.getElementById("delete-trigger-element");l.addEventListener("click",_y),i.addEventListener("click",By)}catch(e){console.log("err is",e)}},Sy=()=>{document.getElementById("mainContextMenu")&&(document.getElementById("mainContextMenu").style.display="none"),nv(),(async()=>{nv(),document.addEventListener("keydown",Ly),Iy()})(),dy.style.display="block",dy.style.animation="slide-down 0.3s ease"},ky=()=>{gy.innerHTML="",dy.style.display="none",yy=null,document.removeEventListener("keydown",Ly),Ol("")},xy=()=>{console.log("handle open called"),fd(yy),ky()},Ty=async e=>{if("Enter"==e.key){console.log("eeeeee",e.target.value);let t={mainDesignId:yy.id,name:e.target.value};try{let n=await ks(t);vd(n.data.DATA),Toastify({text:"File Saved Successfully",className:"info",style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast(),console.log("resData is",n);let l=document.getElementById(yy.id),i=l.querySelector(".open-pegplan-data-content-file-name");i.innerText=e.target.value;let r=l.querySelector("input");i.style.display="block",r.style.display="none",l.classList.remove("maindesign-file-active"),yy=null}catch(e){console.log("inside error",e)}}},_y=e=>{console.log("rename clicked",yy,e.target.parentNode),Pw();let t=document.getElementById(yy.id),n=t.querySelector(".open-pegplan-data-content-file-name"),l=t.querySelector("input");n&&(n.style.display="none"),l&&(l.value=yy.name,l.style.display="block",l.focus(),l.addEventListener("keydown",Ty))},By=async e=>{await kd("Are you sure you want to permanently delete this file?")?(console.log("delete design",yy),xs(yy.id).then(e=>{console.log("delete design succuss fully",e.data),Iy(),yd(yy.id),yy=null}).catch(e=>console.log("delete design failed"))):console.log("do not delete it")},Ly=async e=>{yy&&"Delete"==e.key&&(await kd("Are you sure you want to permanently delete this file?")?(console.log("delete design",yy),xs(yy.id).then(e=>{console.log("delete design succuss fully",e.data),Iy(),yd(yy.id),yy=null}).catch(e=>console.log("delete design failed"))):console.log("do not delete it"))},Py=e=>{let t=String(uy.value),n=String(my.value),l=String(py.value),i=String(hy.value),r=Dd.filter(e=>(0==t.length||String(e.name).toLowerCase().includes(t.toLowerCase()))&&(0==l.length||String(e.shaft).toLowerCase()==l.toLowerCase())&&(0==n.length||String(e.picks).toLowerCase()==n.toLowerCase())&&(0==i.length||String(e.ends).toLowerCase()==i.toLowerCase()));Ey(r),n&&(my.value=Number(n)),l&&(py.value=Number(l)),i&&(hy.value=Number(i));for(let e=0;e<Dd.length;e++){document.getElementById(Dd[e].id).style.display="none"}for(let e=0;e<r.length;e++){document.getElementById(r[e].id).style.display="block"}},Cy=document.getElementById("statusbar");const Ny=[{part:"View",keyData:[{command:"Repeat",keyName:"F5",Description:"Repeat On/Off"},{command:"Dencity",keyName:"F4",Description:"Dencity On Off"},{command:"Grid",keyName:"Ctrl+G",Description:"Change Grid Mode"},{command:"Rular",keyName:"Ctrl+R",Description:"Rular Show/Hide"},{command:"Skip Dent",keyName:"Alt+T",Description:"Skip Dent Show/Hide"},{command:"Scrollbar",keyName:"Alt+S",Description:"Scrollbar Show/Hide"},{command:"New File",keyName:"Alt+N",Description:"Create New File"}]},{part:"Design",keyData:[{command:"Warp Num Edit",keyName:"Alt+R",Description:"Open Warp Num Edit"},{command:"Weft Num Edit",keyName:"Alt+F",Description:"Open Weft Num Edit"},{command:"Draft Edit Num",keyName:"Alt+D",Description:"Open Draft Num Edit"},{command:"Pegplan Edit Num",keyName:"Alt+E",Description:"Open Pegplan Num Edit"},{command:"Add Row",keyName:"Ctrl+Click",Description:"Add Row In Draftplan And Pegplan"},{command:"Add Column",keyName:"Alt+Click",Description:"Add Column In Draftplan And Pegplan"},{command:"Remove Row",keyName:"Ctrl+Shift+Click",Description:"Remove Row In Draftplan And Pegplan"},{command:"Remove Column",keyName:"Alt+Shift+Click",Description:"Remove Column In Draftplan And Pegplan"}]}],Ry=()=>{Cl?(Ow.style.display="block",ju.style.display="block"):(Ow.style.display="none",ju.style.display="none"),rI()},Ay=()=>{tl?(zE.style.opacity="1",Rw.style.opacity="1"):(zE.style.opacity="0",Rw.style.opacity="0")},Fy=()=>{zl(!tl),du("isScrollBarVisible",tl),Ay(),rI()},My=()=>{Cy.style.display=nl?"none":"flex",nl=!nl,rI()},Oy=()=>{Cm(),gE(),Dm(),rI()},Dy=()=>{Gn=!Gn,Xc.checked=Gn,Xi.style.display=Gn?"block":"none",du("isBeamVisible",Gn),Oy()},Wy=()=>{(e=>{Nl=!Nl,e.style.display=Nl?"flex":"none"})(Sh),du("isDentClickCanvasVisible",Nl),Oy()},Hy=e=>{console.log("fullscreen called"),setTimeout(()=>{let e=Rw.scrollTop,t=zE.scrollLeft;rI(),iI({target:{scrollLeft:0}}),hE({target:{scrollTop:0}}),Rw.scrollTo(0,e),zE.scrollTo(t,0)},100)},$y=e=>{""==Vn&&(e.shiftKey?(e.preventDefault(),e.deltaY<0?zE.scrollLeft+=Rl:zE.scrollLeft-=Rl):(e.preventDefault(),e.deltaY<0?Rw.scrollTop-=Rl:Rw.scrollTop+=Rl))},qy=()=>{Ay(),Cl?(Ow.style.display="block",ju.style.display="block"):(Ow.style.display="none",ju.style.display="none");const e=()=>{Cm(),gE(),Dm()};document.addEventListener("fullscreenchange",Hy),document.addEventListener("mouseup",()=>{Ml(!1)}),document.addEventListener("keydown",t=>{"F3"==t.code&&(t.preventDefault(),zn=10,(e=>{Un=e})(10),Mn=!Mn,Mn||iI({target:{scrollLeft:0}}),e(),rI(),mE()),["F11"].includes(t.code)?(t.preventDefault(),Hy()):["Escape"].includes(t.code)?Hy():"ArrowLeft"==t.code?0==Vn.length&&(t.preventDefault(),zE.scrollLeft-=Rl):"ArrowRight"==t.code?0==Vn.length&&(t.preventDefault(),zE.scrollLeft+=Rl):"ArrowUp"==t.code?0==Vn.length&&(t.preventDefault(),Rw.scrollTop-=Rl):"ArrowDown"==t.code?0==Vn.length&&(t.preventDefault(),Rw.scrollTop+=Rl):"F4"==t.code?t.preventDefault():"F10"==t.code?(t.preventDefault(),location.reload(!0)):t.ctrlKey&&["g","G"].includes(t.key)?(t.preventDefault(),Bl==sl?Bl=dl:Bl==dl?Bl=cl:Bl==cl?Bl=ul:Bl==ul&&(Bl=sl),e()):t.ctrlKey&&["s","S"].includes(t.key)?(t.preventDefault(),Xd()):t.ctrlKey&&["j","J"].includes(t.key)?t.preventDefault():t.ctrlKey&&["o","O"].includes(t.key)?(t.preventDefault(),Sy()):t.ctrlKey&&["b","B"].includes(t.key)?featuresArray.includes("Double Beam")&&(t.preventDefault(),Dy()):t.altKey&&["KeyT"].includes(t.code)?(t.preventDefault(),Wy()):t.altKey&&["KeyS"].includes(t.code)&&(t.preventDefault(),Fy())}),document.addEventListener("wheel",$y)};let jy=document.getElementById("sub-menu"),Vy=document.getElementById("sub-part"),zy=(document.getElementById("file"),document.querySelector("#toggle-menu")),Uy=document.getElementById("sub-toolbar"),Yy=document.getElementById("print-menu"),Jy=document.getElementById("print-menu-trigger"),Gy=document.getElementById("import-menu"),Xy=document.getElementById("import-menu-trigger"),Ky=(document.getElementById("toggle-toolbar"),document.getElementById("toggle-part"));var Zy=null;let Qy=document.getElementById("menuScrollBar"),ev=document.getElementById("menuRuler"),tv=document.getElementById("menuStatusBar");document.addEventListener("DOMContentLoaded",(function(){for(var e=document.getElementsByClassName("menu-click"),t=null,n=0;n<e.length;n++)e[n].addEventListener("click",l);function l(){var e=this.nextElementSibling;t!==e?(t&&(t.classList.remove("absolute"),t.classList.add("none")),jy.classList.add("none"),Uy.classList.add("none"),Yy.classList.add("none"),Vy.classList.add("none"),e.classList.remove("none"),e.classList.add("absolute"),t=e):(e.classList.remove("absolute"),e.classList.add("none"),t=null)}document.addEventListener("click",(function(n){var l=n.target;Array.from(e).some((function(e){return e.contains(l)}))||!t||t.contains(l)||(t.classList.remove("absolute"),t.classList.add("none"),t=null)}))}));const nv=()=>{let e=document.querySelectorAll(".allSubMenu"),t=document.querySelectorAll(".toggle-menu");e.forEach(e=>{e.classList.add("none")}),t.forEach(e=>{e.classList.add("none")})};function lv(){var e=this.nextElementSibling;Zy!==e?(Zy&&(Zy.classList.remove("absolute"),Zy.classList.add("none")),jy.classList.add("none"),e.classList.remove("none"),e.classList.add("absolute"),Zy=e):(e.classList.remove("absolute"),e.classList.add("none"),Zy=null)}document.getElementById("draft-edit-num"),document.getElementById("total-end-dent");const iv=document.getElementById("edit-salvage-error-message"),rv=document.getElementById("leftSalvageDraft"),av=document.getElementById("rightSalvageDraft"),ov=document.getElementById("salvage-draft-warp-submit"),sv=document.getElementById("salvage-draft-warp-apply"),dv=document.getElementById("leftWarpTotal"),cv=document.getElementById("rightWarpTotal"),uv=document.getElementById("leftWarpSequence"),mv=document.getElementById("rightWarpSequence"),hv=document.getElementById("edit-salvage-plain-shaft"),pv=document.getElementById("edit-salvage-shaft-position");let gv={draftPlan:"",warpSeq:""},fv={draftPlan:"",warpSeq:""};const yv=document.getElementById("edit-salvage-trigger"),vv=document.getElementById("draft-warp-seq"),bv=(document.getElementById("draft-warp-seq"),e=>{gv=e,rv.value=gv.draftPlan,uv.value=gv.warpSeq}),wv=e=>{fv=e,av.value=fv.draftPlan,mv.value=fv.warpSeq},Ev=(e,t,n,l)=>{let i="",r=[];if("first"==n){let t=0;for(let n=0;n<e;n++)t>=e&&(t=1),r[t]=n+1,t+=1;let n=0;for(;i+=r[n%e]+" ",(n+1)%l==0&&(i+="\n"),n++,0==n||n%e!=0||n%l!=0;);return"["+i.trim()+"]"}if("last"==n){let n=0;for(let t=0;t<e;t++)n>=e&&(n=1),r[n]=t+1,n+=1;r=r.map(n=>n+(t-e));let a=0;for(;i+=r[a%e]+" ",(a+1)%l==0&&(i+="\n"),a++,0==a||a%e!=0||a%l!=0;);return"["+i.trim()+"]"}},Iv=()=>{let e=pv.value,t=Number(hv.value),n=Number(If.value),l=Number(kf.value),i=FB.rows();console.log("position is",e),console.log("plain ShaftValue",t),av.value=Ev(t,i,e,l)+"X"+String(Math.round(Number(Oi.value)/Number(Ov(Ev(t,i,e,l).replace("[","").replace("]",""))))),mv.value=Oi.value+"A",rv.value=Ev(t,i,e,n)+"X"+String(Math.round(Number(fi.value)/Number(Ov(Ev(t,i,e,n).replace("[","").replace("]",""))))),uv.value=fi.value+"A",console.log("function eennnnddd==>",rv.value,uv.value,mv.value,av.value)},Sv=e=>{Iv()},kv=e=>{Iv()},xv=()=>{let e=Pv(String(mb(rv.value)).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e))),t=Pv(String(mb(av.value)).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e)));return e!=Number(dv.value)?(iv.style.display="block",iv.innerText="Left salvage total warp length doesn't match with draft plan",!1):t!=Number(cv.value)?(iv.style.display="block",iv.innerHTML="Right salvage total warp length doesn't match with draft plan",!1):(iv.style.display="none",gv.draftPlan=rv.value,fv.draftPlan=av.value,gv.warpSeq=uv.value,fv.warpSeq=mv.value,!0)},Tv=()=>{xv()&&Bv()},_v=()=>{let e=Number(Ef.value);hv.max=e,nv(),console.log("asdas",Number(hv.value)),Lv(),Number(hv.value)||(hv.value=2,Iv()),vv.style.display="block",vv.style.animation="slide-down 0.3s ease";vv.querySelector(".modal-title").innerText="Selvedge Draft And Warp Sequence"},Bv=()=>{vv.style.display="none"},Lv=()=>{let e={2:"[1 2]",4:"[1 2 1 2]",6:"[1 2 1 2 1 2]"};gv.draftPlan&&gv.warpSeq?(rv.value=gv.draftPlan,uv.value=gv.warpSeq):(rv.value=e[Number(If.value)]+"X"+String(Number(fi.value)/Number(If.value)),uv.value=fi.value+"A"),fv.draftPlan&&fv.warpSeq?(av.value=fv.draftPlan,mv.value=fv.warpSeq):(av.value=e[Number(kf.value)]+"X"+String(Number(Oi.value)/Number(If.value)),mv.value=Oi.value+"A"),dv.value=fi.value,cv.value=Oi.value};function Pv(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n].length;return t}function Cv(e,t){let n=e.filter(e=>e.Part==t),l=0;for(let e=0;e<n.length;e++)l+=n[e].draft.withInnerRepeat.length;return l}const Nv=(e,t)=>{let n=String(e).includes("\n")?"\n":"<br>",l=e.split(n),i=String(l[0]).trim().split(","),r=String(l[1]).trim().split(","),a="";for(let e=1;e<=t;e++)i.includes(String(e))?a+=e+" ":a+="0 ",r.includes(String(e))?a+=t+e+" ":a+="0 ";return a=a.trim(),a},Rv=e=>/[a-zA-Z]/.test(e);function Av(e,t){let n=0;for(let l=0;l<e.length;l++)e.charAt(l)===t&&n++;return n}const Fv=()=>{let e={},t="",n=0;for(let e=0;e<=KB.getMaximumIndex();e++){let l=KB.findElementFromIndex(e);l?(n>0&&(t+=n.toString()+"\n"),t+=l.color_code+"\n",n=0):n++}String(t).split("\n").forEach(t=>{if(Rv(t)){let n=cb(t).trim(),l=isNaN(parseInt(t))?1:parseInt(t);e[n]?e[n]+=l:e[n]=l}});const l=Object.keys(e);l.sort();const i={};for(const t of l)i[t]=e[t];return i},Mv=(e,t=!1)=>{let n=String(e).split("\n").filter(e=>e.length>0).join("\n"),l=[],i="";for(let e=0;e<n.length;e++){let r=0,a=e;if("["==n[e]){if(i.length>0){let e={repeatedPart:i.trim(),...t&&{innerRepeat:1},...!t&&{outerRepeat:1}};l.push(e),i=""}for(r++,a=e+1;0!=r;)if("["==n[a]?(r++,2==r&&(i+=n[a])):"]"==n[a]?(2==r&&(i+=n[a]),r--):i+=n[a],a++,0==r&&i.length>0){let e=0,r=a+1;for(;!("\n"==n[r]&&0!=e||(e++,r++,r>n.length)););let o={repeatedPart:i.trim(),...t&&{innerRepeat:Number(n.slice(a+1,a+e+1))},...!t&&{outerRepeat:Number(n.slice(a+1,a+e+1))}};l.push(o),i="",a+=e}}else if(e-1>=0&&i.trim().length>0&&"\n"!=n[e]&&Kv(n,e)){let r={repeatedPart:i.trim(),...t&&{innerRepeat:1},...!t&&{outerRepeat:1}};l.push(r),i=n[e]}else i+=n[e];e=a}if(i.length>0){let e={repeatedPart:i.trim(),...t&&{innerRepeat:1},...!t&&{outerRepeat:1}};l.push(e)}return l=l.filter(e=>e.repeatedPart.length>0),console.log("Output array is",l),l},Ov=e=>String(e).trim().split(/<br>|\s+/).length;const Dv=e=>{let t=mb(e),n=0;return String(t).split("\n").forEach((e,t)=>{e.split(" ").forEach((e,t)=>{e.trim().length>0&&(n+=e.length>1?parseInt(e):1)})}),n},Wv=e=>{let t=String(e).split("X");if(1==t.length)return{repeat:1,currentPart:e};let n=t.slice(0,-1).join("X").slice(1,-1);return{repeat:parseInt(t.at(-1)),currentPart:n}},Hv=e=>{let t=[],n=$v(e);return console.log("string parts is",n),Array.isArray(n)&&n.forEach(e=>{t.push((e=>{let t={},n=Wv(e);if(Av(e,"[")<2)t={innerParts:[{currentPart:n.currentPart,innerRepeat:n.repeat}],outerRepeat:1};else{let e=$v(n.currentPart),l=[];e.forEach(e=>{let t=Wv(e);l.push({currentPart:t.currentPart,innerRepeat:t.repeat})}),t={innerParts:l,outerRepeat:n.repeat}}return t})(e))}),t},$v=e=>{let t=[],n=0,l=0,i="";for(let r=0;r<e.length;r++)if(l>0&&l--,"["==e[r]){for(i+=e[r],n++,r++;0!=n;)if("["==e[r]?(i+=e[r],n++,r++):"]"==e[r]?(i+=e[r],n--,r++):(i+=e[r],r++),0==n){for(;"\n"!=e[r];)if(i+=e[r],r++,r==e.length-1){i+=e[r];break}t.push(i),i=""}}else i+=e[r],"["!=e[r+1]&&r+1!=e.length||(t.push(i),i="");return t},qv=(e,t,n)=>{let l="",i="",r=t;for(let i=r;i<t+n;i++)l+=e[i]+"\n";r+=n;for(let t=r;t<r+n;t++)i+=e[t]+"\n";return l.trim()==i.trim()},jv=(e,t)=>{let n=[];if(!t)return n;let l=Jv(t,Ov(mb(e.repeatedPart))),i=(e=>{let t=[1],n=[],l=[];if(Array.isArray(e)){if(e.length<2)return t;let i=1;for(;i!=parseInt(e.length/2);){let t=Yv(e,i);l.push(t);for(let e=0;e<t.length;e++)if(t[e]==t[e+1]){n.push(i);break}i++}let r=[];for(let t=0;t<n.length;t++)e.length%n[t]==0&&r.push(n[t]);if(r.length>0)return r}return t})(l),r=[];for(let t=0;t<i.length;t++){console.log("value fof kios",t,i.length);let n=[];for(let r=0;r<e.outerRepeat;r++){let a=r,o=1;for(;qv(l,a,i[t]);)o++,a+=i[t];if(r==a)n.push({repeatedPart:e.repeatedPart,outerRepeat:o});else{let l="";for(let n=0;n<i[t];n++)l+=e.repeatedPart+"\n";l=l.trim(),n.push({repeatedPart:l,outerRepeat:o}),r=a+i[t]-1}}r.push({repeatationTocheck:i[t],tempOutputObject:n})}let a=r.map(e=>JSON.stringify(e.tempOutputObject).length);return n=[...r[(e=>{if(0===e.length)return-1;let t=0;for(let n=1;n<e.length;n++)e[n]<e[t]&&(t=n);return t})(a)].tempOutputObject],console.log("output object is",n),n},Vv=e=>{let t=String(e),n=Zv(t.trimEnd());n=n.filter(e=>e.repeatedPart.length>0);let l=String(ab(!0)).split("\n"),i=0,r=[];for(let e=0;e<n.length;e++){let t=Ov(mb(n[e].repeatedPart))*n[e].outerRepeat,a=jv(n[e],l.slice(i,i+t).join("\n"));i+=t,r=[...r,...a]}n=r,console.log("output is convertDraftStringToArrayWithDoubleBracket",n);let a=0,o=er();const s=new Uint32Array(aL.memory.buffer,ZB.get_different_beam_cell_indexes(),ZB.get_different_beam_cell_length());return console.log("differentBeamCells",s),n.forEach(e=>{e.withInnerRepeat=Mv(e.repeatedPart,!0);let t=0;if(Array.isArray(e.withInnerRepeat)){let n=e.withInnerRepeat;if(n.forEach(e=>{t+=Ov(e.repeatedPart.split(" ").filter(e=>!Rv(e)).join(" "))*e.innerRepeat}),t*=e.outerRepeat,o){let n=l.slice(a,a+t),i=s.filter(e=>e>=a&&e<a+t).map(e=>e-a),r=[],o=[];r=((e,t)=>{let n=[];for(let l=0;l<e.length;l++)t.includes(l)||n.push(e[l]);return n})(n,i),i.forEach(e=>{o.push(n[e])}),e.pattern=r.join("\n"),o.length>0?e.topbeam=o.join("\n"):e.topbeam=""}else e.pattern=l.slice(a,a+t).join("\n");let i=e.pattern.split("\n"),r=0;n.forEach(e=>{console.log("current pattern split array is",i);let t=Ov(mb(e.repeatedPart))*e.innerRepeat,n=fb(mb(e.repeatedPart));e.ends=t,e.dent=n*e.innerRepeat;let l=i.slice(r,r+t).join("\n");e.pattern=lb(l,e.ends,e.dent),r+=t;let a=Mv(iL(e.repeatedPart));1==a.length&&(e.repeatedPart=a[0].repeatedPart,e.innerRepeat=a[0].outerRepeat*e.innerRepeat)});let d=[];for(let e=0;e<n.length;e++){let t=n[e].ends/n[e].dent;if(Gp.unCompressDents.includes(t)){let l=e,i={repeatedPart:"",innerRepeat:0,ends:0,dent:0,pattern:""};for(;n[l].ends/n[l].dent==t;){for(let e=0;e<n[l].innerRepeat;e++)i.repeatedPart+=n[l].repeatedPart.trim()+"\n";if(i.innerRepeat=1,i.dent+=n[l].dent,i.ends+=n[l].ends,i.pattern+=n[l].pattern.trim()+"\n",l++,l==n.length)break}if(i.repeatedPart.length>0){i.pattern=mb(i.pattern);let e="";String(i.pattern).split("\n").filter(e=>e.length>0).forEach(t=>{t.split(" ").forEach(t=>{let n=isNaN(parseInt(t))?1:parseInt(t);for(let l=0;l<n;l++)e+=cb(t)+"\n"})}),i.pattern=lb(e.trim(),i.ends,i.dent),d.push(i)}e=l-1}else d.push(n[e])}e.withInnerRepeat=[...d],e.ends=Dv(e.pattern.trim()),e.dent=fb(mb(e.repeatedPart))*e.outerRepeat,a+=t}}),n=n.filter(e=>e.repeatedPart),n};const zv=(e,t=!1)=>{let n=String(e),l="";for(let e=0;e<n.length;e++)"X"!=n[e]&&Rv(n[e])&&!/[0-9]/.test(n[e-1])?l+="1"+n[e]:l+=n[e];return t&&(l=l.replace(/(\d)([A-Za-z])/g,"$1-$2")),l=Gp.isVerticalPattern&&t?l.replace(/[\s\n]+/g,"<br>"):l,l};function Uv(e,t){let n=1/0,l=-1/0;for(const e in t)if(t.hasOwnProperty(e)){const i=t[e];i<n&&(n=i),i>l&&(l=i)}if(e<n||e>l)throw new Error("Value out of range");return l==n?10:(e-n)/(l-n)*10}const Yv=(e,t)=>{let n=[],l="",i=0;for(let r=0;r<e.length;r++)l+=e[r]+"\n",i++,i==t&&(n.push(l.trim()),l="",i=0);return l.length>0&&n.push(l.trim()),n},Jv=(e,t)=>{let n=[],l="",i=0,r=/^[a-zA-Z]+$/;for(let a=0;a<e.length;a++)l+=e[a],r.test(e[a])&&(i+=1),i==t&&(n.push(l.trim()),l="",i=0);return n},Gv=(e,t)=>{let n=String(e),l=Zv(n.trimEnd());l=l.filter(e=>e.repeatedPart.length>0);let i=mb(t),r="";String(i).split("\n").filter(e=>e.length>0).forEach(e=>{e.split(" ").forEach(e=>{let t=isNaN(parseInt(e))?1:parseInt(e);for(let n=0;n<t;n++)r+=cb(e)+"\n"})}),r=r.trim();let a=r.split("\n");console.log("output is convertDraftStringToArrayWithDoubleBracket",l);let o=0;return l.forEach(e=>{e.withInnerRepeat=Mv(e.repeatedPart,!0);let t=0;if(Array.isArray(e.withInnerRepeat)){e.withInnerRepeat.forEach(e=>{t+=Ov(e.repeatedPart.split(" ").filter(e=>!Rv(e)).join(" "))*e.innerRepeat}),t*=e.outerRepeat,e.pattern=a.slice(o,o+t).join("\n"),e.ends=Dv(e.pattern.trim()),e.dent=fb(mb(e.repeatedPart))*e.outerRepeat,o+=t}}),l=l.filter(e=>e.repeatedPart),l};function Xv(e,t){var n=e.split("\n"),l=-1;for(let e=0;e<n.length;e++)if((l+=n[e].length+1)>=t)return e}const Kv=(e,t)=>{let n=String(e),l=n.split("\n"),i=Xv(n,t),r=t-1;for(;0!=r&&0==n[r].trim().length;)r--;if(0==r)return!1;let a=Xv(n,r);return yb(l[i])!=yb(l[a])},Zv=e=>{let t=String(e),n=[],l="";for(let e=0;e<t.length;e++){let i=0,r=e;if("["==t[e]){if(l.length>0){let e={repeatedPart:l.trim(),...!1,outerRepeat:1};n.push(e),l=""}for(i++,r=e+1;0!=i;)if("["==t[r]?(i++,2==i&&(l+=t[r])):"]"==t[r]?(2==i&&(l+=t[r]),i--):l+=t[r],r++,0==i&&l.length>0){let e=1;for(;!["[","]"," ","\n"].includes(t[r+e])&&t[r+e];)console.log("inputString[j+repeatStringLength]",t[r+e]),e++;let i=t.slice(r+1,r+e),a={repeatedPart:l.trim(),...!1,outerRepeat:Number(i)};n.push(a),l="",r=r+e-1}}else if(e-1>=0&&l.trim().length>0&&"\n"!=t[e]&&Kv(t,e)){let i={repeatedPart:l.trim(),...!1,outerRepeat:1};n.push(i),l=t[e]}else l+=t[e];e=r}if(l.length>0){let e={repeatedPart:l.trim(),...!1,outerRepeat:1};n.push(e)}return n},Qv=()=>{let e={},t="",n=0;for(let e=XB.size-1;e>=XB.getMinimumIndex();e--){let l=XB.findElementFromIndex(e);l?(n>0&&(t+=n.toString()+"\n"),t+=l.color_code+"\n",n=0):n++}String(t).split("\n").forEach(t=>{if(Rv(t)){let n=cb(t).trim(),l=isNaN(parseInt(t))?1:parseInt(t);e[n]?e[n]+=l:e[n]=l}});const l=Object.keys(e);l.sort();const i={};for(const t of l)i[t]=e[t];return i},eb=e=>{let t={},n="";return String(mb(e)).split("\n").filter(e=>e.length>0).forEach(e=>{e.split(" ").forEach(e=>{let t=isNaN(parseInt(e))?1:parseInt(e);for(let l=0;l<t;l++)n+=e.slice(-1)+"\n"})}),String(n).split("\n").forEach(e=>{if(Rv(e)){let n=cb(e).trim(),l=isNaN(parseInt(e))?1:parseInt(e);t[n]?t[n]+=l:t[n]=l}}),t},tb=()=>{if(Object.keys(Gs).length>0){let e={};return Object.keys(Gs).forEach(t=>{e[t]=Number(ml.start)+Number(Gs[t])-1}),e}{let e={},t="",n=0;for(let e=XB.size-1;e>=XB.getMinimumIndex();e--){let l=XB.findElementFromIndex(e);l?(n>0&&(t+=n.toString()+"\n"),t+=l.color_code+"\n",n=0):n++}String(t).split("\n").forEach(t=>{if(Rv(t)){let n=cb(t).trim(),l=isNaN(parseInt(t))?1:parseInt(t);e[n]?e[n]+=l:e[n]=l}});let l={};const i=Object.entries(e).sort((e,t)=>t[1]-e[1]),r=Object.fromEntries(i);return Object.keys(r).forEach(e=>{l[e]=Object.values(l).at(-1)?Object.values(l).at(-1)+1:ml.start}),l}},nb=e=>{let t=String(e),n=[];for(let e=0;e<t.length;e++)t[e].replace(/[^a-zA-Z]+/g,"")&&t[e].replace(/[^a-zA-Z]+/g,"")[0]&&n.push(t[e].replace(/[^a-zA-Z]+/g,"")[0]);return n=[...new Set([...n])],n=n.filter(e=>"X"!=e).sort(),n},lb=(e,t,n)=>{if(t%n!=0)return nL(e);let l=t/n,i=0,r=[],a=0,o="";for(;e[i];)o+=e[i],e[i].trim().length>0&&a++,a==l&&(r.push(o),o="",a=0),i++;o.trim().length>0&&r.push(o),r=r.filter(e=>e.trim().length>0),console.log("string of repeated part is",r);let s=(e=>{if(Array.isArray(e)&&e.length>0){let t=e[0].trim();if(1==nb(t).length)return"";for(let n=1;n<e.length;n++){if(e[n].trim()!=t)return"";if(n+1==e.length){return`[${lL(t)}]X${e.length}`}}return""}return""})(r);if(s.length>0)return s;{let t=nL(e);return nL(t)}},ib=()=>{let e=document.getElementById("loom-type"),t=Boolean("rapier-manual-dobby"==e.value),n=[],l=DB.get_new_print_pegplan_data(Gp.isInvertDesign),i=String(l).trim().split("\n");if(Gp.pegplanViewType==fl.WATERJETLETIS)for(let e=0;e<i.length;e+=2)n.push({no:String(e+1)+(i[e+1]?"-"+String(e+2):""),pegplan:i.slice(e,e+2).map(e=>e.replace(/\s+/g,",")).join("\n")});else if(Gp.isTwoPickLetisEnabled)for(let e=0;e<i.length;e+=2)n.push({no:String(Math.ceil(n.length+1)),pegplan:i.slice(e,e+2).map(e=>e.replace(/\s+/g,",")).join("\n")});else for(let e=0;e<i.length;e+=1)n.push({no:String(n.length+1),pegplan:i[e].replace(/\s+/g,",")});if(t&&ml.start&&ml.end&&hl.start&&hl.end&&Gp.pegplanViewType!=fl.WATERJETLETIS){let e=tb();console.log("fidder color ",e),n.forEach((t,n)=>{let l=t.pegplan.split("\n"),i=[];l.forEach((t,l)=>{let r=XB.findElementFromIndex(XB.size-(n*(Gp.isTwoPickLetisEnabled?2:1)+l)-1),a=YB.findElementFromIndex(XB.size-(n*(Gp.isTwoPickLetisEnabled?2:1)+l)-1);if(r){let n=t+""+(Gp.isWeftSelector?","+e[r.color_code]:"");a&&Gp.isCreaming&&(n+=","+hl.start),i.push(n)}else{let e=t+""+(Gp.isWeftSelector?","+ml.start:"");a&&Gp.isCreaming&&(e+=","+hl.start),i.push(e)}}),t.pegplan=i.join("\n")})}if(Gp.isUncompreesed)return n;let r=[],a=0;for(;a<n.length;){let e=Number(n[a].no),t=Number(n[a].no),l=!1;for(;a<n.length&&n[a+1]&&n[a].pegplan==n[a+1].pegplan;)l=!0,e++,a++;l?(r.push({no:`${t}-${e}`,pegplan:n[a].pegplan}),a++):(r.push({no:""+t,pegplan:n[a].pegplan}),a++)}return r},rb=()=>{let e=document.getElementById("loom-type"),t=Boolean("rapier-manual-dobby"==e.value),n=DB.get_new_print_pegplan_data(!1);console.log("pegplan numeric text is",n);let l=String(n).split("\n").filter(e=>e),i=[...l];if(t&&ml.start&&ml.end&&hl.start&&hl.end){let e=tb();console.log("fidder color ",e);let t=[];l.forEach((n,l)=>{let i=XB.findElementFromIndex(XB.size-l-1),r=YB.findElementFromIndex(XB.size-l-1);if(i){let l=n+" "+e[i.color_code];r&&(l+=" "+hl.start),t.push(l)}else{let e=n+" "+ml.start;r&&(e+=" "+hl.start),t.push(e)}}),i=[...t]}return iL(i.join("\n"))},ab=(e=!1)=>{let t="",n=0;for(let e=0;e<=KB.getMaximumIndex();e++){let l=KB.findElementFromIndex(e);l?(n>0&&(t+=n.toString()+"\n"),t+=l.color_code+"\n",n=0):n++}if(e)return t;let l=nL(t);return zv(nL(l),!1).replace(/[\s]+/g,"\n")},ob=()=>{let e="",t=0;for(let n=XB.size-1;n>=XB.getMinimumIndex();n--){let l=XB.findElementFromIndex(n);l?(t>0&&(e+=t.toString()+"\n"),e+=l.color_code+"\n",t=0):t++}return zv(nL(nL(e)),!1).replace(/[\s]+/g,"\n")},sb=e=>String(e).split("\n").map(e=>e.split(" ").map(e=>e.padStart(3," ")).join(" ")).join("\n"),db=()=>{let e=[],t=FB.convert_new_index_to_numeric(WB),n=Math.floor(FB.cols()/Number(Wf.value)),l=gv.draftPlan.split("X")[0]?gv.draftPlan.split("X")[0].replace("[","").replace("]",""):"",i=fv.draftPlan.split("X")[0]?fv.draftPlan.split("X")[0].replace("[","").replace("]",""):"";e.push({draft:{outerRepeat:1,pattern:String(uv.value),dent:Number(xf.value),ends:Number(fi.value),withInnerRepeat:[{repeatedPart:l,innerRepeat:1,pattern:String(uv.value),dent:Number(xf.value),ends:Number(fi.value)}]},dent:xf.value,tar:fi.value,pattern:"Pattern",Part:"Left Selvedge"});let r=Vv(t);if(console.log("tableDraftDataWithDoubleBracket issss",r),Array.isArray(r)){console.log("totalWarpBodyElement.value",Cf.value);let t=WB.total_dent_value();r.forEach(l=>{e.push({draft:l,dent:String((Gp.isFullReedSpaceVisible?n:1)*t),tar:FB.cols(),pattern:"Pattern",topbeam:"TopBeam",Part:"Body"})})}return e.push({draft:{outerRepeat:1,pattern:String(mv.value),dent:Number(_f.value),ends:Number(Oi.value),withInnerRepeat:[{repeatedPart:i,innerRepeat:1,pattern:String(mv.value),dent:Number(_f.value),ends:Number(Oi.value)}]},dent:_f.value,tar:Oi.value,pattern:"Pattern",Part:"Right Selvedge"}),console.log("table draft data is",e),e},cb=e=>e.replace(/\d/g,"");function ub(e){return e.replace(/\D/g,"")}const mb=(e,t=!1)=>{let n="",l=1,i=0,r=0;if(Av(e,"[")!=Av(e,"]"))return n;for(let t=0;t<e.length;t++)if(i=0,r=0,"["===e[t]){if(i=1,!String(e).substring(t+1).includes("]"))break;{let a=t+1,o="";for(;r!=i;){if(a>e.length)return"";"["==e[a]?i++:"]"==e[a]&&r++,a++}a-=1,o=String(e).substring(t+1,a)+"\n",o.includes("[")&&o.includes("]")&&(o=mb(o)),a+=2;let s="";for(;"\n"!=String(e)[a]&&String(e)[a];)s+=String(e)[a],a++;l=Number(s);n+=o.repeat(l),t=a}}else n+=e[t];return t?n:n.replace(/(^[ \t]*\n)/gm,"")};const hb=e=>{let t=String(e),n="",l=0;for(;l<t.length;){if(Rv(t[l])){n+=Pr[t[l]]&&Pr[t[l]].yarnName?Pr[t[l]].yarnName:t[l]}else n+=t[l];l++}return n},pb=e=>{let t=String(e),n="",l=0;for(;l<t.length;){if(Rv(t[l])){n+=Pr[t[l]]?Pr[t[l]].yarnName:t[l]}else n+=t[l];l++}return n},gb=e=>{let t=String(e),n="",l=0;for(;l<t.length;){if(Rv(t[l])){n+=th[t[l]]?th[t[l]].yarnName:t[l]}else n+=t[l];l++}return n},fb=e=>(console.log("calculateTotalDent input stribng is",e.split("\n")),String(e).split("\n").filter(e=>e.length>0).length),yb=e=>Pv(String(e).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e))),vb=e=>{Toastify({text:e,gravity:"top",backgroundColor:"linear-gradient(to right, #ff4040, #ff7373)"}).showToast()},bb=e=>{try{JSON.parse(e);return!0}catch(e){return!1}},wb=document.getElementById("color-modal"),Eb=document.getElementById("warp-color-row"),Ib=document.getElementById("weft-color-row"),Sb=document.getElementById("warp-color-row-container"),kb=document.getElementById("weft-color-row-container"),xb=document.getElementById("function-color-row"),Tb=document.getElementById("function-color-row-container"),_b=document.getElementById("model-color-label"),Bb=document.getElementById("except-color-part"),Lb=document.getElementById("selected-warp-color"),Pb=document.getElementById("selected-weft-color"),Cb=document.getElementById("selected-function-color"),Nb=document.getElementById("model-apply"),Rb=document.getElementById("model-ok"),Ab=document.getElementById("model-color"),Fb=document.getElementById("yarn-name"),Mb=document.getElementById("yarn-type"),Ob=document.getElementById("model-letter-box"),Db=document.getElementById("weft-color-row-left-arrow"),Wb=document.getElementById("weft-color-row-right-arrow"),Hb=document.getElementById("function-color-row-left-arrow"),$b=document.getElementById("function-color-row-right-arrow"),qb=document.getElementById("warp-color-row-left-arrow"),jb=document.getElementById("warp-color-row-right-arrow"),Vb=document.getElementById("model-warp-weft-selection");var zb=0;const Ub={WARP:"Warp",WEFT:"Weft",FUNCTION:"Function",NONE:"None"};let Yb=Ub.NONE;var Jb=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];const Gb=e=>{Yb=e,e==Ub.WARP?(kb.style.display="none",Tb.style.display="none",Sb.style.display="flex"):e==Ub.WEFT?(Sb.style.display="none",Tb.style.display="none",kb.style.display="flex"):e==Ub.FUNCTION?(Sb.style.display="none",kb.style.display="none",Tb.style.display="flex"):(Sb.style.display="none",kb.style.display="none",Tb.style.display="none")},Xb=e=>{const t=e.id.slice(0,4),n=e.getBoundingClientRect(),l=Array.from(e.children).filter(e=>{const t=e.getBoundingClientRect();return t.left>=n.left&&t.right<=n.right});if("warp"==t){let e=String.fromCharCode(String(l.at(-1).children[0].id.slice(-1)).charCodeAt()+1);document.getElementById("warp-color-"+e)&&document.getElementById("warp-color-"+e).scrollIntoView({behavior:"smooth"})}else if("weft"==t){let e=String.fromCharCode(String(l.at(-1).children[0].id.slice(-1)).charCodeAt()+1);document.getElementById("weft-color-"+e)&&document.getElementById("weft-color-"+e).scrollIntoView({behavior:"smooth"})}else{let e=String.fromCharCode(String(l.at(-1).children[0].id.slice(-1)).charCodeAt()+1);document.getElementById("function-color-"+e)&&document.getElementById("function-color-"+e).scrollIntoView({behavior:"smooth"})}},Kb=e=>{const t=e.id.slice(0,4),n=e.getBoundingClientRect(),l=Array.from(e.children).filter(e=>{const t=e.getBoundingClientRect();return t.left>=n.left&&t.right<=n.right});if("warp"==t){let e=String.fromCharCode(String(l[0].children[0].id.slice(-1)).charCodeAt()-3);document.getElementById("warp-color-"+e)?document.getElementById("warp-color-"+e).scrollIntoView({behavior:"smooth"}):document.getElementById("warp-color-A").scrollIntoView({behavior:"smooth"})}else if("weft"==t){let e=String.fromCharCode(String(l[0].children[0].id.slice(-1)).charCodeAt()-2);document.getElementById("weft-color-"+e)?document.getElementById("weft-color-"+e).scrollIntoView({behavior:"smooth"}):document.getElementById("weft-color-A").scrollIntoView({behavior:"smooth"})}else{let e=String.fromCharCode(String(l[0].children[0].id.slice(-1)).charCodeAt()-2);document.getElementById("function-color-"+e)?document.getElementById("function-color-"+e).scrollIntoView({behavior:"smooth"}):document.getElementById("function-color-A").scrollIntoView({behavior:"smooth"})}},Zb=()=>{wb.style.display="none"},Qb=()=>{console.log("modelWarpWeftSelectionElement value is",Vb.value),"weft"==Vb.value?(Qm[""+Ob.value]=Ab.value,Pb.style.backgroundColor=Ab.value,document.getElementById("weft-color-"+Ob.value).style.backgroundColor=Qm[""+Ob.value],th[Ob.value]={...th[Ob.value],yarnType:Mb.value,yarnName:Fb.value},yh()):"warp"==Vb.value?(Lr[""+Ob.value]=Ab.value,Lb.style.backgroundColor=Ab.value,document.getElementById("warp-color-"+Ob.value).style.backgroundColor=Lr[""+Ob.value],Pr[Ob.value]={...Pr[Ob.value],yarnType:Mb.value,yarnName:Fb.value},Hr()):(eh[""+Ob.value]=Ab.value,Cb.style.backgroundColor=Ab.value,document.getElementById("function-color-"+Ob.value).style.backgroundColor=eh[""+Ob.value],mh()),"radio-color"==Yn?wI():"radio-interlacement"==Yn&&EI(),console.log("Warp info onjecac",Pr),console.log("Weft info object ",th)},ew=()=>{Qb(),Zb()},tw=()=>{for(let e=65;e<=90;e++){let t=document.getElementById("weft-color-"+String.fromCharCode(e)),n=document.getElementById("warp-color-"+String.fromCharCode(e)),l=document.getElementById("function-color-"+String.fromCharCode(e));t&&(t.style.backgroundColor=Qm[""+String.fromCharCode(e)]),n&&(n.style.backgroundColor=Lr[""+String.fromCharCode(e)]),l&&(l.style.backgroundColor=eh[""+String.fromCharCode(e)])}Lb.style.backgroundColor=Lr[Br],Cb.style.backgroundColor=eh[Km],Pb.style.backgroundColor=Qm[Xm],yh(),Hr(),mh(),"radio-color"==Yn?wI():"radio-interlacement"==Yn&&EI()};function nw(e,t,n){const l=wb.querySelector(".close-button"),i=wb.querySelector("#btn-cancel");e.addEventListener("contextmenu",e=>{var n;e.preventDefault(),n=t,wb.style.display="block",wb.style.animation="slide-down 0.3s ease",wb.querySelector(".modal-title").textContent=n}),e.addEventListener("mousedown",t=>{var n;console.log("button id slice 0-4",e.id.slice(0,4)),console.log("function color is",eh),Ob.value=e.id.slice(-1),Vb.value=e.id.slice(0,4),"warp"==e.id.slice(0,4)?(Lb.innerText=e.id.slice(-1)+" ||",n=e.id.slice(-1),Br=n,Lb.style.backgroundColor=Lr[e.id.slice(-1)],Ab.value=mu(Lr[e.id.slice(-1)]),Fb.value=Pr[e.id.slice(-1)]?Pr[e.id.slice(-1)].yarnName:"",Mb.value=Pr[e.id.slice(-1)]?Pr[e.id.slice(-1)].yarnType:"",Bb.style.display="block",_b.style.display="none"):"weft"==e.id.slice(0,4)?(Pb.innerText=e.id.slice(-1)+" =",(e=>{Xm=e})(e.id.slice(-1)),Pb.style.backgroundColor=Qm[e.id.slice(-1)],Ab.value=mu(Qm[e.id.slice(-1)]),Fb.value=th[e.id.slice(-1)]?th[e.id.slice(-1)].yarnName:"",Mb.value=th[e.id.slice(-1)]?th[e.id.slice(-1)].yarnType:"",Bb.style.display="block",_b.style.display="none"):((e=>{Zm=e})(e.id.slice(-1)),Cb.style.backgroundColor=eh[e.id.slice(-1)],Ab.value=mu(eh[e.id.slice(-1)]),Bb.style.display="none",_b.style.display="inline")}),l.addEventListener("click",Zb),n&&i&&i.addEventListener("click",Zb)}const lw=document.getElementById("weftSubContext"),iw=(document.getElementById("subParent"),document.getElementById("mainContextMenu")),rw=document.getElementById("design-menu"),aw=document.getElementById("design-mode"),ow=document.getElementById("sub-context-design-mode"),sw=document.getElementById("draftplan-design-mode"),dw=document.getElementById("sub-context-draft-design-mode"),cw=document.getElementById("pegplan-design-mode"),uw=document.getElementById("sub-context-pegplan-design-mode"),mw=document.getElementById("subcontext-trigger-draft-import"),hw=document.getElementById("subcontext-menu-draft-import"),pw=document.getElementById("subcontext-trigger-pegplan-import"),gw=document.getElementById("subcontext-menu-pegplan-import"),fw=document.getElementById("sub-context-design"),yw=document.getElementById("insert-menu"),vw=document.getElementById("sub-context-insert"),bw=document.getElementById("wsInsert-menu"),ww=document.getElementById("sub-context-wsInsert"),Ew=document.getElementById("insert-trigger"),Iw=document.getElementById("sub-context-wcInsert"),Sw=document.getElementById("warpCanvasMenu");let kw=[];const xw=document.getElementById("colorPaletteContextMenuWarp"),Tw=document.getElementById("colorPaletteContextMenuWeft"),_w=document.getElementById("colorPaletteContextMenuFunction");function Bw(e,t){e.addEventListener("click",()=>{t.classList.toggle("none")}),window.addEventListener("click",n=>{n.target===e||t.contains(n.target)||t.classList.add("none")})}const Lw=()=>{Bw(rw,fw),Bw(aw,ow),Bw(sw,dw),Bw(cw,uw),Bw(mw,hw),Bw(pw,gw),Cw(Hu,lw),Cw(Aw,Sw),Bw(yw,vw),Cw(FE,iw),Bw(bw,ww),Bw(Ew,Iw),Cw(Lb,xw),Cw(Pb,Tw),Cw(Cb,_w),document.querySelector('input[name="radio-design-view"]')&&document.querySelectorAll('input[name="radio-design-view"]').forEach((e,t)=>{0==t&&(e.checked=!0),e.addEventListener("change",(function(e){var t=e.target.value;Yn=t,iw.style.display="none",fw.classList.toggle("none"),console.log("valleeeeee",t),dI()}))}),document.querySelector('input[name="radio-design-mode"]')&&document.querySelectorAll('input[name="radio-design-mode"]').forEach((e,t)=>{e.addEventListener("change",(function(e){var t=e.target.value;ow.classList.toggle("none"),iw.style.display="none",console.log("selected item is",t),lI(t),t==wl?(AB.turn_on_drawing_on_command(),mI(!0)):mI(!1)}))}),document.querySelector('input[name="draft-radio-design-mode"]')&&document.querySelectorAll('input[name="draft-radio-design-mode"]').forEach((e,t)=>{e.addEventListener("change",(function(e){var t=e.target.value;if(dw.classList.toggle("none"),lw.style.display="none",console.log("selected item is",t),pm(t),t==El){let e=FB.convert_new_index_to_numeric(WB),t=ob(),n=ab(),l=FB.get_fix_numeric_text(),i=KB.fixNumericText,r=XB.fixNumericText;mb(l).trim()!=mb(e).trim()&&FB.change_fix_numeric_text(e),mb(i).trim()!=mb(n)&&KB.setFixNumericText(n),mb(r).trim()!=mb(t)&&XB.setFixNumericText(t)}}))}),document.querySelector('input[name="pegplan-radio-design-mode"]')&&document.querySelectorAll('input[name="pegplan-radio-design-mode"]').forEach((e,t)=>{e.addEventListener("change",(function(e){var t=e.target.value;if(uw.classList.toggle("none"),Sw.style.display="none",console.log("selected item is",t),pE(t),t==Sl){let e=DB.convert_new_index_to_numeric(),t=DB.get_fix_numeric_text();mb(t).trim()!=mb(e).trim()&&DB.change_fix_numeric_text(e)}}))})},Pw=()=>{kw.forEach(e=>{e.style.display="none"})};function Cw(e,t){kw.push(t);document.body;const n=t;let l=!1;n.style.position="absolute",n.style.zIndex="9999",window.addEventListener("keyup",e=>{"Escape"===e.key&&(n.style.display="none")}),e.addEventListener("contextmenu",(function(t){if(console.log("event====>",t),kw.forEach(e=>{e.style.display="none"}),t.ctrlKey)return;t.preventDefault(),nv();const i=t.clientX,r=t.clientY,a=window.innerWidth,o=n.offsetWidth,s=n.offsetHeight,d=i<a/2?i:i-o,c=Math.min(r,window.innerHeight-s);n.style.display="block",n.style.left=d+"px",n.style.top=c+"px";let u=(e=>{const t=e.getBoundingClientRect();return{isTopOverflow:t.top<0,isBottomOverFlow:t.bottom+50>(window.innerHeight||document.documentElement.clientHeight),isLeftOverFlow:t.left<0,isRightOverFlow:t.right>(window.innerWidth||document.documentElement.clientWidth)}})(n);console.log("overflow check",u,"for",n),u.isTopOverflow,u.isBottomOverFlow&&(n.style.top=String(c-parseInt(getComputedStyle(n).height))+"px"),u.isLeftOverFlow,u.isRightOverFlow&&(n.style.left=String(d-parseInt(getComputedStyle(n).width))+"px"),l=!0,window.addEventListener("click",(function(t){l&&!n.contains(t.target)&&t.target!==e&&(n.style.display="none",l=!1)}))}))}const Nw=document.getElementById("pegplan-column"),Rw=document.getElementById("vertical-scroll-container"),Aw=document.getElementById("warp-canvas"),Fw=Aw.getContext("2d"),Mw=(document.getElementById("weftSubParent"),document.getElementById("subParent")),Ow=document.getElementById("warp-scale-container"),Dw=document.getElementById("edit-design-from-pegplan"),Ww=document.getElementById("pegplan-column"),Hw=document.getElementById("header-edit-design-trigger"),$w=(document.getElementById("main-dent-container"),document.getElementById("main-canvas")),qw="#warp-canvas-brush-svg",jw=document.getElementById("warp-canvas-brush-svg");let Vw,zw,Uw,Yw,Jw,Gw,Xw=!1,Kw=!1,Zw=[],Qw=[],eE=[],tE=[],nE=[],lE=!1,iE=!1,rE=!1,aE=[],oE=0,sE=0,dE=-1,cE=Bu,uE=kl;const mE=()=>{const e=(Mn?Un:1)*AB.rows()*(Jn?AB.height():Rl);var t=Mw.clientHeight>0?e>Mw.clientHeight:e>Nw.clientHeight;if(oE=Nw.clientHeight-Aw.height,t){let e=0;Mw.style.paddingTop="0px",Nw.style.paddingTop="0px",Hm.style.paddingTop="0px",$m.style.paddingTop="0px",Gm.style.paddingTop="0px",jw.style.top="0px",Rw.scrollTo(0,Rw.scrollHeight-Rw.clientHeight+e),hE({target:{scrollTop:Rw.scrollHeight-Rw.clientHeight+e}})}else Mw.style.paddingTop=Mw.clientHeight-$w.height+"px",Nw.style.paddingTop=Nw.clientHeight-Aw.height+"px",jw.style.top=oE+"px",Hm.style.paddingTop=Hm.clientHeight-qm.height+"px",$m.style.paddingTop=$m.clientHeight-Vm.height+"px",Gm.style.paddingTop=Gm.clientHeight-Um.height+"px",hE({target:{scrollTop:0}}),Mw.style.paddingTop=Mw.clientHeight-$w.height+"px",Nw.style.paddingTop=Nw.clientHeight-Aw.height+"px",jw.style.top=oE+"px",Hm.style.paddingTop=Hm.clientHeight-qm.height+"px",$m.style.paddingTop=$m.clientHeight-Vm.height+"px",Gm.style.paddingTop=Gm.clientHeight-Um.height+"px"},hE=e=>{let t=e.target.scrollTop,n=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl;t=parseInt(Rw.scrollTop/n)*n;const l=(Mn?Un:1)*AB.rows()*n;console.log("total main canvas height",l,parseInt(eI/n)*n,t),l-n-parseInt(eI/n)*n==t&&sE<t&&(t+=n);let i=AB.rows();console.log("middle part height arre=====>?",eI),console.log("Scroll toppp===>",t),qn.startRow=eI>l?1:parseInt(l-parseInt(eI/n)*n-t)/n+1,qn.endRow=qn.startRow+parseInt(eI/n)-1,console.log("visibleObjectConfig are",qn),console.log("design rows",i),console.log("middle part height is",parseInt(eI/n)*n),console.log("main canvas height is",$w.height),Rw.scrollTo(Rw.scrollLeft,t),sE=t,gE()},pE=e=>{uE=e;let t=document.getElementById(e);t&&(t.checked=!0)};const gE=()=>{const e=qn.startRow,t=qn.endRow,n=DB.rows();let l=n*Rl*(Mn?Un:1);KE.style.height=l+"px";const i=1*AB.width(),r=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl,a=DB.get_visible_cells(e,t,Mn,r),o=bb(a)?JSON.parse(a):[],s=DB.cols(),d=Mn?t-e+1:Math.min(t-e+1,n),c=document.createElement("canvas");if(c.width=Math.ceil(s*i),c.height=Math.ceil(d*r),0==c.height||0==c.width)return;const u=c.getContext("2d");if(u.clearRect(0,0,c.width,c.height),u.fillStyle="white",u.fillRect(0,0,c.width,c.height),u.fillStyle="black",o.forEach((e,t)=>{e.forEach(e=>{u.fillRect(t*i,(d-e)*r,i,r)})}),Bl==sl){for(let e=0;e<s+1;e++)u.beginPath(),u.strokeStyle="grey",u.moveTo(e*i,0),u.lineTo(e*i,d*r),u.lineWidth=e%Wn==0?1.5:.5,u.stroke(),u.closePath();for(let t=0;t<d+1;t++)u.beginPath(),u.strokeStyle="grey",u.moveTo(0,t*r),u.lineTo(s*i,t*r),u.lineWidth=(d-t+e-1)%Hn==0?1.5:.5,u.stroke(),u.closePath()}else if(Bl==dl){u.lineWidth=.5;for(let e=0;e<s+1;e++)u.beginPath(),u.strokeStyle="grey",u.moveTo(e*i,0),u.lineTo(e*i,d*r),u.stroke(),u.closePath();for(let e=0;e<d+1;e++)u.beginPath(),u.strokeStyle="grey",u.moveTo(0,e*r),u.lineTo(0+s*i,e*r),u.stroke(),u.closePath()}else if(Bl==cl){u.lineWidth=1.5;for(let e=0;e<s+1;e++)e%Wn==0&&(u.beginPath(),u.strokeStyle="grey",u.moveTo(e*i,0),u.lineTo(e*i,d*r),u.stroke(),u.closePath());for(let t=0;t<d+1;t++)(d-t+e-1)%Hn==0&&(u.beginPath(),u.strokeStyle="grey",u.moveTo(0,t*r),u.lineTo(s*i,t*r),u.stroke(),u.closePath())}else{u.lineWidth=1.5;for(let e=0;e<s+1;e+=s)e%Wn==0&&(u.beginPath(),u.strokeStyle="grey",u.moveTo(e*i,0),u.lineTo(e*i,d*r),u.stroke(),u.closePath());for(let e=0;e<d+1;e+=d)(d-e)%Hn==0&&(u.beginPath(),u.strokeStyle="grey",u.moveTo(0,e*r),u.lineTo(s*i,e*r),u.stroke(),u.closePath())}u.closePath(),Fw.clearRect(0,0,Aw.width,Aw.height),Aw.width=c.width,Aw.height=c.height,Fw.drawImage(c,0,0),dI(),fh(),hh(),ph()},fE=e=>{const t=qn.startRow,n=qn.endRow,l=DB.rows(),i=Aw.getBoundingClientRect(),r=1*AB.width(),a=Jn?1*AB.height():Rl,o=Mn?n-t+1:Math.min(n-t+1,l),s=(DB.cols(),e.clientX-i.left),d=(e.clientY-i.top)%(o*a),c=(t-1+o-parseInt(d/a)-1)%l;console.log("Reach row ",c);const u=parseInt(s/r);if(console.log("visibility object config",qn),!Gw){let e=DB.check_if_index_exist_or_not(c,u);console.log("isElement exist",e),Gw=e?Cu:Pu}if(console.log("current pencilt tool mode is",Gw),Gw==Pu)Xn?(DB.add_cell_tieupmode(c,u,AB,FB,HB),CE(),bI()):(DB.add_cell_new(c,u,AB,FB,HB),gE());else if(Gw==Cu)if(Xn)DB.remove_cell_tieupmode(c,u,AB,FB,HB),CE(),bI();else{DB.remove_cell_new(c,u,AB,FB,HB);gE()}},yE=e=>{if(Fu==xu){if(e.ctrlKey&&"KeyE"==e.code){e.preventDefault();let t=DB.rows(),n=[];for(let e=0;e<Zw.length;e++){let l=Number(zw.select(".selection").attr("x")),i=Number(zw.select(".selection").attr("y")),r=(Zw[e].y+i)/Rl;r=t-r-1;let a=(Zw[e].x+l)/Rl;DB.add_cell_new(r,a,AB,FB,HB),n.push(a)}IE(n),_E()}if(e.altKey&&LE(!iE),e.shiftKey&&(rE=!0),"Escape"==e.code&&_E(),"F8"==e.code){e.preventDefault();let t=[];for(let e=0;e<Zw.length;e++)t.push(parseInt(Zw[e].y/Rl));const n=[...new Set(t)];console.log("Selected row are",n,Zw),n.forEach(e=>{YB.update_function_cell(e,Km)}),gh()}if("F9"==e.code){e.preventDefault();let t=[];for(let e=0;e<Zw.length;e++)t.push(parseInt(Zw[e].y/Rl));[...new Set(t)].forEach(e=>{GB.update_function_cell(e,Zm)}),mh()}}},vE=e=>{"Shift"==e.key&&(rE=!1)},bE=e=>{if(Fu!=xu);else if(!Xw){Xw=!0;d3.select("#pegplan-column").node();let t=zw.select(qw).style("z-index","1").style("width",Aw.width+"px").style("height",Aw.height+"px").style("pointer-events","all");const n=new MouseEvent("mousedown",e);t.select("rect.overlay").node().dispatchEvent(n)}},wE=e=>{if(uE!=Sl){if(Fu==Tu&&!Kw){Kw=!0;const t=Aw.getBoundingClientRect(),n=DB.cols(),l=DB.cell_size(),i=(e.clientX-t.left)%(n*l),r=e.clientY-t.top;Uw={x:i,y:r},function(e){const t=Aw.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top,i=Fw.getImageData(n,l,1,1).data,r=i[0],a=i[1],o=i[2];console.log("clicked pixle ",r,a,o),cE=0===r&&0===a&&0===o?Lu:Bu}(e)}if(Fu==ku){if(0==e.button&&e.ctrlKey&&!Xn){const t=Aw.getBoundingClientRect(),n=1*AB.width(),l=Jn?1*AB.height():Rl,i=DB.rows();DB.cols();let r=Rw.scrollTop;console.log("tempscroll value",r);const a=e.clientX-t.left,o=(e.clientY-t.top)%(i*l)+r,s=i-parseInt(o/l)-1;parseInt(a/n);return console.log("remopve rows",s,XB),e.shiftKey?(DB.remove_row(s,AB,FB,HB),XB.remove_cell(s),YB.remove_cell(s)):(DB.add_row(s,AB,FB,HB),XB.add_cell(s),YB.add_cell(s)),Hf.value=DB.rows(),ry(),eL(),rI(),void Rw.scrollTo(0,r)}if(0==e.button&&e.altKey&&!Xn){const t=Aw.getBoundingClientRect(),n=1*AB.width(),l=Jn?1*AB.height():Rl,i=DB.rows();if(DB.cols()>=40)return void vb("Maxium 40 shaft allowed");const r=e.clientX-t.left,a=(e.clientY-t.top)%(i*l),o=i-parseInt(a/l)-1,s=parseInt(r/n);console.log("column add pegplan",o,s),e.shiftKey?DB.remove_col(s,AB,FB,HB):DB.add_col(s,AB,FB,HB);let d=Rw.scrollTop;return Ef.value=DB.cols(),ry(),eL(),rI(),void Rw.scrollTo(0,d)}Gb(Ub.NONE),0==e.button&&(Ml(!0),fE(e))}}},EE=e=>{if(Fu==ku)return void(Gw=null);Kw=!1,console.log("current Line Tool Mode is",cE);const t=DB.rows(),n=DB.cols();cE==Bu&&nE.forEach(e=>{DB.add_cell_new(t-parseInt(e/n)-1,e%n,AB,FB,HB)}),cE==Lu&&nE.forEach(e=>{DB.remove_cell_new(t-parseInt(e/n)-1,e%n,AB,FB,HB)}),nE=[],Jw=-1,dE=-1,Gw=null,Ml(!1),CE(),Uw=null};const IE=e=>{if(!Mn)return void(e=>{DB.cols();const t=DB.rows(),n=1*AB.width(),l=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl,i=On,r=Dn;if(Array.isArray(e))for(let a=0;a<e.length;a++){Fw.clearRect(e[a]*n,0,n,Aw.height),Fw.fillStyle="white",Fw.fillRect(e[a]*n,0,n,Aw.height);const o=new Uint32Array(aL.memory.buffer,DB.new_cells(e[a]),DB.selected_col_new_cell_length(e[a]));Fw.fillStyle="black",o.forEach(i=>{Fw.fillRect(e[a]*n,(t-i)*l,n,l)});for(let o=0;o<t+1;o++)Fw.beginPath(),Fw.strokeStyle="grey",Fw.moveTo(i+e[a]*n,r+o*l),Fw.lineTo(i+e[a]*n+n,r+o*l),Fw.lineWidth=(t-o)%Hn==0?1.5:.5,Fw.stroke(),Fw.closePath();for(let o=0;o<2;o++)Fw.beginPath(),Fw.strokeStyle="grey",Fw.moveTo(i+e[a]*n+o*n,r),Fw.lineTo(i+e[a]*n+o*n,r+t*l),Fw.lineWidth=(e[a]+o)%Wn==0?1.5:.5,Fw.stroke(),Fw.closePath()}})(e);const t=DB.cols(),n=DB.rows(),l=1*AB.width(),i=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl,r=On,a=Dn,o=document.createElement("canvas"),s=o.getContext("2d");o.width=Math.ceil(t*l),o.height=Math.ceil(n*i);const d=Fw.getImageData(0,$w.height-o.height,o.width,o.height);if(s.putImageData(d,0,0),Array.isArray(e))for(let t=0;t<e.length;t++){s.clearRect(e[t]*l,0,l,o.height),s.fillStyle="white",s.fillRect(e[t]*l,0,l,o.height);for(let o=0;o<n+1;o++)s.beginPath(),s.strokeStyle="grey",s.moveTo(r+e[t]*l,a+o*i),s.lineTo(r+e[t]*l+l,a+o*i),s.lineWidth=(n-o)%Hn==0?1.5:.5,s.stroke(),s.closePath();for(let o=0;o<2;o++)s.beginPath(),s.strokeStyle="grey",s.moveTo(r+e[t]*l+o*l,a),s.lineTo(r+e[t]*l+o*l,a+n*i),s.lineWidth=(e[t]+o)%Wn==0?1.5:.5,s.stroke(),s.closePath();const d=new Uint32Array(aL.memory.buffer,DB.new_cells(e[t]),DB.selected_col_new_cell_length(e[t]));s.fillStyle="black",d.forEach(r=>{s.fillRect(e[t]*l,(n-r)*i,l,i)})}Aw.width=o.width,Aw.height=o.height*Un;const c=Fw.createPattern(o,"repeat");Fw.rect(0,0,Aw.width,Aw.height),Fw.fillStyle=c,Fw.fill()},SE=e=>{if(uE!=Sl){if(Fu==Tu&&Kw){const t=Aw.getBoundingClientRect(),n=DB.cell_size(),l=DB.cols(),i=(e.clientX-t.left)%(l*n),r=e.clientY-t.top,a=parseInt(Uw.x/n),o=parseInt(Uw.y/n);Jw=a+o*l;let s=parseInt(i/n),d=parseInt(r/n);return dE=s+d*l,void CE()}Ll&&0==e.button&&fE(e),oI(Gl,e)}},kE=()=>{sy(Gl)},xE=()=>{Aw.addEventListener("mousedown",wE),Aw.addEventListener("mouseup",EE),Aw.addEventListener("mousemove",SE),Aw.addEventListener("mouseleave",gI),Rw.addEventListener("scroll",hE),document.addEventListener("keydown",yE),document.addEventListener("keyup",vE),(()=>{const e=document.getElementById("wcInsert-weft-trigger"),t=document.getElementById("wcInsert-shaft-trigger"),n=document.getElementById("wcInsert-weft-modal"),l=document.getElementById("wcInsert-shafts-modal"),i=(document.querySelectorAll(".close-button"),document.querySelectorAll(".btn-cancel"));fo(e,n,0,i,"Insert Weft"),fo(t,l,0,i,"Insert Shaft"),fo(Dw,Ka,0,i,"Edit File"),fo(Hw,Ka,0,i,"Edit File")})(),Dw.addEventListener("click",kE),Hw.addEventListener("click",kE)},TE=e=>{if(e.selection)if("handle"===e.mode){let[[t,n],[l,i]]=e.selection;if(Yw||(e=>{(e.sourceEvent.srcElement.classList.value.includes("--ne")||e.sourceEvent.srcElement.classList.value.includes("--se")||e.sourceEvent.srcElement.classList.value.includes("--sw")||e.sourceEvent.srcElement.classList.value.includes("--nw")||e.sourceEvent.srcElement.classList.value.includes("--s")||e.sourceEvent.srcElement.classList.value.includes("--n")||e.sourceEvent.srcElement.classList.value.includes("--w")||e.sourceEvent.srcElement.classList.value.includes("--e"))&&(console.log("class list is",e.sourceEvent.srcElement.classList),e.sourceEvent.srcElement.classList.value.includes("--ne")?Yw=_u.TOP_RIGHT:e.sourceEvent.srcElement.classList.value.includes("--se")?Yw=_u.BOTTOM_RIGHT:e.sourceEvent.srcElement.classList.value.includes("--sw")?Yw=_u.BOTTOM_LEFT:e.sourceEvent.srcElement.classList.value.includes("--nw")?Yw=_u.TOP_LEFT:e.sourceEvent.srcElement.classList.value.includes("--s")?Yw=_u.BOTTOM:e.sourceEvent.srcElement.classList.value.includes("--n")?Yw=_u.TOP:e.sourceEvent.srcElement.classList.value.includes("--w")?Yw=_u.LEFT:e.sourceEvent.srcElement.classList.value.includes("--e")&&(Yw=_u.RIGHT))})(e),Qw.length>0)if(rE){const[[e,r],[a,o]]=Qw;if(console.log("current Direction is",Yw),console.log("last selected area is",Qw),[_u.TOP].includes(Yw))n-=n%Rl,zw.select(qw).call(Vw.move,[[e,n],[a,o]]);else if([_u.BOTTOM].includes(Yw))i+=Rl-i%Rl,zw.select(qw).call(Vw.move,[[e,r],[a,i]]);else if([_u.RIGHT].includes(Yw))l+=Rl-l%Rl,zw.select(qw).call(Vw.move,[[e,r],[l,o]]);else if([_u.LEFT].includes(Yw))t-=t%Rl,zw.select(qw).call(Vw.move,[[t,r],[a,o]]);else if([_u.TOP_RIGHT].includes(Yw)){Math.abs(a-l)>=Math.abs(r-n)?(l+=Rl-l%Rl,n=r+(a-l)):(n-=n%Rl,l=a+(r-n)),zw.select(qw).call(Vw.move,[[e,n],[l,o]])}else if([_u.TOP_LEFT].includes(Yw)){Math.abs(e-t)>=Math.abs(r-n)?(t-=t%Rl,n=r-(e-t)):(n-=n%Rl,t=e-(r-n)),zw.select(qw).call(Vw.move,[[t,n],[a,o]])}else if([_u.BOTTOM_LEFT].includes(Yw)){Math.abs(e-t)>=Math.abs(o-i)?(t-=t%Rl,i=o+(e-t)):(i+=Rl-i%Rl,t=e+(o-i)),zw.select(qw).call(Vw.move,[[t,r],[a,i]])}else if([_u.BOTTOM_RIGHT].includes(Yw)){Math.abs(a-l)>=Math.abs(o-i)?(l+=Rl-l%Rl,i=o-(a-l)):(i+=Rl-i%Rl,l=a-(o-i)),zw.select(qw).call(Vw.move,[[e,r],[l,i]])}else[_u.BOTTOM_LEFT,_u.BOTTOM_RIGHT,_u.TOP_LEFT,_u.TOP_RIGHT].includes(Yw)&&(t-=t%Rl,n-=n%Rl,l+=Rl-l%Rl,i+=Rl-i%Rl)}else t=Math.round(t/Rl)*Rl,n=Math.round(n/Rl)*Rl,l=Math.round(l/Rl)*Rl,i=Math.round(i/Rl)*Rl,zw.select(qw).call(Vw.move,[[t,n],[l,i]]);else{t-=t%Rl,n-=n%Rl,l+=Rl-l%Rl,i+=Rl-i%Rl;for(let e=0;e<aE.length;e++)aE[e].classList.add("crosshair-cursor");zw.select(qw).call(Vw.move,[[t,n],[l,i]])}}else if("drag"===e.mode){let[[t,n],[l,i]]=e.selection;t-=t%Rl,n-=n%Rl,l+=Rl-l%Rl,i+=Rl-i%Rl;let[[r,a],[o,s]]=Qw,d=o-r,c=s-a;if(zw.select(qw).call(Vw.move,[[t,n],[t+d,n+c]]),iE){lE=!0;Math.ceil(Qw[0][0]/1),Math.ceil(Qw[0][1]/1),Math.ceil(t/1),Math.ceil(n/1);zw.selectAll(".selected-square").remove(),Zw.forEach(e=>{zw.select(qw).append("rect").attr("class","selected-square").attr("x",e.x+t).attr("y",e.y+n).attr("width",Rl).attr("height",Rl).style("fill","yellow")}),CE()}else lE&&zw.select(qw).call(Vw.move,eE)}},_E=()=>{Xw=!1,lE=!1,LE(!1),zw.select(qw).style("z-index","-1").call(Vw.move,[[0,0],[0,0]]),Qw=[],tE=[],Zw=[],zw.selectAll(".selected-square").remove(),CE()},BE=e=>{let[[t,n],[l,i]]=e,r=DB.rows(),a=[];for(let e=t;e<=l;e+=Rl){let o=parseInt(e/Rl);new Uint32Array(aL.memory.buffer,DB.new_cells(o),DB.selected_col_new_cell_length(o)).forEach(e=>{let s=o*Rl,d=(r-e)*Rl;t<=s&&s<l&&n<=d&&d<i&&a.push({x:Math.abs(s-t),y:Math.abs(d-n)})})}Zw=JSON.parse(JSON.stringify(a)),console.log("brush pegplan selected data is in ended",Zw)},LE=e=>{iE=e,iE?zw.select(".selection").style("cursor","grab"):zw.select(".selection").style("cursor","move")},PE=()=>{zw=d3.select(Aw.parentElement),Vw=d3.brush().keyModifiers(!1).extent([[0,0],[Aw.width,Aw.height]]).on("start",e=>{console.log("handle brush started called")}).on("brush",e=>TE(e)).on("end",e=>(e=>{if(!e.selection)return void _E();let[[t,n],[l,i]]=e.selection;if("handle"===e.mode){BE([[t,n],[l,i]]),zw.select(qw).call(Vw.move,[[t,n],[l,i]]);for(let e=0;e<aE.length;e++)aE[e].classList.remove("crosshair-cursor");Qw=[[t,n],[l,i]],eE=[[t,n],[l,i]]}"drag"==e.mode&&(iE||(BE([[t,n],[l,i]]),Qw=[[t,n],[l,i]]),eE=[[t,n],[l,i]])})(e)).filter(e=>"contextmenu"!=e.type);const e=zw.select(qw);e.call(Vw),Aw.removeEventListener("mousedown",bE),Aw.addEventListener("mousedown",bE),e.on("contextmenu",e=>{_E()}),aE=Ww.getElementsByTagName("rect")},CE=()=>{const e=DB.cols(),t=DB.rows(),n=1*AB.width(),l=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl,i=On,r=Dn,a=document.createElement("canvas");if(a.width=Math.ceil(e*n),a.height=Math.ceil(t*l),0==a.height||0==a.width)return;const o=a.getContext("2d");if(o.clearRect(0,0,a.width,a.height),o.fillStyle="white",o.fillRect(0,0,a.width,a.height),o.fillStyle="black",Fw.clearRect(0,0,Aw.width,Aw.height),Bl==sl){for(let a=0;a<e+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.lineWidth=a%Wn==0?1.5:.5,o.stroke(),o.closePath();for(let a=0;a<t+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.lineWidth=(t-a)%Hn==0?1.5:.5,o.stroke(),o.closePath()}else if(Bl==dl){o.lineWidth=.5;for(let a=0;a<e+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.stroke(),o.closePath();for(let a=0;a<t+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.stroke(),o.closePath()}else if(Bl==cl){o.lineWidth=1.5;for(let a=0;a<e+1;a++)a%Wn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.stroke(),o.closePath());for(let a=0;a<t+1;a++)(t-a)%Hn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.stroke(),o.closePath())}else{o.lineWidth=1.5;for(let a=0;a<e+1;a+=e)a%Wn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.stroke(),o.closePath());for(let a=0;a<t+1;a+=t)(t-a)%Hn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.stroke(),o.closePath())}for(let i=0;i<e;i++){new Uint32Array(aL.memory.buffer,DB.new_cells(i),DB.selected_col_new_cell_length(i)).forEach(e=>{o.fillRect(i*n,(t-e)*l,n,l)})}if(o.fillStyle="red",-1!=Jw&&-1!=dE&&(((e,t,n,l)=>{nE=[],console.log("inside drawLine sx sy",e,t,n,l);const i=DB.cols();let r={};let a=(o=n-e,s=l-t,Math.atan(s/(0==o?.01:o))+(o<0?Math.PI:0));var o,s,d,c,u,m,h;d=e,c=t,u=n,m=l,h=a,Math.abs(d-u)>Math.abs(c-m)?(r.x=Math.sign(Math.cos(h)),r.y=Math.tan(h)*Math.sign(Math.cos(h)),r.long=Math.abs(d-u)):(r.x=Math.tan(Math.PI/2-h)*Math.sign(Math.cos(Math.PI/2-h)),r.y=Math.sign(Math.cos(Math.PI/2-h)),r.long=Math.abs(c-m)),console.log("tri area",r);for(let n=0;n<r.long;n++){let l={x:Math.round(e+r.x*n),y:Math.round(t+r.y*n)};nE.push(l.y*i+l.x)}})(Jw%e,parseInt(Jw/e),dE%e,parseInt(dE/e)),nE.forEach(e=>{o.fillRect(e%DB.cols()*n,parseInt(e/DB.cols())*l,n,l)})),o.fillStyle="yellow",tE.forEach(e=>{o.fillRect(e.x,e.y,n,l)}),o.closePath(),Mn){Aw.width=a.width,Aw.height=a.height*Un;const e=Fw.createPattern(a,"repeat");Fw.rect(0,0,Aw.width,Aw.height),Fw.fillStyle=e,Fw.fill()}else Aw.width=a.width,Aw.height=a.height,Fw.drawImage(a,0,0);Dm(),bI(),PE(),Number(fi.value),Number(Oi.value)},NE=document.getElementById("active-part"),RE=document.getElementById("active-warp-weft-color"),AE=document.getElementById("active-warp-weft-text"),FE=document.getElementById("main-canvas"),ME=FE.getContext("2d"),OE=document.getElementById("subParent"),DE=document.getElementById("main-content-column-container"),WE=document.getElementById("weftSubParent"),HE=document.getElementById("edit-design-from-maindesign"),$E=document.getElementById("nav-bar-container"),qE=document.getElementById("color-penal-container"),jE=document.getElementById("sidebar-container"),VE=document.getElementById("first-row-container"),zE=(document.getElementById("main-dent-container"),document.getElementById("horizontal-scroll-container")),UE=document.getElementById("horizontal-scroll-child"),YE=document.getElementById("mapping-canvas-container"),JE=document.getElementById("calculate-draft-pegplan"),GE=document.getElementById("mapping-canvas"),XE=GE.getContext("2d"),KE=document.getElementById("vertical-scroll-child");let ZE,QE=0,eI=0,tI=0,nI=yl;const lI=e=>{nI=e},iI=e=>{let t=e.target.scrollLeft;t=parseInt(t/Rl)*Rl;(Mn?zn:1)*AB.cols()*AB.width()-Rl-parseInt(QE/Rl)*Rl==t&&tI<t&&(t+=Rl),qn.startColumn=parseInt(t/Rl),qn.endColumn=parseInt(t/Rl)+parseInt(QE/Rl)-1,zE.scrollTo(t,0),console.log("visibleObjectconfig",qn),tI=t,Cm()},rI=()=>{let e=lh.offsetWidth,t=document.documentElement.clientWidth,n=tl?Rw.offsetWidth:0,l=tl?parseInt(getComputedStyle(Rw).marginLeft):0,i=Nw.offsetWidth,r=parseInt(getComputedStyle(OE).marginLeft),a=parseInt(getComputedStyle(Nw).marginLeft),o=jE.offsetWidth,s=ju.offsetWidth,d=Cr.offsetHeight,c=Or.offsetHeight;QE=t-(e+n+l+i+r+a+o+s+30);let u=document.querySelector(":root");u.style.setProperty("--middle-part-width",parseInt(QE/Rl)*Rl+"px"),Or.style.width=parseInt(QE/Rl)*Rl-2+"px";let m=VE.offsetHeight,h=document.documentElement.clientHeight,p=tl?zE.offsetHeight:0,g=tl?parseInt(getComputedStyle(zE).marginTop):0,f=Cr.clientHeight;f=0==f?10:f;let y=parseInt(getComputedStyle(OE).marginTop),v=parseInt(getComputedStyle(Cr).marginTop),b=$E.offsetHeight,w=qE.offsetHeight,E=Ow.offsetHeight;eI=h-(m+p+g+f+y+v+w+b+E+d+c+(Kn?10:40));parseInt(getComputedStyle(VE).marginTop),parseInt(getComputedStyle(ih).marginTop);let I=Jn?AB.height():Rl;u.style.setProperty("--middle-part-height",parseInt(eI/I)*I+"px");if(0==VE.offsetHeight){let e=50;lh.style.marginTop=e+"px",Nw.style.marginTop=e+"px",Rw.style.marginTop=e+"px",DE.style.marginTop=e+"px",OE.style.marginTop="0px",VE.style.marginTop="0px",YE.style.marginTop="0px"}else VE.style.marginTop="50px",YE.style.marginTop="50px",OE.style.marginTop="2px",Nw.style.marginTop=VE.offsetHeight+parseInt(getComputedStyle(VE).marginTop)+2-YE.offsetHeight-(YE.offsetHeight>0?parseInt(getComputedStyle(YE).marginTop):0)+"px",Rw.style.marginTop=VE.offsetHeight+parseInt(getComputedStyle(VE).marginTop)+2+"px",DE.style.marginTop="0px",lh.style.marginTop=parseInt(getComputedStyle(VE).marginTop)+2+VE.offsetHeight+"px";mE()};const aI=(e,t)=>{let n="",l="";for(let t=0;t<4-String(e).length;t++)n+="&nbsp;";for(let e=0;e<4-String(t).length;e++)l+="&nbsp;";AE.parentElement.style.width="fit-content",AE.innerHTML=`${l}${t}<span>||</span>${n}${e}=`},oI=(e,t)=>{if(NE.innerText!=e&&(NE.innerText=e),t){const e=qn.startRow,n=qn.endRow,l=qn.startColumn;qn.endColumn;if(NE.innerText==Kl){const i=FE.getBoundingClientRect(),r=1*AB.width(),a=Jn?1*AB.height():Rl,o=AB.rows(),s=Mn?n-e+1:Math.min(n-e+1,o),d=AB.cols(),c=(t.clientX-i.left)%(d*r),u=(t.clientY-i.top)%(s*a),m=(e-1+s-parseInt(u/a)-1)%o+1,h=(l+parseInt(c/r))%d+1;aI(m,h);const p=function(e){const t=FE.getBoundingClientRect(),n=e.clientX-t.left,l=e.clientY-t.top,i=ME.getImageData(n,l,1,1).data;return[i[0],i[1],i[2]]}(t);if(0==p[0]&&0==p[1]&&0==p[2]){let e=KB.cells.find(e=>e.index==h-1);if(e){let t=Lr[e.color_code];RE.style.backgroundColor=t,RE.innerText=e.color_code+" ||"}}else{let e=XB.cells.find(e=>e.index==s-m);if(e){let t=Qm[e.color_code];RE.style.backgroundColor=t,RE.innerText=e.color_code+" ="}}}else if(NE.innerText==Xl){const e=Hu.getBoundingClientRect(),n=FB.cell_size(),i=FB.cols(),r=FB.rows(),a=(t.clientX-e.left)%(i*n),o=t.clientY-e.top,s=r-parseInt(o/n),d=(l+parseInt(a/n))%i+1;aI(s,d)}else if(NE.innerText==Gl){const l=Aw.getBoundingClientRect(),i=1*AB.width(),r=DB.rows(),a=Jn?1*AB.height():Rl,o=Mn?n-e+1:Math.min(n-e+1,r),s=(DB.cols(),t.clientX-l.left),d=(t.clientY-l.top)%(o*a),c=(e-1+o-parseInt(d/a)-1)%r+1,u=parseInt(s/i)+1;aI(c,u)}else if(NE.innerText==Ql){const e=Nr.getBoundingClientRect(),n=Rl,i=KB.size,r=(parseInt((t.clientX-e.left)%(KB.size*n)/n),(t.clientX-e.left)%(i*n)),a=(t.clientY,e.top,(l+parseInt(r/n))%i+1);let o=KB.cells.find(e=>e.index==a-1),s=Lr[o.color_code];RE.style.backgroundColor=s,RE.innerText=o.color_code+" ||",aI(1,a)}else if(NE.innerText==Zl){const e=Um.getBoundingClientRect(),n=Rl,l=XB.size,i=qn.startRow,r=Mn?qn.endRow:Math.min(l,qn.endRow),a=Mn?r-i+1:Math.min(r-i+1,l),o=Jn?1*AB.height():Rl,s=XB.size,d=(t.clientY-e.top)%(s*o),c=(parseInt(d/o),l-1-(a-1-parseInt((t.clientY-e.top)/n)+(i-1))%l);let u=XB.cells.find(e=>e.index==c);if(u){let e=Qm[u.color_code];RE.style.backgroundColor=e,RE.innerText=u.color_code+" ="}aI(l-c,1)}}},sI=e=>{if(nI==yl)return;const t=FE.getBoundingClientRect(),n=1*AB.width(),l=Jn?1*AB.height():Rl,i=qn.startColumn,r=qn.endRow,a=qn.startRow,o=AB.rows(),s=AB.cols(),d=Mn?r-a+1:Math.min(r-a+1,o),c=(e.clientX-t.left)%(s*n),u=(e.clientY-t.top)%(o*l),m=(a-1+d-parseInt(u/l)-1)%o+1,h=(parseInt(c/n)+i)%s;if("radio-weave"==Yn)if(nI==vl){let e=AB.click_modify_draft_peg_plan(m,h,FB,DB,HB);console.log("issss==>",e),e?(Cm(),gE(),Dm()):(Ml(!1),vb("Maximum number of shafts reached"))}else if(nI==bl){let e=AB.click_modify_peg_plan(m,h,FB,DB,HB);console.log("issss==>",e),e&&(gE(),Dm())}else if(nI==wl){if(!ZE){let e=AB.check_if_index_exist_or_not(m,h);ZE=e?Cu:Pu}let e=ZE==Pu;AB.temp_draw_data(m,h,e),(()=>{const e=AB.cols(),t=AB.rows(),n=qn.startColumn,l=qn.endColumn,i=qn.startRow,r=qn.endRow,a=Mn?l-n+1:Math.min(l-n+1,e),o=Mn?r-i+1:Math.min(r-i+1,t),s=AB.get_visible_temp_cells(i,r,n,Mn?l:Math.min(l,e-1),Mn),d=bb(s)?JSON.parse(s):[],c=AB.width(),u=Jn?Number(parseFloat(AB.height()).toFixed(2)):Rl,m=document.createElement("canvas");m.height=u*o,m.width=c*a;const h=m.getContext("2d");if(h.clearRect(0,0,m.width,m.height),h.fillStyle="white",h.fillRect(0,0,m.width,m.height),h.fillStyle="black",Array.isArray(d)&&d.length>0){if("radio-weave"==Yn)d.forEach((e,t)=>{e.forEach(e=>{h.fillRect(t*c,(o-e)*u,c,u)})});else if("radio-color"==Yn)d.forEach((l,r)=>{let a=Array.from({length:o},(e,t)=>t+1),s=KB.cells.find(t=>t.index==(r+n)%e);l.forEach((e,t)=>{s&&(h.fillStyle=Lr[s.color_code],h.fillRect(r*c,(o-e)*u,c,u)),a=a.filter(t=>t!=e)}),a.forEach(e=>{let n=XB.cells.find(n=>{let l=(e+i-1)%t;return n.index==t-(0==l?t:l)});n&&(h.fillStyle=Qm[n.color_code],h.fillRect(r*c,(o-e)*u,c,u))})});else if("radio-interlacement"==Yn){let l=1,r=1;d.forEach((a,s)=>{let d=KB.cells.find(t=>t.index==(s+n)%e),m=Array.from({length:o},(e,t)=>t+1);a.forEach((e,n)=>{let a=XB.cells.find(n=>{let l=(e+i-1)%t;return n.index==t-(0==l?t:l)}),p=s*c,g=(o-e)*u;d&&(h.fillStyle=Lr[d.color_code],h.fillRect(p+l+r,g,c-2*(l+r),u)),a&&(h.fillStyle=Qm[a.color_code],h.fillRect(p,g+l+r,l,u-2*(l+r)),h.fillRect(p+c-l,g+l+r,l,u-2*(l+r)),h.fillStyle="black",h.fillRect(p+l,g,r,u),h.fillRect(p+c-(l+r),g,r,u),h.fillRect(p,g+l,l,r),h.fillRect(p+c-l,g+l,l,r),h.fillRect(p,g+u-(l+r),l,r),h.fillRect(p+c-l,g+u-(l+r),l,r)),m=m.filter(t=>t!=e)}),m.forEach(a=>{let d=XB.cells.find(e=>{let n=(a+i-1)%t;return e.index==t-(0==n?t:n)}),m=KB.cells.find(t=>t.index==(s+n)%e);d&&(h.fillStyle=Qm[d.color_code],h.fillRect(s*c,(o-a)*u+(l+r),c,u-2*(l+r))),m&&(h.fillStyle=Lr[m.color_code],h.fillRect(s*c+l+r,(o-a)*u,c-2*(l+r),l+r),h.fillRect(s*c+l+r,(o-a)*u+u-l,c-2*(l+r),l+r),h.fillStyle="black",h.fillRect(s*c,(o-a)*u+l,c,r),h.fillRect(s*c,(o-a)*u+u-(l+r),c,r),h.fillRect(s*c+l,(o-a)*u,r,l),h.fillRect(s*c+c-(l+r),(o-a)*u,r,l),h.fillRect(s*c+l,(o-a)*u+u-(l+r),r,l+r),h.fillRect(s*c+c-(l+r),(o-a)*u+u-(l+r),r,l+r))})})}if("radio-interlacement"!=Yn)if(Bl==sl){for(let e=0;e<a+1;e++)h.beginPath(),h.strokeStyle="grey",h.moveTo(e*c,0),h.lineTo(e*c,o*u),h.lineWidth=(e+n)%Wn==0?1.5:.5,h.stroke(),h.closePath();for(let e=0;e<o+1;e++)h.beginPath(),h.strokeStyle="grey",h.moveTo(0,e*u),h.lineTo(a*c,e*u),h.lineWidth=(o-e+i-1)%Hn==0?1.5:.5,h.stroke(),h.closePath()}else if(Bl==dl){h.lineWidth=.5;for(let e=0;e<a+1;e++)h.beginPath(),h.strokeStyle="grey",h.moveTo(e*c,0),h.lineTo(e*c,o*u),h.stroke(),h.closePath();for(let e=0;e<o+1;e++)h.beginPath(),h.strokeStyle="grey",h.moveTo(0,e*u),h.lineTo(a*c,e*u),h.stroke(),h.closePath()}else if(Bl==cl){h.lineWidth=1.5;for(let e=0;e<a+1;e++)(e+n)%Wn==0&&(h.beginPath(),h.strokeStyle="grey",h.moveTo(e*c,0),h.lineTo(e*c,o*u),h.stroke(),h.closePath());for(let e=0;e<o+1;e++)(o-e+i-1)%Hn==0&&(h.beginPath(),h.strokeStyle="grey",h.moveTo(0,e*u),h.lineTo(a*c,e*u),h.stroke(),h.closePath())}else{h.lineWidth=1.5;for(let e=0;e<a+1;e+=a)e%Wn==0&&(h.beginPath(),h.strokeStyle="grey",h.moveTo(e*c,0),h.lineTo(e*c,o*u),h.stroke(),h.closePath());for(let e=0;e<o+1;e+=o)e%Hn==0&&(h.beginPath(),h.strokeStyle="grey",h.moveTo(0,e*u),h.lineTo(a*c,e*u),h.stroke(),h.closePath())}h.closePath(),FE.width=m.width,FE.height=m.height,ME.drawImage(m,0,0)}})()}},dI=()=>{const e=AB.cols(),t=AB.rows(),n=qn.startColumn,l=qn.endColumn,i=qn.startRow,r=qn.endRow,a=Mn?l-n+1:Math.min(l-n+1,e),o=Mn?r-i+1:Math.min(r-i+1,t),s=AB.get_visible_cells(i,r,n,Mn?l:Math.min(l,e-1),Mn),d=bb(s)?JSON.parse(s):[],c=AB.width(),u=Jn?Number(parseFloat(AB.height()).toFixed(2)):Rl,m=document.createElement("canvas");m.height=u*o,m.width=c*a;const h=m.getContext("2d");if(h.clearRect(0,0,m.width,m.height),h.fillStyle="white",h.fillRect(0,0,m.width,m.height),h.fillStyle="black",Array.isArray(d)&&d.length>0){if("radio-weave"==Yn)d.forEach((e,t)=>{e.forEach(e=>{h.fillRect(t*c,(o-e)*u,c,u)})});else if("radio-color"==Yn)d.forEach((l,r)=>{let a=Array.from({length:o},(e,t)=>t+1),s=KB.cells.find(t=>t.index==(r+n)%e);l.forEach((e,t)=>{s&&(h.fillStyle=Lr[s.color_code],h.fillRect(r*c,(o-e)*u,c,u)),a=a.filter(t=>t!=e)}),a.forEach(e=>{let n=XB.cells.find(n=>{let l=(e+i-1)%t;return n.index==t-(0==l?t:l)});n&&(h.fillStyle=Qm[n.color_code],h.fillRect(r*c,(o-e)*u,c,u))})});else if("radio-interlacement"==Yn){let l=1,r=1;d.forEach((a,s)=>{let d=KB.cells.find(t=>t.index==(s+n)%e),m=Array.from({length:o},(e,t)=>t+1);a.forEach((e,n)=>{let a=XB.cells.find(n=>{let l=(e+i-1)%t;return n.index==t-(0==l?t:l)}),p=s*c,g=(o-e)*u;d&&(h.fillStyle=Lr[d.color_code],h.fillRect(p+l+r,g,c-2*(l+r),u)),a&&(h.fillStyle=Qm[a.color_code],h.fillRect(p,g+l+r,l,u-2*(l+r)),h.fillRect(p+c-l,g+l+r,l,u-2*(l+r)),h.fillStyle="black",h.fillRect(p+l,g,r,u),h.fillRect(p+c-(l+r),g,r,u),h.fillRect(p,g+l,l,r),h.fillRect(p+c-l,g+l,l,r),h.fillRect(p,g+u-(l+r),l,r),h.fillRect(p+c-l,g+u-(l+r),l,r)),m=m.filter(t=>t!=e)}),m.forEach(a=>{let d=XB.cells.find(e=>{let n=(a+i-1)%t;return e.index==t-(0==n?t:n)}),m=KB.cells.find(t=>t.index==(s+n)%e);d&&(h.fillStyle=Qm[d.color_code],h.fillRect(s*c,(o-a)*u+(l+r),c,u-2*(l+r))),m&&(h.fillStyle=Lr[m.color_code],h.fillRect(s*c+l+r,(o-a)*u,c-2*(l+r),l+r),h.fillRect(s*c+l+r,(o-a)*u+u-l,c-2*(l+r),l+r),h.fillStyle="black",h.fillRect(s*c,(o-a)*u+l,c,r),h.fillRect(s*c,(o-a)*u+u-(l+r),c,r),h.fillRect(s*c+l,(o-a)*u,r,l),h.fillRect(s*c+c-(l+r),(o-a)*u,r,l),h.fillRect(s*c+l,(o-a)*u+u-(l+r),r,l+r),h.fillRect(s*c+c-(l+r),(o-a)*u+u-(l+r),r,l+r))})})}if("radio-interlacement"!=Yn)if(Bl==sl){for(let e=0;e<a+1;e++)h.beginPath(),h.strokeStyle="grey",h.moveTo(e*c,0),h.lineTo(e*c,o*u),h.lineWidth=(e+n)%Wn==0?1.5:.5,h.stroke(),h.closePath();for(let e=0;e<o+1;e++)h.beginPath(),h.strokeStyle="grey",h.moveTo(0,e*u),h.lineTo(a*c,e*u),h.lineWidth=(o-e+i-1)%Hn==0?1.5:.5,h.stroke(),h.closePath()}else if(Bl==dl){h.lineWidth=.5;for(let e=0;e<a+1;e++)h.beginPath(),h.strokeStyle="grey",h.moveTo(e*c,0),h.lineTo(e*c,o*u),h.stroke(),h.closePath();for(let e=0;e<o+1;e++)h.beginPath(),h.strokeStyle="grey",h.moveTo(0,e*u),h.lineTo(a*c,e*u),h.stroke(),h.closePath()}else if(Bl==cl){h.lineWidth=1.5;for(let e=0;e<a+1;e++)(e+n)%Wn==0&&(h.beginPath(),h.strokeStyle="grey",h.moveTo(e*c,0),h.lineTo(e*c,o*u),h.stroke(),h.closePath());for(let e=0;e<o+1;e++)(o-e+i-1)%Hn==0&&(h.beginPath(),h.strokeStyle="grey",h.moveTo(0,e*u),h.lineTo(a*c,e*u),h.stroke(),h.closePath())}else{h.lineWidth=1.5;for(let e=0;e<a+1;e+=a)e%Wn==0&&(h.beginPath(),h.strokeStyle="grey",h.moveTo(e*c,0),h.lineTo(e*c,o*u),h.stroke(),h.closePath());for(let e=0;e<o+1;e+=o)e%Hn==0&&(h.beginPath(),h.strokeStyle="grey",h.moveTo(0,e*u),h.lineTo(a*c,e*u),h.stroke(),h.closePath())}h.closePath(),FE.width=m.width,FE.height=m.height,ME.drawImage(m,0,0)}},cI=e=>{Gb(Ub.NONE),0==e.button&&(Ml(!0),sI(e))},uI=e=>{Ml(!1),ZE=null},mI=e=>{JE.style.display=e?"list-item":"none"},hI=e=>{document.getElementById("mainContextMenu").style.display="none";let t=AB.check_no_of_shaft_needed_for_temp_cells();t>FB.rows()?confirm("Want To InCrease Shafts value to "+t)?(AB.calculate_draft_peg_plan_from_temp_data(FB,DB,HB),Cm(),gE(),Dm(),rI()):dI():(AB.calculate_draft_peg_plan_from_temp_data(FB,DB,HB),Cm(),gE(),Dm(),rI()),console.log("no of shaft needed",t)},pI=e=>{Ll&&nI==wl&&sI(e),oI(Kl,e)},gI=()=>{oI(Jl)},fI=()=>{sy(Kl)},yI=()=>{aI(23,18),FE.addEventListener("mousedown",cI),FE.addEventListener("mouseup",uI),FE.addEventListener("mousemove",pI),FE.addEventListener("mouseleave",gI),zE.addEventListener("scroll",iI),(()=>{const e=document.getElementById("mcInsert-warp-trigger"),t=document.getElementById("mcInsert-weft-trigger"),n=document.getElementById("mcInsert-warp-modal"),l=document.getElementById("mcInsert-weft-modal"),i=(document.querySelectorAll(".close-button"),document.querySelectorAll(".btn-cancel"));fo(e,n,0,i,"Insert Warp"),fo(t,l,0,i,"Insert Weft"),fo(HE,Ka,0,i,"Edit File")})(),JE.addEventListener("click",hI),HE.addEventListener("click",fI)},vI=e=>{if("radio-color"==Yn)return void wI();if("radio-interlacement"==Yn)return void EI();if(!Mn)return void(e=>{AB.cols();const t=AB.rows(),n=1*AB.width(),l=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl,i=On,r=Dn;if(Array.isArray(e))for(let a=0;a<e.length;a++){ME.clearRect(e[a]*n,0,n,FE.height),ME.fillStyle="white",ME.fillRect(e[a]*n,0,n,FE.height);const o=new Uint32Array(aL.memory.buffer,AB.get_col_new_cell(e[a]),AB.get_col_new_cell_length(e[a]));ME.fillStyle="black",o.forEach(i=>{ME.fillRect(e[a]*n,(t-i)*l,n,l)});for(let o=0;o<t+1;o++)ME.beginPath(),ME.strokeStyle="grey",ME.moveTo(i+e[a]*n,r+o*l),ME.lineTo(i+e[a]*n+n,r+o*l),ME.lineWidth=(t-o)%Hn==0?1.5:.5,ME.stroke(),ME.closePath();for(let o=0;o<2;o++)ME.beginPath(),ME.strokeStyle="grey",ME.moveTo(i+e[a]*n+o*n,r),ME.lineTo(i+e[a]*n+o*n,r+t*l),ME.lineWidth=(e[a]+o)%Wn==0?1.5:.5,ME.stroke(),ME.closePath()}UE.style.width=FE.width+"px",KE.style.height=FE.height+"px"})(e);const t=AB.cols(),n=AB.rows(),l=1*AB.width(),i=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl,r=On,a=Dn,o=document.createElement("canvas"),s=o.getContext("2d");o.width=Math.ceil(t*l),o.height=Math.ceil(n*i);const d=ME.getImageData(0,FE.height-o.height,o.width,o.height);if(s.putImageData(d,0,0),Array.isArray(e))for(let t=0;t<e.length;t++){s.clearRect(e[t]*l,0,l,o.height),s.fillStyle="white",s.fillRect(e[t]*l,0,l,o.height);for(let o=0;o<n+1;o++)s.beginPath(),s.strokeStyle="grey",s.moveTo(r+e[t]*l,a+o*i),s.lineTo(r+e[t]*l+l,a+o*i),s.lineWidth=(n-o)%Hn==0?1.5:.5,s.stroke(),s.closePath();for(let o=0;o<2;o++)s.beginPath(),s.strokeStyle="grey",s.moveTo(r+e[t]*l+o*l,a),s.lineTo(r+e[t]*l+o*l,a+n*i),s.lineWidth=(e[t]+o)%Wn==0?1.5:.5,s.stroke(),s.closePath();const d=new Uint32Array(aL.memory.buffer,AB.get_col_new_cell(e[t]),AB.get_col_new_cell_length(e[t]));s.fillStyle="black",d.forEach(r=>{s.fillRect(e[t]*l,(n-r)*i,l,i)})}if(Mn){FE.width=o.width*zn,FE.height=o.height*Un;const e=ME.createPattern(o,"repeat");ME.rect(0,0,FE.width,FE.height),ME.fillStyle=e,ME.fill()}else FE.width=o.width,FE.height=o.height,ME.drawImage(o,0,0);UE.style.width=FE.width+"px",KE.style.height=FE.height+"px"},bI=()=>{if("radio-color"==Yn)return void wI();if("radio-interlacement"==Yn)return void EI();const e=AB.cols(),t=AB.rows(),n=1*AB.width(),l=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl,i=On,r=Dn,a=document.createElement("canvas");if(a.width=Math.ceil(e*n),a.height=Math.ceil(t*l),0==a.height||0==a.width)return;const o=a.getContext("2d");if(o.clearRect(0,0,a.width,a.height),o.fillStyle="white",o.fillRect(0,0,a.width,a.height),o.fillStyle="black",ME.clearRect(0,0,FE.width,FE.height),Bl==sl){for(let a=0;a<e+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.lineWidth=a%Wn==0?1.5:.5,o.stroke(),o.closePath();for(let a=0;a<t+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.lineWidth=(t-a)%Hn==0?1.5:.5,o.stroke(),o.closePath()}else if(Bl==dl){o.lineWidth=.5;for(let a=0;a<e+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.stroke(),o.closePath();for(let a=0;a<t+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.stroke(),o.closePath()}else if(Bl==cl){o.lineWidth=1.5;for(let a=0;a<e+1;a++)a%Wn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.stroke(),o.closePath());for(let a=0;a<t+1;a++)(t-a)%Hn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.stroke(),o.closePath())}else{o.lineWidth=1.5;for(let a=0;a<e+1;a+=e)a%Wn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(i+a*n,r),o.lineTo(i+a*n,r+t*l),o.stroke(),o.closePath());for(let a=0;a<t+1;a+=t)a%Hn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(i,r+a*l),o.lineTo(i+e*n,r+a*l),o.stroke(),o.closePath())}for(let i=0;i<e;i++){new Uint32Array(aL.memory.buffer,AB.get_col_new_cell(i),AB.get_col_new_cell_length(i)).forEach(e=>{o.fillRect(i*n,(t-e)*l,n,l)})}if(o.closePath(),Mn){FE.width=a.width*zn,FE.height=a.height*Un;const e=ME.createPattern(a,"repeat");ME.rect(0,0,FE.width,FE.height),ME.fillStyle=e,ME.fill()}else FE.width=a.width,FE.height=a.height,ME.drawImage(a,0,0);UE.style.width=FE.width+"px",KE.style.height=FE.height+"px"},wI=()=>{const e=AB.cols(),t=AB.rows(),n=1*AB.width(),l=On,i=Dn,r=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl,a=document.createElement("canvas"),o=a.getContext("2d");a.width=Math.ceil(e*n),a.height=Math.ceil(t*r),o.clearRect(0,0,a.width,a.height),o.fillStyle="white",o.fillRect(0,0,a.width,a.height),o.fillStyle="black";let s=[];for(let n=0;n<e*t;n++)s.push(n);new Uint32Array(aL.memory.buffer,AB.cells(),AB.selected_maingrid_length()),YB.cells,JB.cells;for(let l=0;l<e;l++){let e=new Uint32Array(aL.memory.buffer,AB.get_col_new_cell(l),AB.get_col_new_cell_length(l)),i=Array.from({length:t},(e,t)=>t+1);e.forEach(e=>{let a=KB.cells.find(e=>e.index==l);a&&(o.fillStyle=Lr[a.color_code],o.fillRect(l*n,(t-e)*r,n,r)),i=i.filter(t=>t!=e)}),i.forEach(e=>{let i=XB.cells.find(n=>n.index==t-e);i&&(o.fillStyle=Qm[i.color_code],o.fillRect(l*n,(t-e)*r,n,r))})}if(Bl==sl){for(let a=0;a<e+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(l+a*n,i),o.lineTo(l+a*n,i+t*r),o.lineWidth=a%Wn==0?1.5:.5,o.stroke(),o.closePath();for(let a=0;a<t+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(l,i+a*r),o.lineTo(l+e*n,i+a*r),o.lineWidth=(t-a)%Hn==0?1.5:.5,o.stroke(),o.closePath()}else if(Bl==dl){o.lineWidth=.5;for(let a=0;a<e+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(l+a*n,i),o.lineTo(l+a*n,i+t*r),o.stroke(),o.closePath();for(let a=0;a<t+1;a++)o.beginPath(),o.strokeStyle="grey",o.moveTo(l,i+a*r),o.lineTo(l+e*n,i+a*r),o.stroke(),o.closePath()}else if(Bl==cl){o.lineWidth=1.5;for(let a=0;a<e+1;a++)a%Wn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(l+a*n,i),o.lineTo(l+a*n,i+t*r),o.stroke(),o.closePath());for(let a=0;a<t+1;a++)a%Hn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(l,i+a*r),o.lineTo(l+e*n,i+a*r),o.stroke(),o.closePath())}else{o.lineWidth=1.5;for(let a=0;a<e+1;a+=e)a%Wn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(l+a*n,i),o.lineTo(l+a*n,i+t*r),o.stroke(),o.closePath());for(let a=0;a<t+1;a+=t)(t-a)%Hn==0&&(o.beginPath(),o.strokeStyle="grey",o.moveTo(l,i+a*r),o.lineTo(l+e*n,i+a*r),o.stroke(),o.closePath())}if(Mn){FE.width=a.width*zn,FE.height=a.height*Un;const e=ME.createPattern(a,"repeat");ME.rect(0,0,FE.width,FE.height),ME.fillStyle=e,ME.fill()}else FE.width=a.width,FE.height=a.height,ME.drawImage(a,0,0);UE.style.width=FE.width+"px",KE.style.height=FE.height+"px"},EI=()=>{const e=AB.cols(),t=AB.rows(),n=1*AB.width(),l=Jn?Number(parseFloat(1*AB.height()).toFixed(2)):Rl,i=document.createElement("canvas"),r=i.getContext("2d");i.width=Math.ceil(e*n),i.height=Math.ceil(t*l),r.clearRect(0,0,i.width,i.height),r.fillStyle="white",r.fillRect(0,0,i.width,i.height),r.fillStyle="black";for(let i=0;i<e;i++){let e=new Uint32Array(aL.memory.buffer,AB.get_col_new_cell(i),AB.get_col_new_cell_length(i)),a=Array.from({length:t},(e,t)=>t+1);e.forEach(e=>{let o=KB.cells.find(e=>e.index==i),s=XB.cells.find(n=>n.index==t-e);o&&(r.fillStyle=Lr[o.color_code],r.fillRect(i*n+1+1,(t-e)*l,n-4,l)),s&&(r.fillStyle=Qm[s.color_code],r.fillRect(i*n,(t-e)*l+1+1,1,l-4),r.fillRect(i*n+n-1,(t-e)*l+1+1,1,l-4),r.fillStyle="black",r.fillRect(i*n+1,(t-e)*l,1,l),r.fillRect(i*n+n-2,(t-e)*l,1,l),r.fillRect(i*n,(t-e)*l+1,1,1),r.fillRect(i*n+n-1,(t-e)*l+1,1,1),r.fillRect(i*n,(t-e)*l+l-2,1,1),r.fillRect(i*n+n-1,(t-e)*l+l-2,1,1)),a=a.filter(t=>t!=e)}),a.forEach(e=>{let a=XB.cells.find(n=>n.index==t-e),o=KB.cells.find(e=>e.index==i%KB.size);a&&(r.fillStyle=Qm[a.color_code],r.fillRect(i*n,(t-e)*l+2,n,l-4)),o&&(r.fillStyle=Lr[o.color_code],r.fillRect(i*n+1+1,(t-e)*l,n-4,2),r.fillRect(i*n+1+1,(t-e)*l+l-1,n-4,2),r.fillStyle="black",r.fillRect(i*n,(t-e)*l+1,n,1),r.fillRect(i*n,(t-e)*l+l-2,n,1),r.fillRect(i*n+1,(t-e)*l,1,1),r.fillRect(i*n+n-2,(t-e)*l,1,1),r.fillRect(i*n+1,(t-e)*l+l-2,1,2),r.fillRect(i*n+n-2,(t-e)*l+l-2,1,2))})}if(Mn){FE.width=i.width*zn,FE.height=i.height*Un;const e=ME.createPattern(i,"repeat");ME.rect(0,0,FE.width,FE.height),ME.fillStyle=e,ME.fill()}else FE.width=i.width,FE.height=i.height,ME.drawImage(i,0,0);UE.style.width=FE.width+"px",KE.style.height=FE.height+"px"};document.getElementById("sideBar");document.querySelector(".close-drawer"),document.querySelector(".overlay");document.getElementById("pencil"),document.getElementById("expend"),document.getElementById("square"),document.getElementById("can"),document.getElementById("insert"),document.getElementById("fx"),document.getElementsByClassName("toggle-content"),document.getElementsByClassName("fa-xmark"),document.getElementsByClassName(".menu-panel");const II=document.getElementById("keyboard-shortcut-model"),SI=document.getElementById("keyboard-shortcut-trigger"),kI=()=>{nv(),II.style.display="block",II.style.animation="slide-down 0.3s ease"},xI=()=>{II.style.display="none"},TI=()=>{console.log("getKeyboardShortcutModelString string is"),II.innerHTML=`<div class="modal-content">\n    <div class="close">\n      <span class="close-button">&times;</span>\n    </div>\n    <div class="modal-title">\n    Keyboard Shortcut\n    </div>\n    <div class="modal-desc">\n    <table>\n    <tr><td>Command</td><td>KeyStroke</td><td>Description</td></tr>\n    ${Ny.map(e=>`<tr><td class="shortCutTablePartHeading">${e.part}</td></tr>${e.keyData.map(e=>`<tr><td>${e.command}</td><td>${e.keyName}</td><td>${e.Description}</td></tr>`).join("")}`).join("")}\n      </table>\n    </div>\n  </div>`;II.querySelector(".close-button").addEventListener("click",xI),SI.addEventListener("click",kI)};document.getElementById("edit-draft-num-grid-model"),document.getElementById("edit-draft-num-grid-model-trigger");const _I=document.getElementById("fabric-calculation"),BI=document.getElementById("fabric-calculation-model");let LI=0;const PI=document.getElementById("yarn-cost-per-m"),CI=document.getElementById("sizing-rate"),NI=document.getElementById("sizing-cost-per-m"),RI=document.getElementById("wastage-rate"),AI=document.getElementById("wastage-cost-per-m"),FI=document.getElementById("freight-cost-per-m"),MI=document.getElementById("weaving-rate"),OI=document.getElementById("weaving-cost-per-m"),DI=document.getElementById("gray-cost-per-m"),WI=document.getElementById("processing-cost-per-m"),HI=document.getElementById("shrinckage-rate"),$I=document.getElementById("shrinckage-cost-per-m"),qI=document.getElementById("value-loss-rate"),jI=document.getElementById("value-loss-cost-per-m"),VI=document.getElementById("duty-rate"),zI=document.getElementById("duty-cost-per-m"),UI=document.getElementById("first-extra-rate"),YI=document.getElementById("first-extra-cost-per-m"),JI=document.getElementById("finish-cost-per-m"),GI=document.getElementById("profit-rate"),XI=document.getElementById("profit-cost-per-m"),KI=document.getElementById("second-extra-rate"),ZI=document.getElementById("second-extra-cost-per-m"),QI=document.getElementById("selling-cost-per-m"),eS=BI.querySelector("#model-apply"),tS=BI.querySelector("#model-ok"),nS=()=>{console.log("applaedf")},lS=()=>{nS(),rS()},iS=()=>{LI=Number(Ff.value),document.getElementById("ppi-text-element").innerText="PPI = "+LI,nv(),LI>0&&(BI.style.display="block",BI.style.animation="slide-down 0.3s ease")},rS=()=>{BI.style.display="none"},aS=e=>{LI=Number(Ff.value);e.target.value;"yarn-cost-per-m"==e.target.id?(NI.value=parseFloat(Number(CI.value)*Number(PI.value)/100).toFixed(2),AI.value=parseFloat(Number(RI.value)*Number(PI.value)/100).toFixed(2)):"sizing-rate"==e.target.id?NI.value=parseFloat(Number(PI.value)*Number(CI.value)/100).toFixed(2):"sizing-cost-per-m"==e.target.id?CI.value=parseFloat(100*Number(NI.value)/Number(PI.value)).toFixed(2):"wastage-rate"==e.target.id?AI.value=parseFloat(Number(PI.value)*Number(RI.value)/100).toFixed(2):"wastage-cost-per-m"==e.target.id?RI.value=parseFloat(100*Number(AI.value)/Number(PI.value)).toFixed(2):"freight-cost-per-m"==e.target.id?DI.value=Number(PI.value)+Number(NI.value)+Number(AI.value)+Number(OI.value)+Number(FI.value):"weaving-rate"==e.target.id?OI.value=parseFloat(LI*Number(MI.value)).toFixed(2):"weaving-cost-per-m"==e.target.id?MI.value=parseFloat(Number(OI.value)/LI).toFixed(2):"shrinckage-rate"==e.target.id?$I.value=parseFloat(Number(HI.value)*Number(DI.value)/100).toFixed(2):"shrinckage-cost-per-m"==e.target.id?HI.value=parseFloat(100*Number($I.value)/Number(DI.value)).toFixed(2):"value-loss-rate"==e.target.id?jI.value=parseFloat(Number(qI.value)*Number(DI.value)/100).toFixed(2):"value-loss-cost-per-m"==e.target.id?qI.value=parseFloat(100*Number(jI.value)/Number(DI.value)).toFixed(2):"duty-rate"==e.target.id?zI.value=parseFloat(Number(VI.value)*Number(DI.value)/100).toFixed(2):"duty-cost-per-m"==e.target.id?VI.value=parseFloat(100*Number(zI.value)/Number(DI.value)).toFixed(2):"first-extra-rate"==e.target.id?YI.value=parseFloat(Number(UI.value)*Number(DI.value)/100).toFixed(2):"first-extra-cost-per-m"==e.target.id?UI.value=parseFloat(100*Number(YI.value)/Number(DI.value)).toFixed(2):"profit-rate"==e.target.id?XI.value=parseFloat(Number(GI.value)*Number(JI.value)/100).toFixed(2):"profit-cost-per-m"==e.target.id?GI.value=parseFloat(100*Number(XI.value)/Number(JI.value)).toFixed(2):"second-extra-rate"==e.target.id?ZI.value=parseFloat(Number(KI.value)*Number(JI.value)/100).toFixed(2):"second-extra-cost-per-m"==e.target.id&&(KI.value=parseFloat(100*Number(ZI.value)/Number(JI.value)).toFixed(2)),DI.value=Number(PI.value)+Number(NI.value)+Number(AI.value)+Number(FI.value)+Number(OI.value),JI.value=Number(DI.value)+Number(WI.value)+Number($I.value)+Number(jI.value)+Number(zI.value)+Number(YI.value),QI.value=Number(JI.value)+Number(XI.value)+Number(ZI.value)},oS=document.getElementById("cbdesigner-name"),sS=document.querySelector(".designer-name"),dS=document.getElementById("cbparty-name"),cS=document.querySelector(".party-name"),uS=document.getElementById("cborder-no"),mS=document.querySelector(".order-no"),hS=document.getElementById("cbdate"),pS=document.querySelector(".date"),gS=document.getElementById("cbdesign-name"),fS=document.querySelector(".design-name"),yS=document.getElementById("cbtotal-dent"),vS=document.querySelector(".total-dent"),bS=document.getElementById("cbweave-name"),wS=document.querySelector(".weave-name"),ES=document.getElementById("cbdraft-pattern"),IS=document.querySelector(".draft-pattern"),SS=document.getElementById("cbavg-EPI"),kS=document.querySelector(".avg-EPI"),xS=document.getElementById("cbavg-PPI"),TS=document.querySelector(".avg-PPI"),_S=document.getElementById("cbgsm"),BS=document.querySelector(".gsm"),LS=document.getElementById("cbreed"),PS=document.querySelector(".reed"),CS=document.getElementById("cbreed-space"),NS=document.querySelector(".reed-space"),RS=document.getElementById("cbshaft"),AS=document.querySelector(".shaft"),FS=document.getElementById("cbtotal-ends"),MS=document.querySelector(".total-ends"),OS=document.getElementById("cbtotal-picks"),DS=document.querySelector(".total-picks"),WS=document.getElementById("cbepi"),HS=document.querySelector(".epi"),$S=document.getElementById("cbppi"),qS=document.querySelector(".ppi"),jS=document.getElementById("cbno-of-warp"),VS=document.querySelector(".no-of-warp"),zS=document.getElementById("cbno-of-weft"),US=document.querySelector(".no-of-weft"),YS=document.getElementById("cbglm"),JS=document.querySelector(".glm"),GS=document.getElementById("cbblend"),XS=document.querySelector(".blend"),KS=document.getElementById("save-color-palette-modal"),ZS=document.getElementsByClassName("save-color-palette-trigger");let QS,ek,tk,nk="";const lk=()=>{nv(),ok(),KS.style.display="block",KS.style.animation="slide-down 0.3s ease"},ik=()=>{tk.innerHTML="",KS.style.display="none",Ol("")},rk=()=>{(async()=>{let e=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id,t=Os.find(e=>e.name.trim()==QS.value.trim());nk=t?t.id:"",console.log("warp color ",Lr),console.log("weft color",Qm),console.log("function color",eh),console.log("warp info object is",Pr),console.log("weft info object ios",th);let n=[];Object.keys(Lr).forEach(e=>{n.push({yarnType:Pr[e]?Pr[e].yarnType:"",yarnName:Pr[e]?Pr[e].yarnName:"",yarnLetter:e,yarnWarpOrWeft:"warp",colorCode:Lr[e]})}),Object.keys(Qm).forEach(e=>{n.push({yarnType:th[e]?th[e].yarnType:"",yarnName:th[e]?th[e].yarnName:"",yarnLetter:e,yarnWarpOrWeft:"weft",colorCode:Qm[e]})}),Object.keys(eh).forEach(e=>{n.push({yarnType:"",yarnName:"",yarnLetter:e,yarnWarpOrWeft:"function",colorCode:eh[e]})});let l={colorPaletteId:nk,user:e,name:QS.value,yarnDetail:n};try{await Bs(l)}catch(e){console.log("inside error")}})(),ik()},ak=e=>{console.log("value of e is",e.target.value);let t=String(e.target.value);if(t.length>0){let e=Os.filter(e=>String(e.name).toLowerCase().includes(t.toLowerCase()));for(let e=0;e<Os.length;e++){document.getElementById(Os[e].id).style.display="none"}for(let t=0;t<e.length;t++){document.getElementById(e[t].id).style.display="block"}}else for(let e=0;e<Os.length;e++){document.getElementById(Os[e].id).style.display="block"}},ok=async()=>{try{let t=await Ls();e=t.data.DATA,Os=e,tk.innerHTML="";for(let e=0;e<Os.length;e++)tk.innerHTML+=`<div id="${Os[e].id}">${Os[e].name}</div>`;for(let e=0;e<Os.length;e++)document.getElementById(Os[e].id).addEventListener("click",()=>{var t;t=Os[e],QS.value=t.name})}catch(e){console.log("err is",e)}var e};const sk=document.getElementById("save-draft-modal"),dk=document.getElementById("save-draft-modal-trigger");let ck,uk,mk,hk="",pk=[];const gk=e=>{for(let e=0;e<pk.length;e++){document.getElementById(pk[e].id).classList.remove("save-draft-file-active")}e.currentTarget.classList.add("save-draft-file-active")},fk=e=>{pk=e},yk=()=>{document.getElementById("weftSubContext")&&(document.getElementById("weftSubContext").style.display="none"),(async()=>{try{let e=await Ss();fk(e.data.DATA),mk.innerHTML="";for(let e=0;e<pk.length;e++)mk.innerHTML+=`<div class="open-pegplan-data-container-content" id="${pk[e].id}">\n      <div class="open-pegplan-data-content-image">\n        <img src="maxweavefev.png" width="100">\n       </div>\n    \n        <div class="open-pegplan-data-content-file-name">${pk[e].name}</div>\n    </div>`;for(let e=0;e<pk.length;e++){document.getElementById(pk[e].id).addEventListener("click",gk)}for(let e=0;e<pk.length;e++)document.getElementById(pk[e].id).addEventListener("click",()=>{var t;t=pk[e],ck.value=t.name})}catch(e){console.log("err is",e)}})(),sk.style.display="block",sk.style.animation="slide-down 0.3s ease"},vk=()=>{sk.style.display="none",Ol("")},bk=e=>{let t=String(e.target.value);if(t.length>0){let e=pk.filter(e=>String(e.name).toLowerCase().includes(t.toLowerCase()));for(let e=0;e<pk.length;e++){document.getElementById(pk[e].id).style.display="none"}for(let t=0;t<e.length;t++){document.getElementById(e[t].id).style.display="block"}}else for(let e=0;e<pk.length;e++){document.getElementById(pk[e].id).style.display="block"}},wk=async()=>{let e=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id,t=FB.convert_new_index_to_numeric(WB),n=pk.find(e=>e.name.trim()==ck.value.trim());hk=n?n.id:"";let l=mb(t);const i=Pv(String(l).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e)));let r={draftPlan:t,user:e,name:ck.value,shaft:FB.rows(),draftPlanId:hk,ends:i.toString()};try{await(e=>{const t=localStorage.getItem("token");return Es.post(Is+"/draft-plan/create",e,{headers:{token:t}})})(r)}catch(e){console.log("inside error",e)}},Ek=()=>{wk(),vk()};const Ik=document.getElementById("save-pegplan-modal"),Sk=document.getElementById("save-pegplan-modal-trigger");let kk,xk,Tk,_k="",Bk=[];const Lk=e=>{for(let e=0;e<Bk.length;e++){document.getElementById(Bk[e].id).classList.remove("save-peg-plan-file-active")}e.currentTarget.classList.add("save-peg-plan-file-active")},Pk=e=>{Bk=e},Ck=()=>{(async()=>{document.getElementById("warpCanvasMenu")&&(document.getElementById("warpCanvasMenu").style.display="none");try{let e=await _s();Pk(e.data.DATA),Tk.innerHTML="";for(let e=0;e<Bk.length;e++)Tk.innerHTML+=`<div class="open-pegplan-data-container-content" id="${Bk[e].id}">\n      <div class="open-pegplan-data-content-image">\n        <img src="maxweavefev.png" width="100">\n       </div>\n        <div class="open-pegplan-data-content-file-name">${Bk[e].name}</div>\n      </div>`;for(let e=0;e<Bk.length;e++){document.getElementById(Bk[e].id).addEventListener("click",Lk)}for(let e=0;e<Bk.length;e++)document.getElementById(Bk[e].id).addEventListener("click",()=>{var t;t=Bk[e],kk.value=t.name})}catch(e){console.log("err is",e)}})(),Ik.style.display="block",Ik.style.animation="slide-down 0.3s ease"},Nk=()=>{Ik.style.display="none",Ol("")},Rk=e=>{let t=String(e.target.value);if(t.length>0){let e=Bk.filter(e=>String(e.name).toLowerCase().includes(t.toLowerCase()));for(let e=0;e<Bk.length;e++){document.getElementById(Bk[e].id).style.display="none"}for(let t=0;t<e.length;t++){document.getElementById(e[t].id).style.display="block"}}else for(let e=0;e<Bk.length;e++){document.getElementById(Bk[e].id).style.display="block"}},Ak=async()=>{let e=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id,t=DB.convert_new_index_to_numeric(),n=Bk.find(e=>e.name.trim()==kk.value.trim());_k=n?n.id:"";let l=mb(t,!0);const i=String(l).split("\n").filter(e=>e.length>0).length;let r={pegPlan:t,user:e,name:kk.value,shaft:FB.rows(),pegPlanId:_k,picks:i.toString()};try{await(e=>{const t=localStorage.getItem("token");return Es.post(configObject.APP_API+"/peg-plan/create",e,{headers:{token:t}})})(r)}catch(e){console.log("inside error",e)}},Fk=()=>{Ak(),Nk()},Mk=()=>{const e=localStorage.getItem("token");let t=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id;return Es.get(`${configObject.APP_API}/main-design/get-weave-design/${t}`,{headers:{token:e}})};const Ok=document.getElementById("save-weavedesign-modal"),Dk=document.getElementById("save-weavedesign-modal-trigger");let Wk,Hk,$k,qk="",jk=[];const Vk=e=>{for(let e=0;e<jk.length;e++){document.getElementById(jk[e].id).classList.remove("save-weave-design-file-active")}e.currentTarget.classList.add("save-weave-design-file-active")},zk=e=>{jk=e},Uk=()=>{nv(),(async()=>{try{let e=await Mk();zk(e.data.DATA),$k.innerHTML="";for(let e=0;e<jk.length;e++)$k.innerHTML+=`<div class="open-pegplan-data-container-content" id="${jk[e].id}">\n      <div class="open-pegplan-data-content-image">\n        <img src="maxweavefev.png" width="100">\n       </div>\n        <div class="open-pegplan-data-content-file-name">${jk[e].name}</div>\n      </div>`;for(let e=0;e<jk.length;e++){document.getElementById(jk[e].id).addEventListener("click",Vk)}for(let e=0;e<jk.length;e++)document.getElementById(jk[e].id).addEventListener("click",()=>{var t;t=jk[e],Wk.value=t.name})}catch(e){console.log("err is",e)}})(),Ok.style.display="block",Ok.style.animation="slide-down 0.3s ease"},Yk=()=>{Ok.style.display="none",Ol("")},Jk=e=>{let t=String(e.target.value);if(t.length>0){let e=jk.filter(e=>String(e.name).toLowerCase().includes(t.toLowerCase()));for(let e=0;e<jk.length;e++){document.getElementById(jk[e].id).style.display="none"}for(let t=0;t<e.length;t++){document.getElementById(e[t].id).style.display="block"}}else for(let e=0;e<jk.length;e++){document.getElementById(jk[e].id).style.display="block"}},Gk=async()=>{let e=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id,t=jk.find(e=>e.name.trim()==Wk.value.trim());qk=t?t.id:"";let n=FB.convert_new_index_to_numeric(WB),l=mb(n);const i=Pv(String(l).split("\n").filter(e=>e.length>0).map(e=>e.split(" ").filter(e=>e)));let r=DB.convert_new_index_to_numeric(),a=mb(r,!0);const o=String(a).split("\n").filter(e=>e.length>0).length;let s=await(async()=>{let e=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id,t=[];Object.keys(Lr).forEach(e=>{t.push({yarnType:Pr[e]?Pr[e].yarnType:"",yarnName:Pr[e]?Pr[e].yarnName:"",yarnLetter:e,yarnWarpOrWeft:"warp",colorCode:Lr[e]})}),Object.keys(Qm).forEach(e=>{t.push({yarnType:th[e]?th[e].yarnType:"",yarnName:th[e]?th[e].yarnName:"",yarnLetter:e,yarnWarpOrWeft:"weft",colorCode:Qm[e]})}),Object.keys(eh).forEach(e=>{t.push({yarnType:"",yarnName:"",yarnLetter:e,yarnWarpOrWeft:"function",colorCode:eh[e]})});let n={colorPaletteId:"",user:e,name:Wk.value+"-color-palette",yarnDetail:t,isFileConnected:!0};try{return(await Bs(n)).data.DATA.id}catch(e){console.log("inside error")}})(),d={pegPlan:r,draftPlan:n,warpPattern:"",weftPattern:"",user:e,name:Wk.value,shaft:FB.rows().toString(),isOnlyWeave:!0,mainDesignId:qk,picks:o.toString(),ends:i.toString(),fabricType:"",unit:"",quality:"",reed:"",perinch:"",leftSalvageWidth:"",bodyWidth:"",rightSalvageWidth:"",leftSalvageWarpDent:"",bodyWarpDent:"",rightSalvageWarpDent:"",warpDencity:"",weftDencity:"",designHeight:"",designWidth:"",gridHeight:"",gridWidth:"",weftHeight:"",warpWidth:"",skipDent:"",doubleBeam:"",extraWarp:"",creaming:"",density:"",leftSalvage:"",rightSalvage:"",notes:"",colorPaletteId:s};try{await ks(d)}catch(e){console.log("inside error",e)}},Xk=()=>{Gk(),Yk()},Kk=document.getElementById("open-weavedesign-modal"),Zk=document.getElementById("open-weavedesign-modal-trigger");let Qk,ex,tx,nx,lx,ix,rx,ax;const ox=e=>{for(let e=0;e<jk.length;e++){document.getElementById(jk[e].id).classList.remove("weave-file-active")}e.currentTarget.classList.add("weave-file-active");let t=jk.find(t=>t.id==e.currentTarget.id);rx=t,sx(rx)},sx=e=>{e.colorPaletteId&&Ds(e.colorPaletteId),rx=e,ix.innerHTML="",ax.value=e.name},dx=async()=>{try{let e=await Mk();zk(e.data.DATA);let t=[],n=[],l=[];t=[...new Set([...jk.map(e=>e.shaft)])],n=[...new Set([...jk.map(e=>e.picks)])],l=[...new Set([...jk.map(e=>e.ends)])],ex.innerHTML='<option value="">All</option>',nx.innerHTML='<option value="">All</option>',tx.innerHTML='<option value="">All</option>';for(let e=0;e<t.length;e++){let n=document.createElement("option");n.value=t[e],n.innerHTML=t[e],nx.appendChild(n)}for(let e=0;e<n.length;e++){let t=document.createElement("option");t.value=n[e],t.innerHTML=n[e],ex.appendChild(t)}for(let e=0;e<l.length;e++){let t=document.createElement("option");t.value=l[e],t.innerHTML=l[e],tx.appendChild(t)}lx.innerHTML="";for(let e=0;e<jk.length;e++)lx.innerHTML+=`<div id="${jk[e].id}" class="open-pegplan-data-container-content">\n      <div class="open-pegplan-data-content-image">\n        <img src="maxweave.png" width="100">\n      </div>\n      <div class="open-pegplan-data-content-file-name">${jk[e].name}</div>\n    </div>`;for(let e=0;e<jk.length;e++){document.getElementById(jk[e].id).addEventListener("click",ox)}}catch(e){console.log("err is",e)}},cx=()=>{document.getElementById("mainContextMenu")&&(document.getElementById("mainContextMenu").style.display="none"),document.addEventListener("keydown",hx),nv(),dx(),Kk.style.display="block",Kk.style.animation="slide-down 0.3s ease"},ux=()=>{lx.innerHTML="",Kk.style.display="none",rx=null,document.removeEventListener("keydown",hx),Ol("")},mx=()=>{Ph.value=rx.draftPlan,Fh(),ra.value=rx.pegPlan,ca(),ux()},hx=async e=>{rx&&"Delete"==e.key&&(await kd("Are you sure you want to permanently delete this file?")?(console.log("delete design",rx),xs(rx.id).then(e=>{console.log("delete design succuss fully",e.data),dx(),ax.value="",rx=null}).catch(e=>{console.log("err",e),console.log("delete design failed")})):console.log("do not delete it"))},px=e=>{let t=String(Qk.value),n=String(ex.value),l=String(nx.value),i=String(tx.value),r=jk.filter(e=>(0==t.length||String(e.name).toLowerCase().includes(t.toLowerCase()))&&(0==l.length||String(e.shaft).toLowerCase().includes(l.toLowerCase()))&&(0==n.length||String(e.picks).toLowerCase().includes(n.toLowerCase()))&&(0==i.length||String(e.ends).toLowerCase().includes(i.toLowerCase())));for(let e=0;e<jk.length;e++){document.getElementById(jk[e].id).style.display="none"}for(let e=0;e<r.length;e++){document.getElementById(r[e].id).style.display="block"}},gx=document.getElementById("open-draft-modal"),fx=document.getElementById("open-draft-modal-trigger");let yx,vx,bx,wx,Ex,Ix,Sx;const kx=e=>{for(let e=0;e<pk.length;e++){document.getElementById(pk[e].id).classList.remove("draft-file-active")}let t=pk.find(t=>t.id==e.currentTarget.id);e.currentTarget.classList.add("draft-file-active"),Ix=t,xx(Ix)},xx=e=>{Ex.innerHTML="",Sx.value=e.name;let t=mb(e.draftPlan),n=[];String(t).split("\n").filter(e=>e.length>0).forEach(e=>{if(e){e.trim().split(" ").forEach(e=>{n.push(e.trim())})}}),MB.change_only_draft_data(n);const l=document.createElement("canvas"),i=l.getContext("2d"),r=MB.cols(),a=MB.rows(),o=MB.cell_size(),s=On,d=Dn;l.width=r*o,l.height=a*o,i.fillStyle="white",i.fillRect(0,0,l.width,l.height),i.fillStyle="black";for(let e=0;e<r+1;e++)i.beginPath(),i.strokeStyle="grey",i.moveTo(s+e*o,d),i.lineTo(s+e*o,d+a*o),i.lineWidth=e%Wn==0?1.5:.5,i.stroke(),i.closePath();for(let e=0;e<a+1;e++)i.beginPath(),i.strokeStyle="grey",i.moveTo(s,d+e*o),i.lineTo(s+r*o,d+e*o),i.lineWidth=(a-e)%Hn==0?1.5:.5,i.stroke(),i.closePath();const c=new Uint32Array(aL.memory.buffer,MB.cells(),MB.selected_weftgrid_length());console.log("weftCells",c),i.beginPath(),c.forEach(e=>{i.fillRect(e%MB.cols()*o,parseInt(e/MB.cols())*o,o,o)}),i.closePath(),Ex.appendChild(l)},Tx=async()=>{try{let e=await Ss();fk(e.data.DATA);let t=[],n=[];t=[...new Set([...pk.map(e=>e.shaft)])],n=[...new Set([...pk.map(e=>e.ends)])],vx.innerHTML='<option value="">All</option>',bx.innerHTML='<option value="">All</option>';for(let e=0;e<t.length;e++){let n=document.createElement("option");n.value=t[e],n.innerHTML=t[e],bx.appendChild(n)}for(let e=0;e<n.length;e++){let t=document.createElement("option");t.value=n[e],t.innerHTML=n[e],vx.appendChild(t)}wx.innerHTML="";for(let e=0;e<pk.length;e++)wx.innerHTML+=`<div id="${pk[e].id}">\n      \n        <img src="maxweave.png" width="100" height="100">\n      \n      <div id="open-draft-name-container">${pk[e].name}</div>\n      \n    </div>`;for(let e=0;e<pk.length;e++){document.getElementById(pk[e].id).addEventListener("click",kx)}}catch(e){console.log("err is",e)}},_x=()=>{document.addEventListener("keydown",Px),document.getElementById("weftSubContext")&&(document.getElementById("weftSubContext").style.display="none"),nv(),Tx(),gx.style.display="block",gx.style.animation="slide-down 0.3s ease"},Bx=()=>{wx.innerHTML="",gx.style.display="none",Ix=null,document.removeEventListener("keydown",Px),Ol("")},Lx=()=>{Ph.value=Ix.draftPlan,Fh(),Bx()},Px=async e=>{Ix&&"Delete"==e.key&&(await kd("Are you sure you want to permanently delete this file?")?(console.log("delete design",Ix),(e=>{const t=localStorage.getItem("token");return Es.get(`${Is}/draft-plan/delete-draft-plan/${e}`,{headers:{token:t}})})(Ix.id).then(e=>{console.log("delete Draft Plan succuss fully",e.data),Tx(),Sx.value="",Ix=null,xx(null)}).catch(e=>console.log("delete design failed"))):console.log("do not delete it"))},Cx=e=>{let t=String(yx.value),n=String(vx.value),l=String(bx.value);console.log("handle search called",t,n,l);let i=pk.filter(e=>(0==t.length||String(e.name).toLowerCase().includes(t.toLowerCase()))&&(0==l.length||String(e.shaft).toLowerCase().includes(l.toLowerCase()))&&(0==n.length||String(e.ends).toLowerCase().includes(n.toLowerCase())));for(let e=0;e<pk.length;e++){document.getElementById(pk[e].id).style.display="none"}for(let e=0;e<i.length;e++){document.getElementById(i[e].id).style.display="block"}},Nx=document.getElementById("open-pegplan-modal"),Rx=document.getElementById("open-pegplan-modal-trigger");let Ax,Fx,Mx,Ox,Dx,Wx,Hx;const $x=e=>{for(let e=0;e<Bk.length;e++){document.getElementById(Bk[e].id).classList.remove("pegplan-file-active")}e.currentTarget.classList.add("pegplan-file-active");let t=Bk.find(t=>t.id==e.currentTarget.id);Wx=t,qx(Wx)},qx=e=>{Wx=e,Dx.innerHTML="",Hx.value=e.name;let t=mb(e.pegPlan.trimEnd(),!0),n=[],l=0,i=0;String(t).split("\n").filter(e=>e).forEach(e=>{l++,Math.max(...e.split(" "))>i&&(i=Math.max(...e.split(" ")))}),String(t).split("\n").forEach((e,t)=>{e.split(" ").forEach(e=>{e.length>0&&n.push((l-t-1)*i+(e-1))})}),console.log("warpGridInstance rows is",l),OB.change_only_pegplan(n,i,l);const r=Rl,a=Rl,o=On,s=Dn,d=document.createElement("canvas");Dx.appendChild(d),d.width=Math.ceil(i*r),d.height=Math.ceil(l*a);const c=d.getContext("2d");c.clearRect(0,0,d.width,d.height),c.fillStyle="white",c.fillRect(0,0,d.width,d.height),c.fillStyle="black";for(let e=0;e<i+1;e++)c.beginPath(),c.strokeStyle="grey",c.moveTo(o+e*r,s),c.lineTo(o+e*r,s+l*a),c.lineWidth=e%Wn==0?1.5:.5,c.stroke(),c.closePath();for(let e=0;e<l+1;e++)c.beginPath(),c.strokeStyle="grey",c.moveTo(o,s+e*a),c.lineTo(o+i*r,s+e*a),c.lineWidth=(l-e)%Hn==0?1.5:.5,c.stroke(),c.closePath();new Uint32Array(aL.memory.buffer,OB.cells(),OB.selected_warpgrid_length()).forEach(e=>{c.fillRect(e%OB.cols()*r,parseInt(e/OB.cols())*a,r,a)}),c.closePath()},jx=async()=>{try{let e=await _s();Pk(e.data.DATA);let t=[],n=[];t=[...new Set([...Bk.map(e=>e.shaft)])],n=[...new Set([...Bk.map(e=>e.picks)])],Fx.innerHTML='<option value="">All</option>',Mx.innerHTML='<option value="">All</option>';for(let e=0;e<t.length;e++){let n=document.createElement("option");n.value=t[e],n.innerHTML=t[e],Mx.appendChild(n)}for(let e=0;e<n.length;e++){let t=document.createElement("option");t.value=n[e],t.innerHTML=n[e],Fx.appendChild(t)}Ox.innerHTML="";for(let e=0;e<Bk.length;e++)Ox.innerHTML+=`<div class="open-pegplan-data-container-content" id="${Bk[e].id}">\n          <div class="open-pegplan-data-content-image">\n            <img src="maxweave.png" width="100">\n          </div>\n          <div class="open-pegplan-data-content-file-name" >${Bk[e].name}</div>\n      </div>`;for(let e=0;e<Bk.length;e++){const t=document.getElementById(Bk[e].id);t.style.cursor="pointer",t.addEventListener("click",$x)}}catch(e){console.log("err is",e)}},Vx=()=>{document.getElementById("weftSubContext")&&(document.getElementById("weftSubContext").style.display="none"),document.addEventListener("keydown",Yx),console.log("open modal clicked"),nv(),jx(),Nx.style.display="block",Nx.style.animation="slide-down 0.3s ease"},zx=()=>{Ox.innerHTML="",Nx.style.display="none",Wx=null,document.removeEventListener("keydown",Yx),Ol("")},Ux=()=>{console.log("seleced",Wx),ra.value=Wx.pegPlan,ca(),zx()},Yx=async e=>{Wx&&"Delete"==e.key&&(await kd("Are you sure you want to permanently delete this file?")?(console.log("delete pegplan",Wx),(e=>{const t=localStorage.getItem("token");return Es.get(`${configObject.APP_API}/peg-plan/delete-peg-plan/${e}`,{headers:{token:t}})})(Wx.id).then(e=>{console.log("delete Pegplan succuss fully",e.data),jx(),Hx.value="",Wx=null,qx(null)}).catch(e=>console.log("delete design failed"))):console.log("do not delete it"))},Jx=e=>{let t=String(Ax.value),n=String(Fx.value),l=String(Mx.value),i=Bk.filter(e=>(0==t.length||String(e.name).toLowerCase().includes(t.toLowerCase()))&&(0==l.length||String(e.shaft).toLowerCase().includes(l.toLowerCase()))&&(0==n.length||String(e.picks).toLowerCase().includes(n.toLowerCase())));for(let e=0;e<Bk.length;e++){document.getElementById(Bk[e].id).style.display="none"}for(let e=0;e<i.length;e++){document.getElementById(i[e].id).style.display="block"}},Gx=document.getElementById("invert-design-trigger"),Xx=()=>{DB.convert_new_index_to_numeric();let e=DB.get_new_print_pegplan_data(!0);ra.value=e,ca()},Kx=document.getElementById("account-modal-trigger"),Zx=document.getElementById("avatar-account-modal"),Qx=document.getElementById("company-info-companyname"),eT=document.getElementById("company-info-companygst"),tT=document.getElementById("company-info-companyaddress"),nT=document.getElementById("company-info-state"),lT=document.getElementById("company-info-city"),iT=document.getElementById("company-info-postalcode"),rT=document.getElementById("company-info-subscriberid"),aT=document.getElementById("company-info-partnername"),oT=document.getElementById("company-info-partnermobileno"),sT=document.getElementById("profile-info-email"),dT=document.getElementById("profile-info-username"),cT=document.getElementById("profile-info-mobileno"),uT=document.getElementById("profile-info-licenseno"),mT=()=>{(()=>{let e=JSON.parse(localStorage.getItem("company"));Qx.value=e.companyName,eT.value=e.gstNo,tT.value=e.address,nT.value=e.city,lT.value=e.city,iT.value=e.pinCode,rT.value=e.companySubscriptionId,oT.value=e.referenceBy.phoneNo,aT.value=`${e.referenceBy.firstName} ${e.referenceBy.lastName}`;let t=JSON.parse(localStorage.getItem("user"));sT.value=t.email,dT.value=`${t.firstName} ${t.lastName}`,uT.value=t.subscriberCode,cT.value=t.mobileNo})(),nv(),Zx.style.display="block",Zx.style.animation="slide-down 0.3s ease"},hT=()=>{Zx.style.display="none",Ol("")},pT=()=>{var e=document.getElementById("company-logo-upload"),t=document.getElementById("company-logo-drag");function n(e){var t=document.getElementById("company-logo-drag");e.stopPropagation(),e.preventDefault(),t.className="dragover"===e.type?"hover":"modal-body file-upload"}function l(e){var t=e.target.files||e.dataTransfer.files;n(e);for(var l,a=0;l=t[a];a++)i(l),r(l)}function i(e){var t;console.log("file-------\x3e",e),t="<strong>"+encodeURI(e.name)+"</strong>",document.getElementById("messages").innerHTML=t;var n=e.name;/\.(?=gif|jpg|png|jpeg)/gi.test(n)?(document.getElementById("start").classList.add("hidden"),document.getElementById("response").classList.remove("hidden"),document.getElementById("notimage").classList.add("hidden"),document.getElementById("file-image").classList.remove("hidden"),document.getElementById("file-image").src=URL.createObjectURL(e)):(document.getElementById("file-image").classList.add("hidden"),document.getElementById("notimage").classList.remove("hidden"),document.getElementById("start").classList.remove("hidden"),document.getElementById("response").classList.add("hidden"),document.getElementById("company-logo-upload-form").reset())}function r(e){Es.get(configObject.APP_API+"/setting/get-generated-logo-url").then(t=>{if(console.log("res",t),"SUCCESS"===t.data.STATUS){const n=t.data.DATA;console.log("file-------\x3e",e),((e,t)=>{localStorage.getItem("token");return console.log("data",t),Es.put(e,t,{headers:{"Content-Type":"multipart/form-data"}})})(n,e).then(e=>console.log("uploadS3CompanyLogo",e)).catch(e=>console.log(e))}}).catch(e=>console.log("err",e))}e.addEventListener("change",l,!1),(new XMLHttpRequest).upload&&(t.addEventListener("dragover",n,!1),t.addEventListener("dragleave",n,!1),t.addEventListener("drop",l,!1))},gT=()=>{const e=document.getElementById("radio-even"),t=document.getElementById("radio-manual"),n=document.getElementById("edit-dent-even-content"),l=document.getElementById("edit-dent-manual-content");function i(){e.checked?(n.style.display="block",l.style.display="none"):t.checked&&(n.style.display="none",l.style.display="block")}e.addEventListener("change",i),t.addEventListener("change",i),i()};document.addEventListener("DOMContentLoaded",gT);const fT=document.getElementById("cbdesigner-name"),yT=document.querySelector(".designer-name"),vT=document.getElementById("cbparty-name"),bT=document.querySelector(".party-name"),wT=document.getElementById("cborder-no"),ET=document.querySelector(".order-no"),IT=document.getElementById("cbdate"),ST=document.querySelector(".date"),kT=document.getElementById("cbdesign-name"),xT=document.querySelector(".design-name"),TT=document.getElementById("cbtotal-dent"),_T=document.querySelector(".total-dent"),BT=document.getElementById("cbweave-name"),LT=document.querySelector(".weave-name"),PT=document.getElementById("cbdraft-pattern"),CT=document.querySelector(".draft-pattern"),NT=document.getElementById("cbavg-EPI"),RT=document.querySelector(".avg-EPI"),AT=document.getElementById("cbavg-PPI"),FT=document.querySelector(".avg-PPI"),MT=document.getElementById("cbgsm"),OT=document.querySelector(".gsm"),DT=document.getElementById("cbreed"),WT=document.querySelector(".reed"),HT=document.getElementById("cbreed-space"),$T=document.querySelector(".reed-space"),qT=document.getElementById("cbshaft"),jT=document.querySelector(".shaft"),VT=document.getElementById("cbtotal-ends"),zT=document.querySelector(".total-ends"),UT=document.getElementById("cbtotal-picks"),YT=document.querySelector(".total-picks"),JT=document.getElementById("cbepi"),GT=document.querySelector(".epi"),XT=document.getElementById("cbppi"),KT=document.querySelector(".ppi"),ZT=document.getElementById("cbno-of-warp"),QT=document.querySelector(".no-of-warp"),e_=document.getElementById("cbno-of-weft"),t_=document.querySelector(".no-of-weft"),n_=document.getElementById("cbglm"),l_=document.querySelector(".glm"),i_=document.getElementById("cbblend"),r_=document.querySelector(".blend"),a_=(document.getElementById("setting-design-general-form"),document.getElementById("avatar-setting-modal")),o_=document.getElementById("design-fabric-type"),s_=document.getElementById("design-shaft"),d_=document.getElementById("design-ppi"),c_=document.getElementById("design-default-view"),u_=document.getElementById("design-body"),m_=document.getElementById("design-selvedge"),h_=document.getElementById("design-dent-body"),p_=document.getElementById("design-dent-selvedge"),g_=document.getElementById("design-reed"),f_=document.getElementById("design-height-setting"),y_=document.getElementById("design-width-setting"),v_=document.getElementById("design-grid-height"),b_=document.getElementById("design-grid-width"),w_=document.getElementById("setting-modal-apply"),E_=document.getElementById("setting-modal-submit"),I_=document.getElementById("cbcompany-logo"),S_=document.getElementById("cbcompany-address"),k_=document.getElementById("cbcompany-name"),x_=document.getElementById("cbcompany-mo"),T_=document.getElementById("cbcompany-email"),__=document.getElementById("cbprint-desc"),B_=document.getElementById("cbreed"),L_=document.getElementById("cbreed-space"),P_=document.getElementById("cbshaft"),C_=document.getElementById("cbtotal-ends"),N_=document.getElementById("cbtotal-picks"),R_=document.getElementById("cbepi"),A_=document.getElementById("cbppi"),F_=document.getElementById("cbno-of-warp"),M_=document.getElementById("cbno-of-weft"),O_=document.getElementById("cbtotal-dent");let D_={},W_={},H_={},$_={};const q_=()=>{let e=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id;W_={fabricType:o_.checked,defaultView:c_.checked,reed:g_.checked,shaft:s_.checked,designBody:u_.checked,designSelvedge:m_.checked,designHeight:f_.checked,designWidth:y_.checked,ppi:d_.checked,designDentBody:h_.checked,designDentSelvedge:p_.checked,designGridHeight:v_.checked,designGridWidth:b_.checked},H_={isCompanyLogoEnable:I_.checked,isCompanyNameEnable:k_.checked,isCompanyAddressEnable:S_.checked,isCompanyMobileNoEnable:x_.checked,isCompanyEmailEnable:T_.checked,isPrintingDetailsEnable:__.checked},$_={isReedEnable:B_.checked,isReedSpaceEnable:L_.checked,isShaftEnable:P_.checked,isTotalEndsEnable:C_.checked,isTotalPicksEnable:N_.checked,isEpiEnable:R_.checked,isPpieEnable:A_.checked,isNoOfWarpEnable:F_.checked,isNoOfWeftEnable:M_.checked,isTotalDentEnable:O_.checked,isSimulationEnable:!0},D_={user:e,design:{general:W_},dataSheet:{title:H_,details:$_}}},j_=()=>{a_.style.display="none"},V_=()=>{(()=>{let e=document.querySelectorAll(".setting-tabs label"),t=document.querySelectorAll(".setting-tab-contents section");e.forEach((n,l)=>{n.addEventListener("click",()=>{t.forEach(e=>{e.classList.remove("active")}),e.forEach(e=>{e.classList.remove("active")}),t[l].classList.add("active"),e[l].classList.add("active")})})})(),q_(),j_(),w_.addEventListener("click",q_),E_.addEventListener("click",j_)},z_=document.getElementById("create-ticket-modal"),U_=document.getElementById("create-new-ticket-trigger"),Y_=document.getElementById("avatar-support-modal"),J_=document.getElementById("create-ticket-modal-submit"),G_=e=>{e.preventDefault(),(e=>{const t=localStorage.getItem("token");return Es.post(configObject.APP_API+"/complaint/create",e,{headers:{token:t}})})({company:JSON.parse(localStorage.getItem("company")).id,subscriber:JSON.parse(localStorage.getItem("user")),problem:document.getElementById("ticket-problem").value,subject:document.getElementById("ticket-subject").value,complaintType:document.getElementById("complaint-type").value}).then(e=>{"SUCCESS"===e.data.STATUS&&(Toastify({text:"Ticket Create Successfully!!",className:"info",style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast(),K_()),document.getElementById("ticket-problem").value="",document.getElementById("ticket-subject").value="",document.getElementById("complaint-type").value=""}).catch(e=>console.log("err",e))},X_=()=>{Y_.style.display="none",console.log("createTicketModelElement",z_),z_.style.display="block",z_.style.animation="slide-down 0.3s ease"},K_=()=>{z_.style.display="none"},Z_=document.getElementById("avatar-support-modal"),Q_=document.getElementById("support-modal-trigger");let eB="";const tB=()=>{Z_.style.display="block",Z_.style.animation="slide-down 0.3s ease";const e=document.getElementById("support-modal-contents-table");(()=>{const e=localStorage.getItem("token");let t=JSON.parse(localStorage.getItem("user"))&&JSON.parse(localStorage.getItem("user"))._id;return Es.get(`${configObject.APP_API}/complaint/get-subcriber-complaint/${t}`,{headers:{token:e}})})().then(t=>{if(console.log(t),"SUCCESS"===t.data.STATUS){const n=t.data.DATA;e.innerHTML=`\n        <table>\n         <tr>\n         <th>Ticket No </th>\n                <th>\n                  Date And Time\n                </th>\n                <th>Subject</th>\n                <th>Status</th>\n              </tr>\n              ${n.map(e=>{return`\n                <tr>\n                  <td>\n                    ${e.complaintNo}\n                  </td>\n                  <td>\n                    ${e.complaintRegisterDateAndTime}\n                  </td>\n                  <td>\n                    ${e.subject}\n                  </td>\n                  <td>\n                    ${t=e.status,t===gu?"OPEN":t===fu?"ACCEPT":t===yu?"WORKING":t===vu?"FORWARD":t===bu?"WAITING":t===wu?"COMPLETED":void 0}\n                  </td>\n                </tr>`;var t}).join("")}\n            </table>\n        `}}).catch(e=>console.log("err",e))},nB=()=>{Z_.style.display="none"},lB=document.getElementById("upload-bin-file-trigger"),iB=document.getElementById("upload-bin-file-input"),rB=()=>{iB.click()},aB=e=>{const t=e.target.files[0];if(!t)return;nv();const n=new FileReader;n.onload=function(e){(e=>{const t=new Uint8Array(e),n=t.byteLength/4;let l="",i=[],r=[],a="";for(let e=0;e<n;e++){let o=t.slice(4*e,4*(e+1)),s="",d="";o.forEach(e=>{s+=Number(e).toString(2).padStart(8,"0").split("").reverse().join("")});let c=s.at(23);Number(c)&&i.push(new ci("A",n-e-1));let u=s.slice(-8).search("1"),m=s.slice(20,23).search("1");-1!=m&&r.push(new ci(String.fromCharCode(65+m),n-e-1)),-1!=u&&(a+=String.fromCharCode(65+u)+"\n"),d=s.slice(0,20).split("").map((e,t)=>Number(e)?""+(t+1):"").filter(e=>e).join(" "),l+=d+"\n"}Zr("weft"),Yr.value=a,la(),YB.cells=i,GB.cells=r,ra.value=l.trim(),ca()})(e.target.result)},n.onerror=function(e){console.error("Failed to read file: "+e.target.error.code)},n.readAsArrayBuffer(t)},oB=document.getElementById("import-draft-texcad"),sB=document.getElementById("import-draft-texcad-file"),dB=()=>{sB.click()},cB=e=>{const t=e.target.files[0];if(!t)return;nv(),Pw();const n=new FileReader;n.onload=function(e){const t=e.target.result;(e=>{console.log(" drf buffer is",e);const t=new Uint8Array(e);let n=[],l=[],i="",r="";for(let e=0;e<1e3;e++){const a=13*e;let o=t.slice(a,a+12),s=t[a+12];if(o.forEach((e,t)=>{if(e)if(e>100){let t=yb(mb(r));l.push(t),r+=e-100+" "}else r+=50==e?"0 ":e+" "}),s){let e=yb(mb(i)),t=yb(mb(r));if(r.trim().length>0&&(i+=`[${r.trim()}]X${s}\n`,r=""),l.length>0){for(let i=0;i<s;i++)l.forEach(l=>{n.push(new ci("A",e+l+t*i))});l=[]}}else r=r.trim(),r+="\n"}console.log("Extra warp cells are",n),Ph.value=i,JB.cells=n,Fh()})(t),console.log("Processing Done",t)},n.onerror=function(e){console.error("Failed to read file: "+e.target.error.code)},n.readAsArrayBuffer(t)},uB=document.getElementById("upload-file-trigger"),mB=document.getElementById("upload-file-input"),hB=()=>{mB.click()};function pB(e){let t=[];for(let n=0;n<8;n++)0!=(e&1<<n)&&t.push(n);return t}function gB(e){if(0===e)return-1;for(let t=0;t<8;t++)if(0!=(e&1<<t))return t}const fB=e=>{let t={};const n=new Uint8Array(e),l=new Uint8Array(4);let i=n.slice(0,12);if(3!=i[0]||49!=i[1]&&46!=i[2]&&48!=i[3])return void Toastify({text:"Please Selected Valid Mwd File",style:{background:"linear-gradient(135deg,#FF0200, #F6A5A5)"}}).showToast();l[0]=n[12],l[1]=n[13],l[2]=n[14],l[3]=n[15];const r=gc(l),a=new Uint8Array(4);a[0]=n[16],a[1]=n[17],a[2]=n[18],a[3]=n[19];const o=gc(a),s=new Uint8Array(4);s[0]=n[20],s[1]=n[21],s[2]=n[22],s[3]=n[23];const d=gc(s);t.designWidth=r,t.designHeight=o,t.shaft=d;let c=[],u=24,m=[],h=[],p="";const g={size:r,isWeftColor:!1,isFunctionCanvas:!1,isWarpColor:!1,isWarpCreamingCanvas:!0,isDencityCanvas:!1,cells:[],fixNumericText:""};for(let e=0;e<r;e++){n[u]>0&&g.cells.push(new ci("A",e));let t=`rgb(${n[u+4]},${n[u+5]},${n[u+6]})`,l=h.findIndex(e=>e==t);-1==l?(h.push(t),p+=String.fromCharCode(64+h.length)+"\n"):p+=String.fromCharCode(65+l)+"\n";const i=gB(n[u+8]),r=gB(n[u+9]),a=gB(n[u+10]),o=gB(n[u+11]);d>0&&d<=8?r>-1&&c.push(r+1):d>8&&d<=16?i>-1?i+1-16+d>0?c.push(i+1-(16-d)):c.push(0):r>-1&&9+r-16+d>0?c.push(9+r-(16-d)):c.push(0):d>16&&d<=24?(i>-1&&c.push(9+i-(24-d)),r>-1&&c.push(17+r-(24-d)),o>-1&&c.push(1+o-(24-d))):d>24&&d<=32?i>-1?c.push(32-d+i+9):a>-1?c.push(a+d-32+1):o>-1?c.push(32-d+o+1):c.push(0):d>32&&d<=40&&(i>-1?c.push(40-d+i+9):a>-1?c.push(a+d-40+1):o>-1?c.push(40-d+o+1):c.push(0)),n[u+24]<2?m.push(1):m.push(2),u+=28}let f="";c.length==m.length?(c.forEach((e,t)=>{m[t]!=m[t-1]?f+="\n":f+=" ",f+=e}),f=f.trim()):c.forEach((e,t)=>{f+=e+((t+1)%2==0?"\n":" ")});let y="",v=[],b="";for(let e=0;e<o;e++){let e=[],t=`rgb(${n[u+0]},${n[u+1]},${n[u+2]})`,l=v.findIndex(e=>e==t);-1==l?(v.push(t),b+=String.fromCharCode(64+v.length)+"\n"):b+=String.fromCharCode(65+l)+"\n";let i=pB(n[u+4]),r=pB(n[u+5]),a=pB(n[u+6]),o=pB(n[u+7]);if(i.length>0)for(let t=0;t<i.length;t++)e.push(16-i[t]);if(r.length>0)for(let t=0;t<r.length;t++)e.push(8-r[t]);if(a.length>0)for(let t=0;t<a.length;t++)e.push(32-a[t]);if(o.length>0)for(let t=0;t<o.length;t++)e.push(24-o[t]);u+=36,e=e.sort((e,t)=>e-t),y+=e.join(" ")+"\n"}let w={},E={};var I;v.forEach((e,t)=>{w[String.fromCharCode(t+65)]=e}),I=w,Object.keys(I).forEach(e=>{Qm[""+e]=I[""+e],document.getElementById("weft-color-"+e).style.backgroundColor=I[""+e]}),h.forEach((e,t)=>{E[String.fromCharCode(t+65)]=e}),(e=>{Object.keys(e).forEach(t=>{Lr[""+t]=e[""+t],document.getElementById("warp-color-"+t).style.backgroundColor=e[""+t]})})(E),y=y.split("\n").reverse().join("\n").trim(),t.pegPlan=y,t.weftPattern=b,t.draftPlan=f,t.warpPattern=p,t.extraWarp=JSON.stringify(g),fd(t)},yB=e=>{const t=e.target.files[0];if(!t)return;nv();const n=new FileReader;n.onload=function(e){const t=e.target.result;fB(t),console.log("Processing Done",t)},n.onerror=function(e){console.error("Failed to read file: "+e.target.error.code)},n.readAsArrayBuffer(t)},vB=document.getElementById("import-pegplan-texcad"),bB=document.getElementById("import-pegplan-texcad-file"),wB=()=>{bB.click()},EB=e=>{const t=e.target.files[0];if(!t)return;nv(),Pw();const n=new FileReader;n.onload=function(e){const t=e.target.result;(e=>{console.log(" drf buffer is",e);const t=new Uint8Array(e);let n=7500==t.byteLength,l=n?300:1e3,i=n?24:22,r="",a="",o=[],s=[];for(let e=0;e<l;e++){const l=25*e;let d=t.slice(l,l+i),c=n?0:t[l+23],u=t[l+24];if(d.forEach((e,t)=>{e&&(a+=t+1+" ")}),c){let e=fb(mb(a));s.push(e)}if(u){let e=fb(mb(r)),t=fb(mb(a));if(a.trim().length>0&&(r+=`[${a.trim()}]X${u}\n`,a=""),s.length>0){for(let n=0;n<u;n++)s.forEach(l=>{o.push(new ci("A",e+l+t*n))});s=[]}}else a=a.trim(),a+="\n"}ra.value=r,ca();let d=YB.size;YB.cells=o.map(e=>({...e,index:d-e.index})),hh()})(t),console.log("Processing Done",t)},n.onerror=function(e){console.error("Failed to read file: "+e.target.error.code)},n.readAsArrayBuffer(t)},IB=(document.getElementById("upload-pt7-file-trigger"),document.getElementById("upload-pt7-file-input"),()=>{uB.addEventListener("click",hB),mB.addEventListener("change",yB),oB.addEventListener("click",dB),sB.addEventListener("change",cB),vB.addEventListener("click",wB),bB.addEventListener("change",EB),Ec.addEventListener("click",Sc),Ic.addEventListener("change",kc),lB.addEventListener("click",rB),iB.addEventListener("change",aB),fc.addEventListener("click",vc),yc.addEventListener("change",wc)}),SB=()=>{document.querySelectorAll(".modal").forEach(e=>{!function(e){let t=0,n=0,l=0,i=0;function r(r){r.preventDefault(),t=l-r.clientX,n=i-r.clientY,l=r.clientX,i=r.clientY,e.style.top=e.offsetTop-n+"px",e.style.left=e.offsetLeft-t+"px"}function a(){document.onmouseup=null,document.onmousemove=null}(e.querySelector(".modal-title")||e).onmousedown=function(e){e.preventDefault(),l=e.clientX,i=e.clientY,document.onmouseup=a,document.onmousemove=r}}(e)})},kB=document.getElementById("main-canvas"),xB=(document.getElementById("warp-canvas"),document.getElementById("weft-canvas")),TB=document.getElementById("loading-animation"),_B=document.getElementById("l-salvage-weft-canvas"),BB=document.getElementById("r-salvage-dent-container"),LB=document.getElementById("r-salvage-weft-canvas"),PB=(document.getElementById("weft-color-canvas"),document.getElementById("weft-color-side-canvas"),document.getElementById("weft-scale-canvas"),document.getElementById("warp-color-canvas"),document.getElementById("warp-scale-canvas"),document.getElementById("grid-nav-content")),CB=document.getElementById("site-reload-trigger"),NB=document.getElementById("reed"),RB=document.getElementById("treadles");var AB,FB,MB,OB,DB,WB,HB,$B,qB,jB,VB,zB,UB,YB,JB,GB,XB,KB,ZB,QB,eL,tL,nL,lL,iL,rL,aL;XB=new ui(hf,!0,!1,!1,!1),YB=new ui(hf,!1,!0,!1,!1,!1),GB=new ui(hf,!1,!1,!1,!1,!0),KB=new ui(mf,!1,!1,!0,!1,!1),JB=new ui(mf,!1,!1,!1,!0,!1),Promise.all([n.e(0),n.e(2)]).then(n.bind(null,43)).then(async({MainGrid:e,WeftGrid:t,WarpGrid:l,DentGrid:i,SalvageMainGrid:r,SalvageWeftGrid:a,SalvageDentGrid:o,TieupGrid:s,BeamGrid:d,PrintObject:c,compress_seq_string:u,compress_string:m,compress_seq_prefix_string:h})=>{aL=await n.e(0).then(n.bind(null,42)),nL=u,iL=m,lL=h,rL=c,CB.addEventListener("dblclick",()=>{location.reload(!0)});const p=()=>{Mf.value=4,Of.value=4,Ef.value=12,vf.value=.5,bf.value=.5,Lf.value=45.5,jf.value=2,qf.value="inch",wf.value=parseFloat(46.5).toFixed(2),NB.value=96,xf.value=parseInt(96/Number(jf.value)*Number(.5)),Tf.value=parseInt(96/Number(jf.value)*Number(45.5)),_f.value=parseInt(96/Number(jf.value)*Number(.5)),Bf.value=Number(xf.value)+Number(Tf.value)+Number(_f.value),If.value=4,Sf.value=2,kf.value=4,Pf.value=xf.value*Number(If.value),Cf.value=Tf.value*Number(Sf.value),Nf.value=_f.value*Number(kf.value),Uf(Number(Pf.value)),Jf(Number(Nf.value)),Rf.value=Number(Pf.value)+Number(Cf.value)+Number(Nf.value),Ff.value=52..toFixed(2),Af.value=parseFloat(Number(Cf.value)/Number(Lf.value)).toFixed(2),Df.value=cf,Wf.value=df,Hf.value=hf,$f.value=mf,(()=>{for(let e=65;e<=90;e++){const t=e<=91,n=e<=80;e<=91&&(Lr[""+String.fromCharCode(e)]=ai[e-65],Eb.innerHTML+=`<div class="color-items relative">\n        \n        <button class="color-item" style="background-color:${ai[e-65]};color:${["#000000","rgb(0,0,0)"].includes(ai[e-65])?"white":"black"}" id="warp-color-${String.fromCharCode(e)}">${String.fromCharCode(e)}</button>\n      </div>`),t&&(Qm[""+String.fromCharCode(e)]=oi[e-65],Ib.innerHTML+=`<div class="color-items relative">\n      <button class="color-item" style="background-color:${oi[e-65]};color:${["#000000","rgb(0,0,0)"].includes(oi[e-65])?"white":"black"}" id="weft-color-${String.fromCharCode(e)}">${String.fromCharCode(e)}</button>\n    </div>`),n&&(eh[""+String.fromCharCode(e)]=si[e-65],xb.innerHTML+=`<div class="color-items relative">\n      <button class="color-item" style="background-color:${si[e-65]};color:${["#000000","rgb(0,0,0)"].includes(si[e-65])?"white":"black"}" id="function-color-${String.fromCharCode(e)}">${e-65+1}</button>\n    </div>`)}for(let e=65;e<=90;e++){let t=document.getElementById("warp-color-"+String.fromCharCode(e)),n=document.getElementById("weft-color-"+String.fromCharCode(e)),l=document.getElementById("function-color-"+String.fromCharCode(e));t&&nw(t,"Yarn Editor",!0),n&&nw(n,"Yarn Editor",!0),l&&nw(l,"Function Color",!0)}Lb.style.backgroundColor=document.getElementById("warp-color-A").style.backgroundColor,Pb.style.backgroundColor=document.getElementById("weft-color-A").style.backgroundColor,Cb.style.backgroundColor=document.getElementById("function-color-"+Zm).style.backgroundColor,["#000000","rgb(0,0,0)"].includes(oi[0])&&(Pb.style.color="white"),["#000000","rgb(0,0,0)"].includes(ai[0])&&(Lb.style.color="white"),Eb.style.width="65vw",Ib.style.width="65vw",xb.style.width="65vw",xb.style.overflowX="hidden",Eb.style.overflowX="hidden",Ib.style.overflowX="hidden",Nb.addEventListener("click",Qb),Rb.addEventListener("click",ew),document.getElementById("increaseBtn").addEventListener("click",(function(){zb=(zb+1)%Jb.length,document.getElementById("model-letter-box").value=Jb[zb],console.log("warp color is",Lr[Jb[zb]]),Ab.value=mu("weft"==Vb.value?Qm[Jb[zb]]:Lr[Jb[zb]]),Fb.value=Pr[Jb[zb]]?Pr[Jb[zb]].yarnName:"",Mb.value=Pr[Jb[zb]]?Pr[Jb[zb]].yarnType:""})),document.getElementById("decreaseBtn").addEventListener("click",(function(){zb=(zb-1+Jb.length)%Jb.length,document.getElementById("model-letter-box").value=Jb[zb],Ab.value=mu("weft"==Vb.value?Qm[Jb[zb]]:Lr[Jb[zb]]),Fb.value=Pr[Jb[zb]]?Pr[Jb[zb]].yarnName:"",Mb.value=Pr[Jb[zb]]?Pr[Jb[zb]].yarnType:""})),qb.addEventListener("click",e=>{Kb(Eb)}),jb.addEventListener("click",e=>{Xb(Eb)}),Db.addEventListener("click",e=>{Kb(Ib)}),Wb.addEventListener("click",e=>{Xb(Ib)}),Hb.addEventListener("click",e=>{Kb(xb)}),$b.addEventListener("click",e=>{console.log("clicked"),Xb(xb)}),Lb.addEventListener("click",()=>{Gb(Ub.WARP)}),Pb.addEventListener("click",()=>{Gb(Ub.WEFT)}),Cb.addEventListener("click",()=>{Gb(Ub.FUNCTION)}),Vb.addEventListener("change",e=>{"weft"==e.target.value?(Ab.value=Qm[Ob.value],Fb.value=th[Ob.value]?th[Ob.value].yarnName:"",Mb.value=th[Ob.value]?th[Ob.value].yarnType:""):(Ab.value=Lr[Ob.value],Fb.value=Pr[Ob.value]?Pr[Ob.value].yarnName:"",Mb.value=Pr[Ob.value]?Pr[Ob.value].yarnType:"")})})()};QB=()=>{AB=e.new(df,cf,Rl,(parseFloat(Af.value)/parseFloat(Ff.value)).toFixed(2)*Rl),FB=t.new(df,af,Rl),MB=t.new(2,af,Rl),DB=l.new(af,cf,Rl),HB=s.new(af,af,Rl),OB=l.new(af,2,Rl),WB=i.new(mf,2,Rl),jB=o.new(of,2,Rl),qB=a.new(of,af,Rl),$B=r.new(of,cf,Rl,Rl),UB=o.new(sf,2,Rl),zB=a.new(sf,af,Rl),VB=r.new(sf,cf,Rl,Rl),ZB=d.new(df,2,Rl),i.new(df,2,Rl)},eL=()=>{tL();let e=_B.width+xB.width+LB.width+500;PB.style.width=e<window.innerWidth?"100vw":e+"px",BB.style.marginLeft=kB.width-vh.width+10+"px"},tL=()=>{Cm(),gE(),Dm(),rI()};document.addEventListener("click",(function(e){document.querySelector("#avatar-trigger").contains(e.target)||document.querySelector(".menu-container").classList.remove("active")}));(()=>{const e=window.location.search,t=new URLSearchParams(e).get("token");localStorage.setItem("token",t),t?axios.get(`${Vp}/subscriber/redirect-url/${t}`).then(e=>{if(e.data.DATA){let t=e.data.DATA.company;console.log("companyDetail",t);let n=e.data.DATA.user;n&&(document.getElementById("submenu-user-name").innerText=`${n.firstName} ${n.lastName}`,localStorage.setItem("user",JSON.stringify(n))),t&&(document.getElementById("submenu-company-name").innerText=""+t.companyName,localStorage.setItem("company",JSON.stringify(t)),zp())}}).catch(e=>{console.log("err",e),window.location.replace(window.location.origin+"/login.html")}):window.location.replace(window.location.origin+"/login.html")})(),p(),QB(),eL(),iI({target:{scrollLeft:0}}),hE({target:{scrollTop:0}}),uu(),yI(),Om(),xE(),mi.addEventListener("mousedown",ki),mi.addEventListener("mousemove",Si),mi.addEventListener("mouseup",Ii),wi.addEventListener("mousedown",xi),pi.addEventListener("mousedown",Ti),Ci.addEventListener("mousedown",qi),Ci.addEventListener("mousemove",$i),Ai.addEventListener("mousedown",Ji),Mi.addEventListener("mousedown",Gi),vh.addEventListener("mousedown",kh),vh.addEventListener("mousemove",Th),vh.addEventListener("mouseleave",gI),bh.addEventListener("mousemove",_h),bh.addEventListener("mousedown",xh),bh.addEventListener("mouseleave",gI),Ki.addEventListener("mousedown",ir),Ki.addEventListener("mouseup",nr),Ki.addEventListener("mousemove",lr),Ki.addEventListener("mouseleave",gI),(()=>{let e=document.querySelectorAll(".arrow");for(var t=0;t<e.length;t++)e[t].addEventListener("click",e=>{e.target.parentElement.parentElement.classList.toggle("showMenu")});let n=document.querySelector(".sidebar"),l=document.querySelector(".fa-bars");document.querySelector(".bx-log-out").addEventListener("click",()=>{n.classList.toggle("close"),n.style.visibility="hidden"}),l.addEventListener("click",()=>{console.log("clicked"),n.classList.toggle("close"),n.style.visibility="visible"})})(),document.getElementById("edit-draft-apply").addEventListener("click",()=>Fh(!0)),document.getElementById("edit-draft-ok").addEventListener("click",Mh),Ph.addEventListener("input",Ah),Hm.style.display=Zn?"block":"none",$m.style.display=el?"block":"none",Cw(Um,Jm),Um.addEventListener("mousedown",ah),Um.addEventListener("mousemove",oh),Um.addEventListener("mouseleave",gI),qm.addEventListener("mousedown",sh),Vm.addEventListener("mousedown",dh),Vm.addEventListener("mousemove",uh),qm.addEventListener("mousemove",ch),qm.addEventListener("mouseleave",gI),Vm.addEventListener("mouseleave",gI),Cw(Nr,Ar),Nr.addEventListener("mousedown",qr),Nr.addEventListener("mousemove",Vr),Nr.addEventListener("mouseleave",gI),Fr.addEventListener("mousemove",zr),Fr.addEventListener("mouseleave",gI),Fr.addEventListener("mousedown",jr),document.getElementById("edit-sequance-apply").addEventListener("click",la),document.getElementById("edit-sequance-ok").addEventListener("click",ia),Yr.addEventListener("input",na),document.getElementById("pegplan-apply").addEventListener("click",()=>ca(!0)),document.getElementById("pegplan-ok").addEventListener("click",ua),ra.addEventListener("input",sa),(()=>{zy.addEventListener("click",()=>{Yy.classList.add("none"),Gy.classList.add("none"),jy.classList.toggle("none")});for(var e=document.getElementsByClassName("menu-click"),t=0;t<e.length;t++)e[t].addEventListener("click",lv);document.addEventListener("click",(function(t){var n=t.target;Array.from(e).some((function(e){return e.contains(n)}))||!Zy||Zy.contains(n)||(Zy.classList.remove("absolute"),Zy.classList.add("none"),Zy=null)})),Jy.addEventListener("click",()=>{Gy.classList.add("none"),jy.classList.add("none"),Yy.classList.toggle("none")}),Xy.addEventListener("click",()=>{jy.classList.add("none"),Yy.classList.add("none"),Gy.classList.toggle("none")}),Ky.addEventListener("click",()=>{Uy.classList.add("none"),Vy.classList.toggle("none"),Yy.classList.toggle("none")}),Qy.addEventListener("click",()=>{Fy(),nv()}),ev.addEventListener("click",()=>{Vl(),Ry(),nv()}),tv.addEventListener("click",()=>{My(),nv()})})(),fo(Xa,Ka,0,no,"New File"),fo(lo,ro,0,!1,"Edit-Sequence"),fo(io,ro,0,!1,"Edit-Sequence"),fo(za,ro,0,!1,"Edit-Sequence"),fo(Ua,ro,0,!1,"Edit-Sequence"),fo(Ya,ao,0,!1,"Edit-Dent"),fo(eo,to,0,!1,"Weave Generator"),fo(oo,uo,0,!1,"Draft Edit Number"),fo(Ja,uo,0,!1,"Draft Edit Number"),fo(Ga,ho,0,!1,"Pegplan Edit Num"),fo(mo,ho,0,!1,"Pegplan Edit Num"),fo(Za,Qa,0,!1,"Selvedge Draft And Warp Sequence"),fo(po,go,0,!1,"Generate Machine File"),fo(so,co,0,!1,"Setting"),Lw(),qy(),oy(),(()=>{const e=vv.querySelector(".close-button");vv.addEventListener("keydown",e=>{"Escape"==e.key&&Bv()}),e.addEventListener("click",Bv),yv.addEventListener("click",_v),ov.addEventListener("click",Tv),sv.addEventListener("click",xv),hv.addEventListener("change",Sv),pv.addEventListener("change",kv)})(),(()=>{xc.addEventListener("click",qc),Tc.addEventListener("click",Ac),_c.addEventListener("click",Oc),Bc.addEventListener("click",Wc),Cc.addEventListener("change",Hc),Pc.querySelector(".close").addEventListener("click",$c);const e=Pc.querySelector(".modal-title");e&&(e.innerText="Loom Profile")})(),Ea.querySelectorAll(".close-button"),wa.addEventListener("click",Na),Ia.addEventListener("click",La),Sa.addEventListener("click",Ca),(()=>{document.querySelectorAll(".close-button");fo(Ma,Oa,0,!1,"Pattern Editor")})(),sg(),yg.innerHTML='<div class="modal-content">\n    <div class="close">\n      <span class="close-button">&times;</span>\n    </div>\n    <div class="modal-title">\n    Notes\n    </div>\n    <div class="modal-desc">\n      <div class="flex modal-form colunm justify-center item-center">\n       \n        <div class="text-area">\n          <textarea name="design-notes" id="design-notes" cols="30" rows="20"></textarea>\n        </div>\n      \n        <hr>\n        <div class="btn-group">\n          <button class="btn-submit" type="button" id="design-notes-apply">Apply</button>\n          <button class="btn-submit" type="button" id="design-notes-ok">ok</button>\n        </div>\n      </div>\n\n    </div>\n  </div>',yg.querySelector(".close-button").addEventListener("click",Tg),bg=document.getElementById("design-notes"),wg=document.getElementById("design-notes-apply"),Eg=document.getElementById("design-notes-ok"),vg.addEventListener("click",xg),wg.addEventListener("click",Sg),Eg.addEventListener("click",kg),bd(),au(),TI(),(()=>{yp.innerHTML=pg(),yp.querySelector(".close-button").addEventListener("click",Op);const e=yp.querySelector(".modal-desc");yp.addEventListener("click",t=>{t.composedPath().includes(e)||Op()}),vp.addEventListener("click",Mp),bp.addEventListener("click",Mp),xp=document.getElementById("simulation-options-menu"),Lp=document.getElementById("add-start-end-part-button"),Pp=document.getElementById("design-selection-parent"),Tp=document.getElementById("simulation-set-button"),_p=document.getElementById("simulation-print-button"),Bp=document.getElementById("simulation-view-type"),xp.addEventListener("change",Dp),Bp.addEventListener("change",Wp),Lp.addEventListener("click",$p),0==Rp&&$p(),Tp.addEventListener("click",jp),_p.addEventListener("click",qp),document.addEventListener("keydown",e=>{"Escape"===e.key&&Op()})})(),(()=>{console.log("fabricCalculationTrigger",_I);const e=BI.querySelector(".modal-title"),t=BI.querySelector(".close-button");e.innerHTML="Cost Calulation",t.addEventListener("click",rS),_I.addEventListener("click",iS),eS.addEventListener("click",nS),tS.addEventListener("click",lS),PI.addEventListener("change",aS),NI.addEventListener("change",aS),CI.addEventListener("change",aS),AI.addEventListener("change",aS),RI.addEventListener("change",aS),RI.addEventListener("change",aS),MI.addEventListener("change",aS),DI.addEventListener("change",aS),OI.addEventListener("change",aS),FI.addEventListener("change",aS),WI.addEventListener("change",aS),$I.addEventListener("change",aS),HI.addEventListener("change",aS),jI.addEventListener("change",aS),qI.addEventListener("change",aS),zI.addEventListener("change",aS),VI.addEventListener("change",aS),YI.addEventListener("change",aS),UI.addEventListener("change",aS),JI.addEventListener("change",aS),XI.addEventListener("change",aS),GI.addEventListener("change",aS),ZI.addEventListener("change",aS),KI.addEventListener("change",aS),QI.addEventListener("change",aS)})(),Eu.addEventListener("click",Ou),Iu.addEventListener("click",Wu),Su.addEventListener("click",Du),Iu.parentElement.style.backgroundColor="#d2cbcba6",(()=>{sr.innerHTML=cg(),dr.addEventListener("click",pr),sr.querySelector(".close-button").addEventListener("click",fr);const e=sr.querySelector("#draft-in-part-modal-addpart"),t=sr.querySelector("#draft-in-part-modal-removepart"),n=sr.querySelector("#draft-in-part-modal-apply"),l=sr.querySelector("#draft-in-part-modal-ok");cr=sr.querySelector("#all-draft-in-part-parent"),n.addEventListener("click",Tr),l.addEventListener("click",_r),e.addEventListener("click",()=>{vr()}),t.addEventListener("click",kr)})(),(()=>{Oh.innerHTML=ug(),qh=Oh.querySelector("#design-with-part-error-message"),Dh.addEventListener("click",Xh);const e=Oh.querySelector(".close-button");Wh=Oh.querySelector("#design-with-part-table"),Hh=Oh.querySelector("#design-with-part-table-footer"),e.addEventListener("click",Zh);const t=Oh.querySelector("#design-with-part-modal-apply"),n=Oh.querySelector("#design-with-part-modal-ok"),l=Oh.querySelector("#design-with-part-modal-addpart"),i=Oh.querySelector("#design-with-part-modal-removepart");l.addEventListener("click",pp),i.addEventListener("click",gp),t.addEventListener("click",ep),n.addEventListener("click",tp)})(),Dm(),rI(),(()=>{const e=document.getElementById("cbcompany-name"),t=document.querySelector(".company-name");e.addEventListener("change",(function(){e.checked?t.style.display="block":t.style.display="none"}));const n=document.getElementById("cbcompany-logo"),l=document.querySelector("#company-logo");n.addEventListener("change",(function(){n.checked?l.style.display="block":l.style.display="none"}));const i=document.getElementById("cbcompany-address"),r=document.querySelector(".company-address");i.addEventListener("change",(function(){i.checked?r.style.display="block":r.style.display="none"}));const a=document.getElementById("cbcompany-mo"),o=document.querySelector(".company-mo");a.addEventListener("change",(function(){a.checked?o.style.display="block":o.style.display="none"}));const s=document.getElementById("cbcompany-email"),d=document.querySelector(".company-email");s.addEventListener("change",(function(){s.checked?d.style.display="block":d.style.display="none"}));const c=document.getElementById("cbprint-desc"),u=document.querySelector(".print-desc");c.addEventListener("change",(function(){c.checked?u.style.display="block":u.style.display="none"}))})(),fT.addEventListener("change",(function(){fT.checked?yT.style.display="revert":yT.style.display="none"})),vT.addEventListener("change",(function(){vT.checked?bT.style.display="revert":bT.style.display="none"})),wT.addEventListener("change",(function(){wT.checked?ET.style.display="revert":ET.style.display="none"})),IT.addEventListener("change",(function(){IT.checked?ST.style.display="revert":ST.style.display="none"})),kT.addEventListener("change",(function(){kT.checked?xT.style.display="revert":xT.style.display="none"})),TT.addEventListener("change",(function(){TT.checked?_T.style.display="revert":_T.style.display="none"})),BT.addEventListener("change",(function(){BT.checked?LT.style.display="revert":LT.style.display="none"})),PT.addEventListener("change",(function(){PT.checked?CT.style.display="revert":CT.style.display="none"})),NT.addEventListener("change",(function(){NT.checked?RT.style.display="revert":RT.style.display="none"})),AT.addEventListener("change",(function(){AT.checked?FT.style.display="revert":FT.style.display="none"})),MT.addEventListener("change",(function(){MT.checked?OT.style.display="revert":OT.style.display="none"})),DT.addEventListener("change",(function(){DT.checked?WT.style.display="revert":WT.style.display="none"})),HT.addEventListener("change",(function(){HT.checked?$T.style.display="revert":$T.style.display="none"})),qT.addEventListener("change",(function(){qT.checked?jT.style.display="revert":jT.style.display="none"})),VT.addEventListener("change",(function(){VT.checked?zT.style.display="revert":zT.style.display="none"})),UT.addEventListener("change",(function(){UT.checked?YT.style.display="revert":YT.style.display="none"})),JT.addEventListener("change",(function(){JT.checked?GT.style.display="revert":GT.style.display="none"})),XT.addEventListener("change",(function(){XT.checked?KT.style.display="revert":KT.style.display="none"})),ZT.addEventListener("change",(function(){ZT.checked?QT.style.display="revert":QT.style.display="none"})),e_.addEventListener("change",(function(){e_.checked?t_.style.display="revert":t_.style.display="none"})),n_.addEventListener("change",(function(){n_.checked?l_.style.display="revert":l_.style.display="none"})),i_.addEventListener("change",(function(){i_.checked?r_.style.display="revert":r_.style.display="none"})),document.querySelector("#avatar-trigger").addEventListener("click",(function(){document.querySelector(".menu-container").classList.toggle("active")})),V_(),(()=>{KS.innerHTML='<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">\n    Save Color Palette\n  </div>\n<div class="modal-desc">\n\n<div class="flex color-paletter-searchbar">\n  <label for="search-save-color-palette">Search</label>\n  <input id="search-save-color-palette" />\n</div>\n<div id="save-color-palette-data-container">\n\n</div>\n<div class="flex file-name-container">\n<div class="flex">\n<span>File Name</span>\n<input id="save-color-palette-file-name" type="text"/>\n</div>\n <div>\n \n <button class="btn-submit" type="button" id="save-color-palette-modal-ok">Save</button>\n </div>\n\n</div>\n</div>\n</div>',QS=document.getElementById("save-color-palette-file-name");for(let e=0;e<ZS.length;e++)ZS.item(e).addEventListener("click",lk);ek=document.getElementById("search-save-color-palette"),tk=document.getElementById("save-color-palette-data-container"),KS.querySelector(".close-button").addEventListener("click",ik),document.getElementById("save-color-palette-modal-ok").addEventListener("click",rk),ek.addEventListener("input",ak)})(),(()=>{Ps.innerHTML=mg(),Ms=document.getElementById("search-open-color-palette"),Ns=document.getElementById("color-palette-data-container"),Rs=document.getElementById("color-palette-preview-content"),Fs=document.getElementById("open-color-palette-file-name");for(let e=0;e<Cs.length;e++)Cs.item(e).addEventListener("click",$s);Ps.querySelector(".close-button").addEventListener("click",qs),document.getElementById("open-color-palette-modal-ok").addEventListener("click",js),Ms.addEventListener("input",Hs)})(),(()=>{sk.innerHTML='<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">Draft Library</div>\n  <div class="modal-desc">\n    <div class="flex color-paletter-searchbar">\n      <label for="search-save-draft">Search</label>\n      <input id="search-save-draft" />\n    </div>\n    <div id="save-draft-data-container"></div>\n    <div class="flex file-name-container">\n      <div class="flex">\n        <span>File Name</span>\n        <input id="save-draft-file-name" type="text" />\n      </div>\n      <div>\n        <button\n          class="btn-submit"\n          type="button"\n          id="save-draft-modal-ok"\n        >\n          Save\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n',dk.addEventListener("click",yk),ck=document.getElementById("save-draft-file-name");const e=sk.querySelector(".close-button");uk=document.getElementById("search-save-draft"),mk=document.getElementById("save-draft-data-container"),uk.addEventListener("input",bk),document.getElementById("save-draft-modal-ok").addEventListener("click",Ek),e.addEventListener("click",vk)})(),gx.innerHTML='<div class="modal-content">\n<div class="close">\n  <span class="close-button">&times;</span>\n</div>\n<div class="modal-title">\n Open Draft\n</div>\n<div class="modal-desc">\n\n<div class="flex color-paletter-searchbar">\n\n\n<label for="search-open-draft">Search</label>\n<input id="search-open-draft" />\n\n<label for="search-shaft-open-draft">Shaft</label>\n<select id="search-shaft-open-draft"></select>\n\n\n<label for="search-ends-open-draft">Ends</label>\n<select id="search-ends-open-draft"></select>\n\n</div>\n<div>\n<div id="open-draft-data-container"></div>\n<div id="draft-preview-container">\n  <div></div>\n  <div id="draft-preview-content" class="flex"></div>\n</div>\n</div>\n\n\n<div class="flex file-name-container">\n<div class="flex">\n<span>File Name</span>\n<input id="open-draft-file-name" type="text"/>\n</div>\n <div>\n \n <button class="btn-submit" type="button" id="open-draft-modal-ok">Open</button>\n </div>\n\n</div>\n</div>\n</div>\n',yx=document.getElementById("search-open-draft"),vx=document.getElementById("search-ends-open-draft"),bx=document.getElementById("search-shaft-open-draft"),wx=document.getElementById("open-draft-data-container"),Ex=document.getElementById("draft-preview-content"),Sx=document.getElementById("open-draft-file-name"),fx.addEventListener("click",_x),gx.querySelector(".close-button").addEventListener("click",Bx),document.getElementById("open-draft-modal-ok").addEventListener("click",Lx),yx.addEventListener("input",Cx),vx.addEventListener("change",Cx),bx.addEventListener("change",Cx),(()=>{Ik.innerHTML='<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">Pegplan Library</div>\n  <div class="modal-desc">\n    <div class="flex color-paletter-searchbar">\n      <label for="search-save-pegplan">Search</label>\n      <input id="search-save-pegplan" />\n    </div>\n    <div id="save-pegplan-data-container"></div>\n    <div class="flex file-name-container">\n      <div class="flex">\n        <span>File Name</span>\n        <input id="save-pegplan-file-name" type="text" />\n      </div>\n      <div>\n        <button\n          class="btn-submit"\n          type="button"\n          id="save-pegplan-modal-ok"\n        >\n          Save\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n',Sk.addEventListener("click",Ck),kk=document.getElementById("save-pegplan-file-name");const e=Ik.querySelector(".close-button");xk=document.getElementById("search-save-pegplan"),Tk=document.getElementById("save-pegplan-data-container"),xk.addEventListener("input",Rk),document.getElementById("save-pegplan-modal-ok").addEventListener("click",Fk),e.addEventListener("click",Nk)})(),(()=>{Bd.innerHTML='<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">Save Design</div>\n  <div class="context-menu absolute none" id="savemaindesign-renameDeleteMenu">\n<div class="context-content">\n  <ul class="list-none flex colunm dropdown-list">\n    <li class="dropdown-item menu-side" id="savemaindesign-rename-trigger-element">\n      Rename\n    </li>\n    <li class="dropdown-item menu-side" id="savemaindesign-delete-trigger-element">\n      Delete\n    </li>\n   \n  </ul>\n</div>\n</div>\n  <div class="modal-desc">\n    <div class="flex color-paletter-searchbar">\n      <label for="search-save-maindesign">Search</label>\n      <input id="search-save-maindesign" />\n    </div>\n    <div id="save-maindesign-data-container"></div>\n    <div class="flex file-name-container">\n      <div class="flex">\n        <span>File Name</span>\n        <input id="save-maindesign-file-name" type="text" />\n      </div>\n      <div>\n        <button\n          class="btn-submit"\n          type="button"\n          id="save-maindesign-modal-ok"\n        >\n          Save\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n',Pd.addEventListener("click",()=>Xd(!1)),Cd.addEventListener("click",zd),Nd.addEventListener("click",Kd),Rd=document.getElementById("save-maindesign-file-name");const e=Bd.querySelector(".close-button");Ad=document.getElementById("search-save-maindesign"),Fd=document.getElementById("save-maindesign-data-container"),Ad.addEventListener("input",Yd),document.getElementById("save-maindesign-modal-ok").addEventListener("click",Gd),e.addEventListener("click",Ud)})(),(()=>{Ok.innerHTML='<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">Save Weave</div>\n  <div class="modal-desc">\n    <div class="flex color-paletter-searchbar">\n      <label for="search-save-weavedesign">Search</label>\n      <input id="search-save-weavedesign" />\n    </div>\n    <div id="save-weavedesign-data-container"></div>\n    <div class="flex file-name-container">\n      <div class="flex">\n        <span>File Name</span>\n        <input id="save-weavedesign-file-name" type="text" />\n      </div>\n      <div>\n        <button\n          class="btn-submit"\n          type="button"\n          id="save-weavedesign-modal-ok"\n        >\n          Save\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n',Dk.addEventListener("click",Uk),Wk=document.getElementById("save-weavedesign-file-name");const e=Ok.querySelector(".close-button");Hk=document.getElementById("search-save-weavedesign"),$k=document.getElementById("save-weavedesign-data-container"),Hk.addEventListener("input",Jk),document.getElementById("save-weavedesign-modal-ok").addEventListener("click",Xk),e.addEventListener("click",Yk)})(),Nx.innerHTML='<div class="modal-content">\n<div class="close">\n  <span class="close-button">&times;</span>\n</div>\n<div class="modal-title">\n Open Pegplan\n</div>\n<div class="modal-desc">\n\n<div class="flex color-paletter-searchbar">\n\n\n<label for="search-open-pegplan">Search</label>\n<input id="search-open-pegplan" />\n\n<label for="search-shaft-open-pegplan">Shaft</label>\n<select id="search-shaft-open-pegplan"></select>\n\n\n<label for="search-picks-open-pegplan">Picks</label>\n<select id="search-picks-open-pegplan"></select>\n\n</div>\n<div class="flex">\n<div id="open-pegplan-data-container">\n</div>\n<div id="pegplan-preview-container">\n  <div id="pegplan-preview-content"></div>\n</div>\n</div>\n\n\n<div class="flex file-name-container">\n<div class="flex">\n<span>File Name</span>\n<input id="open-pegplan-file-name" type="text"/>\n</div>\n<div>\n <button class="btn-submit" type="button" id="open-pegplan-modal-ok">Open</button>\n </div>\n</div>\n</div>\n</div>\n',Ax=document.getElementById("search-open-pegplan"),Fx=document.getElementById("search-picks-open-pegplan"),Mx=document.getElementById("search-shaft-open-pegplan"),Ox=document.getElementById("open-pegplan-data-container"),Dx=document.getElementById("pegplan-preview-content"),Hx=document.getElementById("open-pegplan-file-name"),Rx.addEventListener("click",Vx),Nx.querySelector(".close-button").addEventListener("click",zx),document.getElementById("open-pegplan-modal-ok").addEventListener("click",Ux),Ax.addEventListener("input",Jx),Fx.addEventListener("change",Jx),Mx.addEventListener("change",Jx),Gx.addEventListener("click",Xx),dy.innerHTML='<div class="modal-content">\n<div class="close">\n  <span class="close-button">&times;</span>\n</div>\n<div class="modal-title">\n Open Design\n</div>\n<div class="context-menu absolute none" id="renameDeleteMenu">\n<div class="context-content">\n  <ul class="list-none flex colunm dropdown-list">\n    <li class="dropdown-item menu-side" id="rename-trigger-element">\n      Rename\n    </li>\n    <li class="dropdown-item menu-side" id="delete-trigger-element">\n      Delete\n    </li>\n   \n  </ul>\n</div>\n</div>\n<div class="modal-desc">\n\n<div class="flex color-paletter-searchbar">\n\n\n<label for="search-open-maindesign">Search</label>\n<input id="search-open-maindesign" />\n\n<label for="search-shaft-open-maindesign">Shaft</label>\n<select id="search-shaft-open-maindesign"></select>\n\n\n<label for="search-picks-open-maindesign">Picks</label>\n<select id="search-picks-open-maindesign"></select>\n<label for="search-ends-open-maindesign">Ends</label>\n<select id="search-ends-open-maindesign"></select>\n</div>\n<div class="flex">\n<div id="open-maindesign-data-container"></div>\n<div id="maindesign-preview-container">\n  <div></div>\n  <div id="maindesign-preview-content"></div>\n</div>\n</div>\n\n\n<div class="flex file-name-container">\n<div class="flex">\n<span>File Name</span>\n<input readonly id="open-maindesign-file-name" type="text"/>\n</div>\n <div>\n \n <button class="btn-submit" type="button" id="open-maindesign-modal-ok">Open</button>\n </div>\n\n</div>\n</div>\n</div>\n',uy=document.getElementById("search-open-maindesign"),my=document.getElementById("search-picks-open-maindesign"),py=document.getElementById("search-shaft-open-maindesign"),hy=document.getElementById("search-ends-open-maindesign"),gy=document.getElementById("open-maindesign-data-container"),fy=document.getElementById("maindesign-preview-content"),vy=document.getElementById("open-maindesign-file-name"),cy.addEventListener("click",Sy),dy.querySelector(".close-button").addEventListener("click",ky),document.getElementById("open-maindesign-modal-ok").addEventListener("click",xy),uy.addEventListener("input",Py),my.addEventListener("change",Py),py.addEventListener("change",Py),hy.addEventListener("change",Py),id.innerHTML=hg(),rd=document.getElementById("dencity-modal-apply"),ad=document.getElementById("dencity-modal-ok"),od=document.getElementById("dencity-modal-cancel"),ld.addEventListener("click",ud),rd.addEventListener("click",hd),ad.addEventListener("click",pd),od.addEventListener("click",md),id.querySelector(".close-button").addEventListener("click",md),Kx.addEventListener("click",mT),Zx.querySelector(".close-button").addEventListener("click",hT),Vs.innerHTML=gg(),Us=document.getElementById("weft-selector-modal-apply"),Ys=document.getElementById("weft-selector-modal-cancel"),Js=document.getElementById("weft-selector-modal-ok"),Vs.querySelector(".close-button").addEventListener("click",Qs),zs.addEventListener("click",Zs),Us.addEventListener("click",ed),Js.addEventListener("click",td),Ys.addEventListener("click",nd),Kk.innerHTML='<div class="modal-content">\n<div class="close">\n  <span class="close-button">&times;</span>\n</div>\n<div class="modal-title">\n Open Weave\n</div>\n<div class="modal-desc">\n\n<div class="flex color-paletter-searchbar">\n<label for="search-open-weavedesign">Search</label>\n<input id="search-open-weavedesign" />\n\n<label for="search-shaft-open-weavedesign">Shaft</label>\n<select id="search-shaft-open-weavedesign"></select>\n\n\n<label for="search-picks-open-weavedesign">Picks</label>\n<select id="search-picks-open-weavedesign"></select>\n\n\n<label for="search-ends-open-weavedesign">Ends</label>\n<select id="search-ends-open-weavedesign"></select>\n</div>\n<div class="flex">\n<div id="open-weavedesign-data-container"></div>\n<div id="weavedesign-preview-container">\n  <div></div>\n  <div id="weavedesign-preview-content"></div>\n</div>\n</div>\n\n\n<div class="flex file-name-container">\n<div class="flex">\n<span>File Name</span>\n<input readonly id="open-weavedesign-file-name" type="text"/>\n</div>\n <div>\n \n <button class="btn-submit" type="button" id="open-weavedesign-modal-ok">Open</button>\n </div>\n\n</div>\n</div>\n</div>\n',Qk=document.getElementById("search-open-weavedesign"),ex=document.getElementById("search-picks-open-weavedesign"),nx=document.getElementById("search-shaft-open-weavedesign"),tx=document.getElementById("search-ends-open-weavedesign"),lx=document.getElementById("open-weavedesign-data-container"),ix=document.getElementById("weavedesign-preview-content"),ax=document.getElementById("open-weavedesign-file-name"),Zk.addEventListener("click",cx),Kk.querySelector(".close-button").addEventListener("click",ux),document.getElementById("open-weavedesign-modal-ok").addEventListener("click",mx),Qk.addEventListener("input",px),ex.addEventListener("change",px),nx.addEventListener("change",px),tx.addEventListener("change",px),(()=>{const e=document.getElementById("cbcompany-name"),t=document.querySelector(".company-name");e.addEventListener("change",(function(){e.checked?t.style.display="block":t.style.display="none"}));const n=document.getElementById("cbcompany-logo"),l=document.querySelector("#company-logo");n.addEventListener("change",(function(){n.checked?l.style.display="block":l.style.display="none"}));const i=document.getElementById("cbcompany-address"),r=document.querySelector(".company-address");i.addEventListener("change",(function(){i.checked?r.style.display="block":r.style.display="none"}));const a=document.getElementById("cbcompany-mo"),o=document.querySelector(".company-mo");a.addEventListener("change",(function(){a.checked?o.style.display="block":o.style.display="none"}));const s=document.getElementById("cbcompany-email"),d=document.querySelector(".company-email");s.addEventListener("change",(function(){s.checked?d.style.display="block":d.style.display="none"}));const c=document.getElementById("cbprint-desc"),u=document.querySelector(".print-desc");c.addEventListener("change",(function(){c.checked?u.style.display="block":u.style.display="none"}))})(),oS.addEventListener("change",(function(){oS.checked?sS.style.display="block":sS.style.display="none"})),dS.addEventListener("change",(function(){dS.checked?cS.style.display="block":cS.style.display="none"})),uS.addEventListener("change",(function(){uS.checked?mS.style.display="block":mS.style.display="none"})),hS.addEventListener("change",(function(){hS.checked?pS.style.display="block":pS.style.display="none"})),gS.addEventListener("change",(function(){gS.checked?fS.style.display="block":fS.style.display="none"})),yS.addEventListener("change",(function(){yS.checked?vS.style.display="block":vS.style.display="none"})),bS.addEventListener("change",(function(){bS.checked?wS.style.display="block":wS.style.display="none"})),ES.addEventListener("change",(function(){ES.checked?IS.style.display="block":IS.style.display="none"})),SS.addEventListener("change",(function(){SS.checked?kS.style.display="block":kS.style.display="none"})),xS.addEventListener("change",(function(){xS.checked?TS.style.display="block":TS.style.display="none"})),_S.addEventListener("change",(function(){_S.checked?BS.style.display="block":BS.style.display="none"})),LS.addEventListener("change",(function(){LS.checked?PS.style.display="block":PS.style.display="none"})),CS.addEventListener("change",(function(){CS.checked?NS.style.display="block":NS.style.display="none"})),RS.addEventListener("change",(function(){RS.checked?AS.style.display="block":AS.style.display="none"})),FS.addEventListener("change",(function(){FS.checked?MS.style.display="block":MS.style.display="none"})),OS.addEventListener("change",(function(){OS.checked?DS.style.display="block":DS.style.display="none"})),WS.addEventListener("change",(function(){WS.checked?HS.style.display="block":HS.style.display="none"})),$S.addEventListener("change",(function(){$S.checked?qS.style.display="block":qS.style.display="none"})),jS.addEventListener("change",(function(){jS.checked?VS.style.display="block":VS.style.display="none"})),zS.addEventListener("change",(function(){zS.checked?US.style.display="block":US.style.display="none"})),YS.addEventListener("change",(function(){YS.checked?JS.style.display="block":JS.style.display="none"})),GS.addEventListener("change",(function(){GS.checked?XS.style.display="block":XS.style.display="none"})),pT(),Z_.innerHTML='<div class="modal-content">\n  <div class="close">\n    <span class="close-button">&times;</span>\n  </div>\n  <div class="modal-title">Support</div>\n  <div id="modal-desc">\n    <div class="support-modal-contents">\n      <div class="flex" style="justify-content: end;">\n        <button class="btn-submit" type="button" style="width: 150px;" id="create-new-ticket-trigger">Create New Ticket</button>\n      </div>\n      <br/>\n      <div id="support-modal-contents-table"></div>\n      <div>\n        <p>\n          Note : \n        </p>\n        <p>\n          Please let us know if you are unhappy with the support services that you have received <br/>\n          from us or by the partner , Please <b>Click Here</b> to escalate to the dedicated team.We <br  />\n          will respond to your query with in next 4 business hours.\n        </p>\n      </div>\n    </div>\n  </div>\n</div>',eB=document.getElementById("create-new-ticket-trigger"),Z_.querySelector(".close-button").addEventListener("click",nB),Q_.addEventListener("click",tB),eB.addEventListener("click",X_),console.log("createTicketModelElement",z_),z_.querySelector(".close-button").addEventListener("click",K_),U_&&U_.addEventListener("click",X_),J_.addEventListener("click",G_),gT(),document.addEventListener("beforeExportProcessDone",rc),lc.addEventListener("click",ic),IB(),SB(),document.addEventListener("contextmenu",e=>{e.preventDefault()})});const oL=e=>{KB=e},sL=e=>{XB=e}},8:function(e,t,n){"use strict";function l(e,t){return function(){return e.apply(t,arguments)}}n.d(t,"a",(function(){return l}))},9:function(e,t,n){"use strict";t.a=null}});